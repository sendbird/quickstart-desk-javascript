!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/dist",n(n.s=14)}([function(e,t,n){(function(t,n){e.exports=function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function s(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function u(e,t,n){return(u=l()?Reflect.construct:function(e,t,n){var i=[null];return i.push.apply(i,t),i=new(Function.bind.apply(e,i)),n&&o(i,n.prototype),i}).apply(null,arguments)}function c(e){var t="function"==typeof Map?new Map:void 0;return(c=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,i)}function i(){return u(e,arguments,a(this).constructor)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),o(i,e)})(e)}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){var t=l();return function(){var n,i=a(e);return n=t?(n=a(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,!(n=n)||"object"!=typeof n&&"function"!=typeof n?d(i):n}}function p(e,t){return function(){for(var n=new Array(arguments.length),i=0;i<n.length;i++)n[i]=arguments[i];return e.apply(t,n)}}var f=Object.prototype.toString;function g(e){return"[object Array]"===f.call(e)}function y(e){return void 0===e}function m(e){return null!==e&&"object"==typeof e}function _(e){return"[object Function]"===f.call(e)}function v(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),g(e))for(var n=0,i=e.length;n<i;n++)t.call(null,e[n],n,e);else for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.call(null,e[r],r,e)}var E={isArray:g,isArrayBuffer:function(e){return"[object ArrayBuffer]"===f.call(e)},isBuffer:function(e){return null!==e&&!y(e)&&null!==e.constructor&&!y(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:m,isUndefined:y,isDate:function(e){return"[object Date]"===f.call(e)},isFile:function(e){return"[object File]"===f.call(e)},isBlob:function(e){return"[object Blob]"===f.call(e)},isFunction:_,isStream:function(e){return m(e)&&_(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:v,merge:function e(){var t={};function n(n,i){"object"==typeof t[i]&&"object"==typeof n?t[i]=e(t[i],n):t[i]=n}for(var i=0,r=arguments.length;i<r;i++)v(arguments[i],n);return t},deepMerge:function e(){var t={};function n(n,i){"object"==typeof t[i]&&"object"==typeof n?t[i]=e(t[i],n):t[i]="object"==typeof n?e({},n):n}for(var i=0,r=arguments.length;i<r;i++)v(arguments[i],n);return t},extend:function(e,t,n){return v(t,(function(t,i){e[i]=n&&"function"==typeof t?p(t,n):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}};function C(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function b(e,t,n){return t&&(n=n?n(t):E.isURLSearchParams(t)?t.toString():(i=[],E.forEach(t,(function(e,t){null!=e&&(E.isArray(e)?t+="[]":e=[e],E.forEach(e,(function(e){E.isDate(e)?e=e.toISOString():E.isObject(e)&&(e=JSON.stringify(e)),i.push(C(t)+"="+C(e))})))})),i.join("&")))&&(-1!==(t=e.indexOf("#"))&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+n),e;var i}function S(){this.handlers=[]}function A(e,t,n){return E.forEach(n,(function(n){e=n(e,t)})),e}function k(e){return!(!e||!e.__CANCEL__)}function I(e,t){E.forEach(e,(function(n,i){i!==t&&i.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[i])}))}function U(e,t,n,i,r){return t=t,n=n,i=i,r=r,(e=e=new Error(e)).config=t,n&&(e.code=n),e.request=i,e.response=r,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}S.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},S.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},S.prototype.forEach=function(e){E.forEach(this.handlers,(function(t){null!==t&&e(t)}))};var O,T,R,N=S,w=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],M=E.isStandardBrowserEnv()?(T=/(msie|trident)/i.test(navigator.userAgent),R=document.createElement("a"),O=P(window.location.href),function(e){return(e=E.isString(e)?P(e):e).protocol===O.protocol&&e.host===O.host}):function(){return!0};function P(e){return T&&(R.setAttribute("href",e),e=R.href),R.setAttribute("href",e),{href:R.href,protocol:R.protocol?R.protocol.replace(/:$/,""):"",host:R.host,search:R.search?R.search.replace(/^\?/,""):"",hash:R.hash?R.hash.replace(/^#/,""):"",hostname:R.hostname,port:R.port,pathname:"/"===R.pathname.charAt(0)?R.pathname:"/"+R.pathname}}var L=E.isStandardBrowserEnv()?{write:function(e,t,n,i,r,s){var a=[];a.push(e+"="+encodeURIComponent(t)),E.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),E.isString(i)&&a.push("path="+i),E.isString(r)&&a.push("domain="+r),!0===s&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){return(e=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)")))?decodeURIComponent(e[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}},D={"Content-Type":"application/x-www-form-urlencoded"};function H(e,t){!E.isUndefined(e)&&E.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var F,G={adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==t&&"[object process]"===Object.prototype.toString.call(t))&&(F=function(e){return new Promise((function(t,n){var i=e.data,r=e.headers;E.isFormData(i)&&delete r["Content-Type"];var s=new XMLHttpRequest;e.auth&&(a=e.auth.username||"",o=e.auth.password||"",r.Authorization="Basic "+btoa(a+":"+o));var a,o,l=(a=e.baseURL,o=e.url,a&&!/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(o)?(l=a,(a=o)?l.replace(/\/+$/,"")+"/"+a.replace(/^\/+/,""):l):o);if(s.open(e.method.toUpperCase(),b(l,e.params,e.paramsSerializer),!0),s.timeout=e.timeout,s.onreadystatechange=function(){var i,r,a,o,l,u,c;s&&4===s.readyState&&(0!==s.status||s.responseURL&&0===s.responseURL.indexOf("file:"))&&(u="getAllResponseHeaders"in s?(l=s.getAllResponseHeaders(),a={},l&&E.forEach(l.split("\n"),(function(e){r=e.indexOf(":"),i=E.trim(e.substr(0,r)).toLowerCase(),r=E.trim(e.substr(r+1)),i&&(a[i]&&0<=w.indexOf(i)||(a[i]="set-cookie"===i?(a[i]||[]).concat([r]):a[i]?a[i]+", "+r:r))})),a):null,c={data:e.responseType&&"text"!==e.responseType?s.response:s.responseText,status:s.status,statusText:s.statusText,headers:u,config:e,request:s},o=t,l=n,!(c=(u=c).config.validateStatus)||c(u.status)?o(u):l(U("Request failed with status code "+u.status,u.config,null,u.request,u)),s=null)},s.onabort=function(){s&&(n(U("Request aborted",e,"ECONNABORTED",s)),s=null)},s.onerror=function(){n(U("Network Error",e,null,s)),s=null},s.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(U(t,e,"ECONNABORTED",s)),s=null},E.isStandardBrowserEnv()&&(o=L,(o=(e.withCredentials||M(l))&&e.xsrfCookieName?o.read(e.xsrfCookieName):void 0)&&(r[e.xsrfHeaderName]=o)),"setRequestHeader"in s&&E.forEach(r,(function(e,t){void 0===i&&"content-type"===t.toLowerCase()?delete r[t]:s.setRequestHeader(t,e)})),E.isUndefined(e.withCredentials)||(s.withCredentials=!!e.withCredentials),e.responseType)try{s.responseType=e.responseType}catch(a){if("json"!==e.responseType)throw a}"function"==typeof e.onDownloadProgress&&s.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&s.upload&&s.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){s&&(s.abort(),n(e),s=null)})),void 0===i&&(i=null),s.send(i)}))}),F),transformRequest:[function(e,t){return I(t,"Accept"),I(t,"Content-Type"),E.isFormData(e)||E.isArrayBuffer(e)||E.isBuffer(e)||E.isStream(e)||E.isFile(e)||E.isBlob(e)?e:E.isArrayBufferView(e)?e.buffer:E.isURLSearchParams(e)?(H(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):E.isObject(e)?(H(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return 200<=e&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};E.forEach(["delete","get","head"],(function(e){G.headers[e]={}})),E.forEach(["post","put","patch"],(function(e){G.headers[e]=E.merge(D)}));var x=G;function j(e){e.cancelToken&&e.cancelToken.throwIfRequested()}function B(e){return j(e),e.headers=e.headers||{},e.data=A(e.data,e.headers,e.transformRequest),e.headers=E.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),E.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||x.adapter)(e).then((function(t){return j(e),t.data=A(t.data,t.headers,e.transformResponse),t}),(function(t){return k(t)||(j(e),t&&t.response&&(t.response.data=A(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}function q(e,t){t=t||{};var n={},i=["url","method","params","data"],r=["headers","auth","proxy"],s=["baseURL","url","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"];E.forEach(i,(function(e){void 0!==t[e]&&(n[e]=t[e])})),E.forEach(r,(function(i){E.isObject(t[i])?n[i]=E.deepMerge(e[i],t[i]):void 0!==t[i]?n[i]=t[i]:E.isObject(e[i])?n[i]=E.deepMerge(e[i]):void 0!==e[i]&&(n[i]=e[i])})),E.forEach(s,(function(i){void 0!==t[i]?n[i]=t[i]:void 0!==e[i]&&(n[i]=e[i])}));var a=i.concat(r).concat(s);return s=Object.keys(t).filter((function(e){return-1===a.indexOf(e)})),E.forEach(s,(function(i){void 0!==t[i]?n[i]=t[i]:void 0!==e[i]&&(n[i]=e[i])})),n}function z(e){this.defaults=e,this.interceptors={request:new N,response:new N}}z.prototype.request=function(e,t){"string"==typeof e?(e=t||{}).url=arguments[0]:e=e||{},(e=q(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var n=[B,void 0],i=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){n.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){n.push(e.fulfilled,e.rejected)}));n.length;)i=i.then(n.shift(),n.shift());return i},z.prototype.getUri=function(e){return b((e=q(this.defaults,e)).url,e.params,e.paramsSerializer).replace(/^\?/,"")},E.forEach(["delete","get","head","options"],(function(e){z.prototype[e]=function(t,n){return this.request(E.merge(n||{},{method:e,url:t}))}})),E.forEach(["post","put","patch"],(function(e){z.prototype[e]=function(t,n,i){return this.request(E.merge(i||{},{method:e,url:t,data:n}))}}));var Y=z;function V(e){this.message=e}V.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},V.prototype.__CANCEL__=!0;var K=V;function Q(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;e((function(e){n.reason||(n.reason=new K(e),t(n.reason))}))}Q.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},Q.source=function(){var e;return{token:new Q((function(t){e=t})),cancel:e}};var W=Q;function J(e){var t=new Y(e);return e=p(Y.prototype.request,t),E.extend(e,Y.prototype,t),E.extend(e,t),e}var $=J(x);function X(e){try{return!!e()}catch(e){return!0}}function Z(e){return ie.call(e).slice(8,-1)}function ee(e){if(null==e)throw TypeError("Can't call method on "+e);return e}function te(e){return se(ee(e))}$.Axios=Y,$.create=function(e){return J(q($.defaults,e))},$.Cancel=K,$.CancelToken=W,$.isCancel=k,$.all=function(e){return Promise.all(e)},$.spread=function(e){return function(t){return e.apply(null,t)}},(St=$).default=$;var ne=St,ie={}.toString,re="".split,se=X((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==Z(e)?re.call(e,""):Object(e)}:Object,ae="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n?n:"undefined"!=typeof self?self:{};function oe(e,t){return e(t={exports:{}},t.exports),t.exports}function le(e){return"object"==typeof e?null!==e:"function"==typeof e}function ue(e){return Ue?Ie.createElement(e):{}}function ce(e){if(!le(e))throw TypeError(String(e)+" is not an object");return e}function de(e,t){if(!le(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!le(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!le(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!le(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}function he(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}function pe(e,t){try{Ne(Ae,e,t)}catch(n){Ae[e]=t}return t}function fe(e,t){return Pe.call(e,t)}function ge(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++Le+De).toString(36)}function ye(e){return fe(Fe,e)||(He&&fe(Ge,e)?Fe[e]=Ge[e]:Fe[e]=xe("Symbol."+e)),Fe[e]}function me(e){return isNaN(e=+e)?0:(0<e?Be:je)(e)}function _e(e){return 0<e?qe(me(e),9007199254740991):0}function ve(e,t){var n,i=te(e),r=0,s=[];for(n in i)!fe(Ke,n)&&fe(i,n)&&s.push(n);for(;t.length>r;)fe(i,n=t[r++])&&(~Qe(s,n)||s.push(n));return s}function Ee(e){return"function"==typeof e?e:void 0}function Ce(){}function be(e){return"<script>"+e+"</"+nt+">"}var Se,Ae=(Ve=function(e){return e&&e.Math==Math&&e})("object"==typeof globalThis&&globalThis)||Ve("object"==typeof window&&window)||Ve("object"==typeof self&&self)||Ve("object"==typeof ae&&ae)||function(){return this}()||Function("return this")(),ke=!X((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),Ie=Ae.document,Ue=le(Ie)&&le(Ie.createElement),Oe=!ke&&!X((function(){return 7!=Object.defineProperty(ue("div"),"a",{get:function(){return 7}}).a})),Te=Object.defineProperty,Re={f:ke?Te:function(e,t,n){if(ce(e),t=de(t,!0),ce(n),Oe)try{return Te(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},Ne=ke?function(e,t,n){return Re.f(e,t,he(1,n))}:function(e,t,n){return e[t]=n,e},we=Ae[qt="__core-js_shared__"]||pe(qt,{}),Me=oe((function(e){(e.exports=function(e,t){return we[e]||(we[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.8.1",mode:"global",copyright:"Â© 2020 Denis Pushkarev (zloirock.ru)"})})),Pe={}.hasOwnProperty,Le=0,De=Math.random(),He=!!Object.getOwnPropertySymbols&&!X((function(){return!String(Symbol())})),Fe=(W=He&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,Me("wks")),Ge=Ae.Symbol,xe=W?Ge:Ge&&Ge.withoutSetter||ge,je=Math.ceil,Be=Math.floor,qe=Math.min,ze=Math.max,Ye=Math.min,Ve={includes:(St=function(e){return function(t,n,i){var r,s=te(t),a=_e(s.length),o=function(e,t){return(e=me(e))<0?ze(e+t,0):Ye(e,t)}(i,a);if(e&&n!=n){for(;o<a;)if((r=s[o++])!=r)return!0}else for(;o<a;o++)if((e||o in s)&&s[o]===n)return e||o||0;return!e&&-1}})(!0),indexOf:St(!1)},Ke={},Qe=Ve.indexOf,We=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Je=Object.keys||function(e){return ve(e,We)},$e=ke?Object.defineProperties:function(e,t){ce(e);for(var n,i=Je(t),r=i.length,s=0;s<r;)Re.f(e,n=i[s++],t[n]);return e},Xe=Ae,Ze=(ae=function(e,t){return arguments.length<2?Ee(Xe[e])||Ee(Ae[e]):Xe[e]&&Xe[e][t]||Ae[e]&&Ae[e][t]})("document","documentElement"),et=Me("keys"),tt="prototype",nt="script",it=(qt=function(e){return et[e]||(et[e]=ge(e))})("IE_PROTO"),rt=function(){try{Se=document.domain&&new ActiveXObject("htmlfile")}catch(e){}var e;rt=Se?function(e){e.write(be("")),e.close();var t=e.parentWindow.Object;return e=null,t}(Se):((e=ue("iframe")).style.display="none",Ze.appendChild(e),e.src=String("javascript:"),(e=e.contentWindow.document).open(),e.write(be("document.F=Object")),e.close(),e.F);for(var t=We.length;t--;)delete rt[tt][We[t]];return rt()};Ke[it]=!0;var st=Object.create||function(e,t){var n;return null!==e?(Ce[tt]=ce(e),n=new Ce,Ce[tt]=null,n[it]=e):n=rt(),void 0===t?n:$e(n,t)},at=ye("unscopables"),ot=Array.prototype;null==ot[at]&&Re.f(ot,at,{configurable:!0,value:st(null)}),W=function(e){ot[at][e]=!0};var lt={},ut=Function.toString;"function"!=typeof we.inspectSource&&(we.inspectSource=function(e){return ut.call(e)});var ct,dt,ht,pt,ft,gt,yt,mt,_t=we.inspectSource,vt="function"==typeof(St=Ae.WeakMap)&&/native code/.test(_t(St));function Et(e,t){var n,i,r,s=e.target,a=e.global,o=e.stat,l=a?Ae:o?Ae[s]||pe(s,{}):(Ae[s]||{}).prototype;if(l)for(n in t){if(i=t[n],r=e.noTargetGet?(r=Gt(l,n))&&r.value:l[n],!Ft(a?n:s+(o?".":"#")+n,e.forced)&&void 0!==r){if(typeof i==typeof r)continue;!function(e,t){for(var n=wt(t),i=Re.f,r=Ut.f,s=0;s<n.length;s++){var a=n[s];fe(e,a)||i(e,a,r(t,a))}}(i,r)}(e.sham||r&&r.sham)&&Ne(i,"sham",!0),Ot(l,n,i,e)}}function Ct(e){return Object(ee(e))}Me=Ae.WeakMap,yt=vt?(ct=we.state||(we.state=new Me),dt=ct.get,ht=ct.has,pt=ct.set,ft=function(e,t){return t.facade=e,pt.call(ct,e,t),t},gt=function(e){return dt.call(ct,e)||{}},function(e){return ht.call(ct,e)}):(mt=qt("state"),Ke[mt]=!0,ft=function(e,t){return t.facade=e,Ne(e,mt,t),t},gt=function(e){return fe(e,mt)?e[mt]:{}},function(e){return fe(e,mt)});var bt={set:ft,get:gt,has:yt,enforce:function(e){return yt(e)?gt(e):ft(e,{})},getterFor:function(e){return function(t){var n;if(!le(t)||(n=gt(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}}},St={}.propertyIsEnumerable,At=Object.getOwnPropertyDescriptor,kt={f:At&&!St.call({1:2},1)?function(e){return!!(e=At(this,e))&&e.enumerable}:St},It=Object.getOwnPropertyDescriptor,Ut={f:ke?It:function(e,t){if(e=te(e),t=de(t,!0),Oe)try{return It(e,t)}catch(e){}if(fe(e,t))return he(!kt.f.call(e,t),e[t])}},Ot=oe((function(e){var t=bt.get,n=bt.enforce,i=String(String).split("String");(e.exports=function(e,t,r,s){var a=!!s&&!!s.unsafe,o=!!s&&!!s.enumerable,l=!!s&&!!s.noTargetGet;"function"==typeof r&&("string"!=typeof t||fe(r,"name")||Ne(r,"name",t),(s=n(r)).source||(s.source=i.join("string"==typeof t?t:""))),e!==Ae?(a?!l&&e[t]&&(o=!0):delete e[t],o?e[t]=r:Ne(e,t,r)):o?e[t]=r:pe(t,r)})(Function.prototype,"toString",(function(){return"function"==typeof this&&t(this).source||_t(this)}))})),Tt=We.concat("length","prototype"),Rt={f:Object.getOwnPropertyNames||function(e){return ve(e,Tt)}},Nt={f:Object.getOwnPropertySymbols},wt=ae("Reflect","ownKeys")||function(e){var t=Rt.f(ce(e)),n=Nt.f;return n?t.concat(n(e)):t},Mt=/#|\.prototype\./,Pt=(Me=function(e,t){return(e=Lt[Pt(e)])==Ht||e!=Dt&&("function"==typeof t?X(t):!!t)}).normalize=function(e){return String(e).replace(Mt,".").toLowerCase()},Lt=Me.data={},Dt=Me.NATIVE="N",Ht=Me.POLYFILL="P",Ft=Me,Gt=Ut.f,xt=(St=!X((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),qt("IE_PROTO")),jt=Object.prototype,Bt=St?Object.getPrototypeOf:function(e){return fe(e=Ct(e),xt)?e[xt]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?jt:null},qt=(Me=ye("iterator"),!1);function zt(e,t,n){e&&!fe(e=n?e:e.prototype,Wt)&&Qt(e,Wt,{configurable:!0,value:t})}function Yt(){return this}function Vt(){return this}[].keys&&("next"in(St=[].keys())?(Kt=Bt(Bt(St)))!==Object.prototype&&(fn=Kt):qt=!0),null==fn&&(fn={}),fe(fn,Me)||Ne(fn,Me,(function(){return this}));var Kt={IteratorPrototype:fn,BUGGY_SAFARI_ITERATORS:qt},Qt=Re.f,Wt=ye("toStringTag"),Jt=Kt.IteratorPrototype,$t=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),t=n instanceof Array}catch(n){}return function(n,i){return ce(n),function(e){if(!le(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype")}(i),t?e.call(n,i):n.__proto__=i,n}}():void 0),Xt=Kt.IteratorPrototype,Zt=Kt.BUGGY_SAFARI_ITERATORS,en=ye("iterator"),tn="values",nn="entries",rn=(Me=function(e,t,n,i,r,s,a){function o(e){if(e===r&&f)return f;if(!Zt&&e in h)return h[e];switch(e){case"keys":case tn:case nn:return function(){return new n(this,e)}}return function(){return new n(this)}}!function(e,t,n){t+=" Iterator",e.prototype=st(Jt,{next:he(1,n)}),zt(e,t,!1),lt[t]=Yt}(n,t,i);var l,u,c=t+" Iterator",d=!1,h=e.prototype,p=h[en]||h["@@iterator"]||r&&h[r],f=!Zt&&p||o(r);if((i="Array"==t&&h.entries||p)&&(e=Bt(i.call(new e)),Xt!==Object.prototype&&e.next&&(Bt(e)!==Xt&&($t?$t(e,Xt):"function"!=typeof e[en]&&Ne(e,en,Vt)),zt(e,c,!0))),r==tn&&p&&p.name!==tn&&(d=!0,f=function(){return p.call(this)}),h[en]!==f&&Ne(h,en,f),lt[t]=f,r)if(l={values:o(tn),keys:s?f:o("keys"),entries:o(nn)},a)for(u in l)!Zt&&!d&&u in h||Ot(h,u,l[u]);else Et({target:t,proto:!0,forced:Zt||d},l);return l},"Array Iterator"),sn=bt.set,an=bt.getterFor(rn),on=Me(Array,"Array",(function(e,t){sn(this,{type:rn,target:te(e),index:0,kind:t})}),(function(){var e=an(this),t=e.target,n=e.kind,i=e.index++;return!t||i>=t.length?{value:e.target=void 0,done:!0}:"keys"==n?{value:i,done:!1}:"values"==n?{value:t[i],done:!1}:{value:[i,t[i]],done:!1}}),"values");lt.Arguments=lt.Array,W("keys"),W("values"),W("entries"),(fn={})[ye("toStringTag")]="z",qt="[object z]"===String(fn);var ln=ye("toStringTag"),un="Arguments"==Z(function(){return arguments}()),cn=qt?Z:function(e){var t;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(e=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),ln))?e:un?Z(t):"Object"==(e=Z(t))&&"function"==typeof t.callee?"Arguments":e};function dn(e,t){return RegExp(e,t)}Kt=qt?{}.toString:function(){return"[object "+cn(this)+"]"},qt||Ot(Object.prototype,"toString",Kt,{unsafe:!0}),W={UNSUPPORTED_Y:X((function(){var e=dn("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),BROKEN_CARET:X((function(){var e=dn("^r","gy");return e.lastIndex=2,null!=e.exec("str")}))};var hn=RegExp.prototype.exec,pn=String.prototype.replace,fn=hn,gn=(qt=/a/,Kt=/b*/g,hn.call(qt,"a"),hn.call(Kt,"a"),0!==qt.lastIndex||0!==Kt.lastIndex),yn=W.UNSUPPORTED_Y||W.BROKEN_CARET,mn=void 0!==/()??/.exec("")[1];(gn||mn||yn)&&(fn=function(e){var t,n,i,r,s=this,a=yn&&s.sticky,o=function(){var e=ce(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}.call(s),l=s.source,u=0,c=e;return a&&(-1===(o=o.replace("y","")).indexOf("g")&&(o+="g"),c=String(e).slice(s.lastIndex),0<s.lastIndex&&(!s.multiline||s.multiline&&"\n"!==e[s.lastIndex-1])&&(l="(?: "+l+")",c=" "+c,u++),n=new RegExp("^(?:"+l+")",o)),mn&&(n=new RegExp("^"+l+"$(?!\\s)",o)),gn&&(t=s.lastIndex),i=hn.call(a?n:s,c),a?i?(i.input=i.input.slice(u),i[0]=i[0].slice(u),i.index=s.lastIndex,s.lastIndex+=i[0].length):s.lastIndex=0:gn&&i&&(s.lastIndex=s.global?i.index+i[0].length:t),mn&&i&&1<i.length&&pn.call(i[0],n,(function(){for(r=1;r<arguments.length-2;r++)void 0===arguments[r]&&(i[r]=void 0)})),i});var _n=fn;Et({target:"RegExp",proto:!0,forced:/./.exec!==_n},{exec:_n});var vn=(fn={codeAt:(W=function(e){return function(t,n){var i,r=String(ee(t)),s=me(n);return t=r.length,s<0||t<=s?e?"":void 0:(n=r.charCodeAt(s))<55296||56319<n||s+1===t||(i=r.charCodeAt(s+1))<56320||57343<i?e?r.charAt(s):n:e?r.slice(s,s+2):i-56320+(n-55296<<10)+65536}})(!1),charAt:W(!0)}).charAt,En="String Iterator",Cn=bt.set,bn=bt.getterFor(En);function Sn(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e}function An(e,t){var n=e.exec;if("function"==typeof n){if("object"!=typeof(n=n.call(e,t)))throw TypeError("RegExp exec method returned something other than an Object or null");return n}if("RegExp"!==Z(e))throw TypeError("RegExp#exec called on incompatible receiver");return _n.call(e,t)}Me(String,"String",(function(e){Cn(this,{type:En,string:String(e),index:0})}),(function(){var e=bn(this),t=e.string,n=e.index;return n>=t.length?{value:void 0,done:!0}:(n=vn(t,n),e.index+=n.length,{value:n,done:!1})}));var kn,In,Un,On,Tn,Rn,Nn,wn,Mn=ye("species"),Pn=(X((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),"$0"==="a".replace(/./,"$0")),Ln=!!/./[W=ye("replace")]&&""===/./[W]("a","$0"),Dn=!X((function(){var e=/(?:)/,t=e.exec;return e.exec=function(){return t.apply(this,arguments)},2!==(e="ab".split(e)).length||"a"!==e[0]||"b"!==e[1]})),Hn=ye("match"),Fn=ye("species"),Gn=fn.charAt,xn=[].push,jn=Math.min,Bn=4294967295,qn=!X((function(){return!RegExp(Bn,"y")}));function zn(e,t,n){for(var i in t)Ot(e,i,t[i],n);return e}function Yn(e,t,n){if(Sn(e),void 0===t)return e;switch(n){case 0:return function(){return e.call(t)};case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,r){return e.call(t,n,i,r)}}return function(){return e.apply(t,arguments)}}function Vn(e){var t=e.return;return void 0!==t&&ce(t.call(e)).value}function Kn(e,t){this.stopped=e,this.result=t}function Qn(e,t,n){function i(e){return s&&Vn(s),new Kn(!0,e)}function r(e){return h?(ce(e),f?g(e[0],e[1],i):g(e[0],e[1])):f?g(e,i):g(e)}var s,a,o,l,u,c,d=n&&n.that,h=!(!n||!n.AS_ENTRIES),p=!(!n||!n.IS_ITERATOR),f=!(!n||!n.INTERRUPTED),g=Yn(t,d,1+h+f);if(p)s=e;else{if("function"!=typeof(d=function(e){if(null!=e)return e[ei]||e["@@iterator"]||lt[cn(e)]}(e)))throw TypeError("Target is not iterable");if(void 0!==(p=d)&&(lt.Array===p||Zn[Xn]===p)){for(a=0,o=_e(e.length);a<o;a++)if((l=r(e[a]))&&l instanceof Kn)return l;return new Kn(!1)}s=d.call(e)}for(u=s.next;!(c=u.call(s)).done;){try{l=r(c.value)}catch(e){throw Vn(s),e}if("object"==typeof l&&l&&l instanceof Kn)return l}return new Kn(!1)}function Wn(e,t,n){if(!(e instanceof t))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return e}In=function(e,t,n){var i="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||1<".".split(/()()/).length||"".split(/.?/).length?function(e,n){var i=String(ee(this)),r=void 0===n?Bn:n>>>0;if(0==r)return[];if(void 0===e)return[i];if(!le(u=e)||(void 0!==(n=u[Hn])?!n:"RegExp"!=Z(u)))return t.call(i,e,r);for(var s,a,o,l=[],u=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),c=0,d=new RegExp(e.source,u+"g");(s=_n.call(d,i))&&!(c<(a=d.lastIndex)&&(l.push(i.slice(c,s.index)),1<s.length&&s.index<i.length&&xn.apply(l,s.slice(1)),o=s[0].length,c=a,l.length>=r));)d.lastIndex===s.index&&d.lastIndex++;return c===i.length?!o&&d.test("")||l.push(""):l.push(i.slice(c)),l.length>r?l.slice(0,r):l}:"0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:t.call(this,e,n)}:t;return[function(t,n){var r=ee(this),s=null==t?void 0:t[e];return void 0!==s?s.call(t,r,n):i.call(String(r),t,n)},function(e,r){var s=n(i,e,this,r,i!==t);if(s.done)return s.value;var a=ce(e),o=String(this),l=(s=a,e=RegExp,e=void 0===(s=ce(s).constructor)||null==(u=ce(s)[Fn])?e:Sn(u),a.unicode),u=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(qn?"y":"g"),c=new e(qn?a:"^(?:"+a.source+")",u),d=void 0===r?Bn:r>>>0;if(0==d)return[];if(0===o.length)return null===An(c,o)?[o]:[];for(var h,p=0,f=0,g=[];f<o.length;){c.lastIndex=qn?f:0;var y,m=An(c,qn?o:o.slice(f));if(null===m||(y=jn(_e(c.lastIndex+(qn?0:f)),o.length))===p)f=(h=f)+(l?Gn(o,h).length:1);else{if(g.push(o.slice(p,f)),g.length===d)return g;for(var _=1;_<=m.length-1;_++)if(g.push(m[_]),g.length===d)return g;f=p=y}}return g.push(o.slice(p)),g}]},Un=!qn,Rn=ye(kn="split"),Nn=!X((function(){var e={};return e[Rn]=function(){return 7},7!=""[kn](e)})),wn=Nn&&!X((function(){var e=!1,t=/a/;return(t={constructor:{}}).constructor[Mn]=function(){return t},t.flags="",t[Rn]=/./[Rn],t.exec=function(){return e=!0,null},t[Rn](""),!e})),Nn&&wn&&Dn||(On=/./[Rn],In=(wn=In(Rn,""[kn],(function(e,t,n,i,r){return t.exec===_n?Nn&&!r?{done:!0,value:On.call(t,n,i)}:{done:!0,value:e.call(n,t,i)}:{done:!1}}),{REPLACE_KEEPS_$0:Pn,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:Ln}))[0],Tn=wn[1],Ot(String.prototype,kn,In),Ot(RegExp.prototype,Rn,(function(e,t){return Tn.call(e,this,t)}))),Un&&Ne(RegExp.prototype[Rn],"sham",!0);var Jn=!X((function(){return Object.isExtensible(Object.preventExtensions({}))})),$n=oe((function(e){function t(e){n(e,i,{value:{objectID:"O"+ ++r,weakData:{}}})}var n=Re.f,i=ge("meta"),r=0,s=Object.isExtensible||function(){return!0},a=e.exports={REQUIRED:!1,fastKey:function(e,n){if(!le(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!fe(e,i)){if(!s(e))return"F";if(!n)return"E";t(e)}return e[i].objectID},getWeakData:function(e,n){if(!fe(e,i)){if(!s(e))return!0;if(!n)return!1;t(e)}return e[i].weakData},onFreeze:function(e){return Jn&&a.REQUIRED&&s(e)&&!fe(e,i)&&t(e),e}};Ke[i]=!0})),Xn=($n.REQUIRED,$n.fastKey,$n.getWeakData,$n.onFreeze,ye("iterator")),Zn=Array.prototype,ei=ye("iterator"),ti=ye("iterator"),ni=!1;try{var ii=0,ri={next:function(){return{done:!!ii++}},return:function(){ni=!0}};ri[ti]=function(){return this},Array.from(ri,(function(){throw 2}))}catch(h){}function si(e,t,n){function i(e){var t=p[e];Ot(p,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(c&&!le(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return c&&!le(e)?void 0:t.call(this,0===e?0:e)}:"has"==e?function(e){return!(c&&!le(e))&&t.call(this,0===e?0:e)}:function(e,n){return t.call(this,0===e?0:e,n),this})}var r,s,a,o,l,u=-1!==e.indexOf("Map"),c=-1!==e.indexOf("Weak"),d=u?"set":"add",h=Ae[e],p=h&&h.prototype,f=h,g={};return Ft(e,"function"!=typeof h||!(c||p.forEach&&!X((function(){(new h).entries().next()}))))?(f=n.getConstructor(t,e,u,d),$n.REQUIRED=!0):Ft(e,!0)&&(s=(r=new f)[d](c?{}:-0,1)!=r,a=X((function(){r.has(1)})),o=function(e,t){if(!ni)return!1;var n=!1;try{var i={};i[ti]=function(){return{next:function(){return{done:n=!0}}}},function(e){new h(e)}(i)}catch(e){}return n}(),l=!c&&X((function(){for(var e=new h,t=5;t--;)e[d](t,t);return!e.has(-0)})),o||(((f=t((function(t,n){Wn(t,f,e);var i,r,s,a=(a=new h,i=t,t=f,$t&&"function"==typeof(r=i.constructor)&&r!==t&&le(s=r.prototype)&&s!==t.prototype&&$t(a,s),a);return null!=n&&Qn(n,a[d],{that:a,AS_ENTRIES:u}),a}))).prototype=p).constructor=f),(a||l)&&(i("delete"),i("has"),u&&i("get")),(l||s)&&i(d),c&&p.clear&&delete p.clear),g[e]=f,Et({global:!0,forced:f!=h},g),zt(f,e),c||n.setStrong(f,e,u),f}function ai(e,t){var n;return ui(e)&&("function"==typeof(n=e.constructor)&&(n===Array||ui(n.prototype))||le(n)&&null===(n=n[ci]))&&(n=void 0),new(void 0===n?Array:n)(0===t?0:t)}function oi(e){return e.frozen||(e.frozen=new _i)}function li(e,t){return gi(e.entries,(function(e){return e[0]===t}))}var ui=Array.isArray||function(e){return"Array"==Z(e)},ci=ye("species"),di=[].push,hi=(W={forEach:(Me=function(e){var t=1==e,n=2==e,i=3==e,r=4==e,s=6==e,a=7==e,o=5==e||s;return function(l,u,c,d){for(var h,p,f=Ct(l),g=se(f),y=Yn(u,c,3),m=_e(g.length),_=0,v=(d=d||ai,t?d(l,m):n||a?d(l,0):void 0);_<m;_++)if((o||_ in g)&&(p=y(h=g[_],_,f),e))if(t)v[_]=p;else if(p)switch(e){case 3:return!0;case 5:return h;case 6:return _;case 2:di.call(v,h)}else switch(e){case 4:return!1;case 7:di.call(v,h)}return s?-1:i||r?r:v}})(0),map:Me(1),filter:Me(2),some:Me(3),every:Me(4),find:Me(5),findIndex:Me(6),filterOut:Me(7)},$n.getWeakData),pi=bt.set,fi=bt.getterFor,gi=W.find,yi=W.findIndex,mi=0,_i=function(){this.entries=[]};_i.prototype={get:function(e){if(e=li(this,e))return e[1]},has:function(e){return!!li(this,e)},set:function(e,t){var n=li(this,e);n?n[1]=t:this.entries.push([e,t])},delete:function(e){var t=yi(this.entries,(function(t){return t[0]===e}));return~t&&this.entries.splice(t,1),!!~t}};var vi,Ei={getConstructor:function(e,t,n,i){function r(e,t,n){var i=a(e),r=hi(ce(t),!0);return!0===r?oi(i).set(t,n):r[i.id]=n,e}var s=e((function(e,r){Wn(e,s,t),pi(e,{type:t,id:mi++,frozen:void 0}),null!=r&&Qn(r,e[i],{that:e,AS_ENTRIES:n})})),a=fi(t);return zn(s.prototype,{delete:function(e){var t=a(this);if(!le(e))return!1;var n=hi(e);return!0===n?oi(t).delete(e):n&&fe(n,t.id)&&delete n[t.id]},has:function(e){var t=a(this);if(!le(e))return!1;var n=hi(e);return!0===n?oi(t).has(e):n&&fe(n,t.id)}}),zn(s.prototype,n?{get:function(e){var t=a(this);if(le(e)){var n=hi(e);return!0===n?oi(t).get(e):n?n[t.id]:void 0}},set:function(e,t){return r(this,e,t)}}:{add:function(e){return r(this,e,!0)}}),s}},Ci=(oe((function(e){function t(e){return function(t){return e(this,arguments.length?t:void 0)}}var n,i,r,s,a,o=bt.enforce,l=!Ae.ActiveXObject&&"ActiveXObject"in Ae,u=Object.isExtensible;e=e.exports=si("WeakMap",t,Ei),vt&&l&&(n=Ei.getConstructor(t,"WeakMap",!0),$n.REQUIRED=!0,e=e.prototype,i=e.delete,r=e.has,s=e.get,a=e.set,zn(e,{delete:function(e){if(!le(e)||u(e))return i.call(this,e);var t=o(this);return t.frozen||(t.frozen=new n),i.call(this,e)||t.frozen.delete(e)},has:function(e){if(!le(e)||u(e))return r.call(this,e);var t=o(this);return t.frozen||(t.frozen=new n),r.call(this,e)||t.frozen.has(e)},get:function(e){if(!le(e)||u(e))return s.call(this,e);var t=o(this);return t.frozen||(t.frozen=new n),r.call(this,e)?s.call(this,e):t.frozen.get(e)},set:function(e,t){var i;return le(e)&&!u(e)?((i=o(this)).frozen||(i.frozen=new n),r.call(this,e)?a.call(this,e,t):i.frozen.set(e,t)):a.call(this,e,t),this}}))})),{CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}),bi=ye("iterator"),Si=ye("toStringTag"),Ai=on.values;for(vi in Ci){var ki=Ae[vi],Ii=ki&&ki.prototype;if(Ii){if(Ii[bi]!==Ai)try{Ne(Ii,bi,Ai)}catch(h){Ii[bi]=Ai}if(Ii[Si]||Ne(Ii,Si,vi),Ci[vi])for(var Ui in on)if(Ii[Ui]!==on[Ui])try{Ne(Ii,Ui,on[Ui])}catch(h){Ii[Ui]=on[Ui]}}}var Oi=function(){function e(){i(this,e)}return s(e,null,[{key:"write",value:function(){var e;wi.isDebugMode&&(e=console).log.apply(e,arguments)}},{key:"error",value:function(){var e;wi.isDebugMode&&(e=console).error.apply(e,arguments)}}]),e}(),Ti=new WeakMap,Ri=null,Ni=null,wi=function(){function e(){i(this,e)}return s(e,null,[{key:"setDebugMode",value:function(){Ti.set(this,!0)}},{key:"unsetDebugMode",value:function(){Ti.set(this,!1)}},{key:"getParamsFromCallback",value:function(e,t){return{result:e,err:t,reversed:!1}}},{key:"callback",value:function(t,n,i){i&&((n=e.getParamsFromCallback(t,n)).err&&Oi.error(n.err),n.reversed?i(n.err,n.result):i(n.result,n.err))}},{key:"isSendBirdSdkCompatible",value:function(e){var t,n="3.0.55".split("."),i=e.split(".");if(n.length!==i.length)return!1;for(t in n)if(parseInt(n[t])>parseInt(i[t]))return!1;return!0}},{key:"sendBird",get:function(){return Ri},set:function(e){Ri=e}},{key:"isDebugMode",get:function(){return Ti.get(this)}},{key:"apiHost",get:function(){var e;return Ni||(e=Ri.getInstance(),Ni="https://desk-api-".concat(e.getApplicationId(),".sendbird.com/sapi")),Ni},set:function(e){Ni=e}},{key:"sdkVersion",get:function(){return"1.0.19"}},{key:"minSendBirdVersion",get:function(){return"3.0.55"}}]),e}(),Mi=(fn=Re.f,(Me=Function.prototype).toString),Pi=/^\s*function ([^ (]*)/;function Li(e,t,n){(t=de(t))in e?Re.f(e,t,he(0,n)):e[t]=n}!ke||"name"in Me||fn(Me,"name",{configurable:!0,get:function(){try{return Mi.call(this).match(Pi)[1]}catch(e){return""}}});var Di={ERROR_SENDBIRD_SDK_MISSING:{code:100,message:"SendBird SDK is missing."},ERROR_SENDBIRD_SDK_VERSION_NOT_SUPPORTED:{code:101,message:"This SendBird SDK version is not supported."},ERROR_SENDBIRD_DESK_INIT_MISSING:{code:102,message:"SendBird Desk SDK is not initialized. It should be done before authentication."},ERROR_SENDBIRD_SDK_MESSAGE_LIST_FAILED:{code:200,message:"Cannot load messages in SDK client."},ERROR_INVALID_PARAMETER:{code:403,message:"Invalid parameter."},ERROR_DATA_NOT_FOUND:{code:404,message:"Data not found."},ERROR_REQUEST_TIMEOUT:{code:409,message:"Request timed-out."},ERROR_REQUEST:{code:500,message:"Request failed."},ERROR_REQUEST_CANCELED:{code:501,message:"Request canceled."}},Hi=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(t,c(Error));var e=h(t);function t(n,r){var s;return i(this,t),s=e.call(this,n),"function"==typeof Error.captureStackTrace?Error.captureStackTrace(d(s),s.constructor):s.stack=new Error(n).stack,s.name="SendBirdDeskError",s.message=n,s.code=r,s}return s(t,null,[{key:"create",value:function(e){return e?new t(e.message,e.code):new Error("SendBirdDeskError type missing.")}},{key:"throw",value:function(e){if(e)throw new t(e.message,e.code)}},{key:"Type",get:function(){return Di}}]),t}(),Fi=new Xe.WeakMap,Gi=function(){function e(){i(this,e)}return s(e,null,[{key:"connect",value:function(e,t,n){var i=this;"function"==typeof t&&(n=t,t="");var r,s=wi.sendBird;s?(r=s.getInstance(),s="".concat(wi.apiHost,"/customers/auth/"),t={sendbirdAccessToken:t||"","content-type":"application/json"},e={sendbirdAppId:r.getApplicationId(),sendbirdId:e},ne.create({headers:t}).post(s,e).then((function(e){Fi.set(i,{deskToken:e.data.token}),Oi.write("[REQ] connection established"),wi.callback(e.data,null,n)})).catch((function(e){wi.callback(null,e,n)}))):wi.callback(null,Hi.create(Hi.Type.ERROR_SENDBIRD_SDK_MISSING),n)}},{key:"header",get:function(){return{sendbirdDeskToken:Fi.get(this).deskToken,"content-type":"application/json","user-agent":"desk-js@".concat("1.0.19")}}},{key:"getParam",get:function(){var e=wi.sendBird;return e?(e=e.getInstance(),"sendbirdAppId=".concat(e.getApplicationId())):""}},{key:"postParam",get:function(){var e=wi.sendBird;return e?{sendbirdAppId:e.getInstance().getApplicationId()}:{}}}]),e}(),xi=function(){function e(t){i(this,e),this.fetchFromJSON(t)}return s(e,[{key:"fetchFromJSON",value:function(e){this.userId=e?e.user:0,this.name=e?e.displayName:"",this.profileUrl=e?e.photoThumbnailUrl:""}}]),e}();fn=ae("navigator","userAgent")||"",ae=(Me=Ae.process)&&Me.versions,(Me=ae&&ae.v8)?Ji=(Ki=Me.split("."))[0]+Ki[1]:fn&&(!(Ki=fn.match(/Edge\/(\d+)/))||74<=Ki[1])&&(Ki=fn.match(/Chrome\/(\d+)/))&&(Ji=Ki[1]);var ji=Ji&&+Ji,Bi=ye("species"),qi=(ae=function(e){return 51<=ji||!X((function(){var t=[];return(t.constructor={})[Bi]=function(){return{foo:1}},1!==t[e](Boolean).foo}))},ye("isConcatSpreadable")),zi=9007199254740991,Yi="Maximum allowed index exceeded";function Vi(e){throw e}Me=51<=ji||!X((function(){var e=[];return e[qi]=!1,e.concat()[0]!==e})),fn=ae("concat"),Et({target:"Array",proto:!0,forced:!Me||!fn},{concat:function(){for(var e,t,n,i=Ct(this),r=ai(i,0),s=0,a=-1,o=arguments.length;a<o;a++)if(function(e){if(!le(e))return!1;var t=e[qi];return void 0!==t?!!t:ui(e)}(n=-1===a?i:arguments[a])){if(t=_e(n.length),zi<s+t)throw TypeError(Yi);for(e=0;e<t;e++,s++)e in n&&Li(r,s,n[e])}else{if(zi<=s)throw TypeError(Yi);Li(r,s++,n)}return r.length=s,r}});var Ki=function(e,t){var n=[][e];return!!n&&X((function(){n.call(null,t||function(){throw 1},1)}))},Qi=Object.defineProperty,Wi={},Ji=function(e,t){if(fe(Wi,e))return Wi[e];var n=[][e],i=!!fe(t=t||{},"ACCESSORS")&&t.ACCESSORS,r=fe(t,0)?t[0]:Vi,s=fe(t,1)?t[1]:void 0;return Wi[e]=!!n&&!X((function(){if(i&&!ke)return 1;var e={length:-1};i?Qi(e,1,{enumerable:!0,get:Vi}):e[1]=1,n.call(e,r,s)}))},$i=W.forEach;Me=Ki("forEach"),fn=Ji("forEach"),Et({target:"Array",proto:!0,forced:[].forEach!=(fn=Me&&fn?[].forEach:function(e,t){return $i(this,e,1<arguments.length?t:void 0)})},{forEach:fn});var Xi=Ve.indexOf,Zi=[].indexOf,er=!!Zi&&1/[1].indexOf(1,-0)<0;fn=Ki("indexOf"),Ve=Ji("indexOf",{ACCESSORS:!0,1:0}),Et({target:"Array",proto:!0,forced:er||!fn||!Ve},{indexOf:function(e,t){return er?Zi.apply(this,arguments)||0:Xi(this,e,1<arguments.length?t:void 0)}});var tr=[].join;fn=se!=Object,Ve=Ki("join",","),Et({target:"Array",proto:!0,forced:fn||!Ve},{join:function(e){return tr.call(te(this),void 0===e?",":e)}});var nr=W.map;Ve=ae("map"),ae=Ji("map"),Et({target:"Array",proto:!0,forced:!Ve||!ae},{map:function(e,t){return nr(this,e,1<arguments.length?t:void 0)}});var ir=W.some;function rr(e,t){var n=wi.sendBird;n?((n=n.getInstance().GroupChannel.createMyGroupChannelListQuery()).customTypesFilter=[lr],n.channelUrlsFilter=e,n.includeEmpty=!0,n.next(t)):wi.callback(null,Hi.create(Hi.Type.ERROR_SENDBIRD_SDK_MISSING),t)}function sr(t,n){var i=cr.Status.OPEN;cr.isStatus(t.status)&&(i=t.status);var r=i!==cr.Status.CLOSED?"status=ASSIGNED&status=UNASSIGNED":"status=CLOSED";r="".concat(wi.apiHost,"/tickets/")+"?".concat(Gi.getParam,"&limit=").concat(t.limit||cr.defaultLimit,"&offset=").concat(t.offset||0)+"&".concat(r,"&order=").concat(t.order||"-updated_at"),t.channelUrl&&(r+="&channelUrl=".concat(t.channelUrl)),t.customFieldFilter&&"object"===e(t.customFieldFilter)&&(r+="&customFields="+encodeURIComponent(Object.keys(t.customFieldFilter).map((function(e){return"".concat(e,":").concat(encodeURIComponent(t.customFieldFilter[e]))})).join(","))),ne.create({headers:Gi.header}).get(r).then((function(e){if(e&&e.data){var t,r=[],s=[];for(t in e.data.results){var a=new cr(e.data.results[t]);ur[a.channelUrl]=a,s.push(a.channelUrl),r.push(a)}rr(s,(function(e,t){var s=(t=wi.getParamsFromCallback(e,t)).result;t.err||r.forEach((function(e){for(var t in s){var n=s[t];if(e.channelUrl===n.url){e.channel=n;break}}})),Oi.write("[REQ] ".concat(i," ticket list:"),r),wi.callback(r,t.err,n)}))}else wi.callback([],null,n)})).catch((function(e){return wi.callback(null,e,n)}))}Ki=Ki("some"),Ji=Ji("some"),Et({target:"Array",proto:!0,forced:!Ki||!Ji},{some:function(e,t){return ir(this,e,1<arguments.length?t:void 0)}}),Et({target:"Object",stat:!0,forced:Ji=X((function(){Je(1)}))},{keys:function(e){return Je(Ct(e))}});var ar=function(){function e(){i(this,e)}return s(e,null,[{key:"CustomType",get:function(){return{RICH_MESSAGE:"SENDBIRD_DESK_RICH_MESSAGE",ADMIN_MESSAGE:"SENDBIRD_DESK_ADMIN_MESSAGE_CUSTOM_TYPE"}}},{key:"DataType",get:function(){return{TICKET_INQUIRE_CLOSURE:"SENDBIRD_DESK_INQUIRE_TICKET_CLOSURE",TICKET_ASSIGN:"TICKET_ASSIGN",TICKET_TRANSFER:"TICKET_TRANSFER",TICKET_CLOSE:"TICKET_CLOSE",TICKET_FEEDBACK:"SENDBIRD_DESK_CUSTOMER_SATISFACTION",URL_PREVIEW:"SENDBIRD_DESK_URL_PREVIEW"}}},{key:"ClosureState",get:function(){return{WAITING:"WAITING",CONFIRMED:"CONFIRMED",DECLINED:"DECLINED"}}},{key:"FeedbackState",get:function(){return{WAITING:"WAITING",CONFIRMED:"CONFIRMED"}}},{key:"UrlRegExp",get:function(){return/(?:(?:https?|ftp):\/\/)?(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,}))\.?)(?::\d{2,5})?(?:[/?#]\S*)?/gi}}]),e}(),or=function(){function e(t){i(this,e),this.fetchFromJSON(t)}return s(e,[{key:"fetchFromJSON",value:function(e){this.channelUrl=e?e.channel_url:"",this.name=e?e.name:""}}]),e}(),lr="SENDBIRD_DESK_CHANNEL_CUSTOM_TYPE",ur={},cr=function(){function t(e){i(this,t),this.fetchFromJSON(e)}return s(t,[{key:"fetchFromJSON",value:function(e){if(this.id=e?e.id:0,this.title=e?e.channelName:"",this.status=e?e.status:"",this.info=e&&e.info?JSON.parse(e.info):null,this.priority=e?e.priority:t.Priority.MEDIUM,this.agent=e&&e.recentAssignment&&e.recentAssignment.agent?new xi(e.recentAssignment.agent):null,this.customer=e?e.customer:null,this.customFields={},this.group=e?e.group:0,this.relatedChannels=[],this.channel=this.channel,this.channelUrl=e?e.channelUrl:null,this.updatedAt=(e?new Date(e.updatedAt):new Date).getTime(),e&&e.customFields)for(var n=e.customFields,i=0;i<n.length;i++){var r=n[i].key,s=n[i].value;this.customFields[r]=s}if(e&&e.relatedChannels)try{var a=JSON.parse(e.relatedChannels);Array.isArray(a)&&(this.relatedChannels=a.map((function(e){return new or(e)})))}catch(e){}}},{key:"refresh",value:function(e){var t=this,n="".concat(wi.apiHost,"/tickets/").concat(this.id,"/?").concat(Gi.getParam);ne.create({headers:Gi.header}).get(n).then((function(n){t.fetchFromJSON(n.data),rr([t.channelUrl],(function(n,i){0<(i=wi.getParamsFromCallback(n,i).result).length&&(t.channel=i[0]),ur[t.channelUrl]=t,Oi.write("[REQ] ticket refresh:",t),wi.callback(t,null,e)}))})).catch((function(t){return wi.callback(null,t,e)}))}},{key:"reopen",value:function(e){var t=this,n="".concat(wi.apiHost,"/tickets/").concat(this.id,"/reopen"),i=Gi.postParam;ne.create({headers:Gi.header}).patch(n,i).then((function(n){n&&n.data&&n.data.channelUrl?(t.fetchFromJSON(n.data),rr([t.channelUrl],(function(n,i){0<(i=wi.getParamsFromCallback(n,i).result).length&&(t.channel=i[0]),ur[t.channelUrl]=t,Oi.write("[REQ] ticket reopen:",t),wi.callback(t,null,e)}))):wi.callback(t,null,e)})).catch((function(t){return wi.callback(null,t,e)}))}},{key:"cancel",value:function(e,t){var n,i,r=this;"function"==typeof e&&(t=e,e=null),e&&"string"!=typeof e?wi.callback(null,Hi.create(Hi.Type.ERROR_INVALID_PARAMETER),t):(n="".concat(wi.apiHost,"/tickets/").concat(this.id,"/cancel"),i=Gi.postParam,e&&(i.groupKeyForTransfer=e),ne.create({headers:Gi.header}).patch(n,i).then((function(e){e&&e.data&&e.data.channelUrl?(r.fetchFromJSON(e.data),rr([r.channelUrl],(function(e,n){0<(n=wi.getParamsFromCallback(e,n).result).length&&(r.channel=n[0]),ur[r.channelUrl]=r,Oi.write("[REQ] ticket cancel:",r),wi.callback(r,null,t)}))):wi.callback(r,null,t)})).catch((function(e){return wi.callback(null,e,t)})))}},{key:"close",value:function(e,t){var n=this;if(1===arguments.length){if("function"!=typeof e)return void wi.callback(null,Hi.create(Hi.Type.ERROR_INVALID_PARAMETER),t);t=e,e=null}else if("string"!=typeof e||"function"!=typeof t)return void wi.callback(null,Hi.create(Hi.Type.ERROR_INVALID_PARAMETER),t);var i="".concat(wi.apiHost,"/tickets/").concat(this.id,"/close"),r=Gi.postParam;e&&(r.closeComment=e),ne.create({headers:Gi.header}).patch(i,r).then((function(e){e.data.channelUrl?(n.fetchFromJSON(e.data),rr([n.channelUrl],(function(e,i){0<(i=wi.getParamsFromCallback(e,i).result).length&&(n.channel=i[0]),ur[n.channelUrl]=n,Oi.write("[REQ] ticket close:",n),wi.callback(n,null,t)}))):wi.callback(n,null,t)})).catch((function(e){return wi.callback(null,e,t)}))}},{key:"selectQuestion",value:function(e,t,n){var i,r,s=this;"number"==typeof e&&"string"==typeof t?(i="".concat(wi.apiHost,"/tickets/").concat(this.id,"/select_question"),(r=Gi.postParam).faqFileId=e,r.question=t,ne.create({headers:Gi.header}).post(i,r).then((function(e){Oi.write("[REQ] ticket select option:",s),wi.callback(e.data,null,n)})).catch((function(e){return wi.callback(null,e,n)}))):wi.callback(null,Hi.create(Hi.Type.ERROR_INVALID_PARAMETER),n)}},{key:"setPriority",value:function(e,n){var i,r,s=this;Object.keys(t.Priority).map((function(e){return t.Priority[e]})).indexOf(e)<0?wi.callback(null,Hi.create(Hi.Type.ERROR_INVALID_PARAMETER),n):(i="".concat(wi.apiHost,"/tickets/").concat(this.id,"/"),(r=Gi.postParam).priority=e,ne.create({headers:Gi.header}).patch(i,r).then((function(e){s.fetchFromJSON(e.data),wi.callback(s,null,n)})).catch((function(e){wi.callback(null,e,n)})))}},{key:"setRelatedChannelUrls",value:function(e,t){var n,i,r=this;Array.isArray(e)&&!e.some((function(e){return"string"!=typeof e}))?(n="".concat(wi.apiHost,"/tickets/").concat(this.id,"/"),(i=Gi.postParam).relatedChannelUrls=e.join(","),ne.create({headers:Gi.header}).patch(n,i).then((function(e){r.fetchFromJSON(e.data),wi.callback(r,null,t)})).catch((function(e){wi.callback(null,e,t)}))):wi.callback(null,Hi.create(Hi.Type.ERROR_INVALID_PARAMETER),t)}},{key:"setCustomFields",value:function(t,n){var i=this;if("object"!==e(t)||null===t||Array.isArray(t))wi.callback(null,Hi.create(Hi.Type.ERROR_INVALID_PARAMETER),n);else{var r,s={};for(r in t)s[r]="string"==typeof t[r]?t[r]:JSON.stringify(t[r]);var a="".concat(wi.apiHost,"/tickets/").concat(this.id,"/custom_fields/"),o=Gi.postParam;o.customFields=JSON.stringify(s),ne.create({headers:Gi.header}).patch(a,o).then((function(e){i.fetchFromJSON(e.data),wi.callback(i,null,n)})).catch((function(e){wi.callback(null,e,n)}))}}}],[{key:"isStatus",value:function(e){for(var n in t.Status)if(t.Status[n]===e)return!0;return!1}},{key:"isPriority",value:function(e){for(var n in t.Priority)if(t.Priority[n]===e)return!0;return!1}},{key:"isDeskCustomType",value:function(e){return e===lr}},{key:"clearCache",value:function(e){e?(delete ur[e],Oi.write("[SYS] cached ticket for ".concat(e," cleared"))):(ur={},Oi.write("[SYS] all cached ticket cleared"))}},{key:"create",value:function(n,i,r,s,a,o,l,u){if(c=wi.sendBird)if("function"==typeof r&&(u=r,l=o=a=s=r=null),"function"==typeof s&&(u=s,l=o=a=s=null),"function"==typeof a&&(u=a,l=o=a=null),"function"==typeof o&&(u=o,l=o=null),"function"==typeof l&&(u=l,l=null),"string"!=typeof n||"string"!=typeof i||r&&"string"!=typeof r||s&&"object"!==e(s)||a&&!t.isPriority(a)||o&&(!Array.isArray(o)||o.some((function(e){return"string"!=typeof e})))||Array.isArray(s)||l&&"string"!=typeof l)wi.callback(null,Hi.create(Hi.Type.ERROR_INVALID_PARAMETER),u);else{var c,d=c.getInstance(),h="".concat(wi.apiHost,"/tickets/");if((c=Gi.postParam).channelName=n,c.channelType="SENDBIRD_JAVASCRIPT",r&&(c.groupKey=r),s){var p,f={};for(p in s)f[p]="string"==typeof s[p]?s[p]:JSON.stringify(s[p]);c.customFields=JSON.stringify(f)}a&&(c.priority=a),o&&(c.relatedChannelUrls=o.join(",")),l&&(c.botKey=l),c.info=JSON.stringify({ticket:{subject:n,requester:{name:i,email:d.getCurrentUserId()}}}),ne.create({headers:Gi.header}).post(h,c).then((function(e){var n=new t(e.data);rr([n.channelUrl],(function(e,t){0<(t=wi.getParamsFromCallback(e,t).result).length&&(n.channel=t[0]),ur[n.channelUrl]=n,Oi.write("[REQ] ticket create:",n),wi.callback(n,null,u)}))})).catch((function(e){return wi.callback(null,e,u)}))}else wi.callback(null,Hi.create(Hi.Type.ERROR_SENDBIRD_SDK_MISSING),u)}},{key:"getOpenCount",value:function(e){var t="".concat(wi.apiHost,"/tickets/count/?").concat(Gi.getParam);ne.create({headers:Gi.header}).get(t).then((function(t){return wi.callback(t.data,null,e)})).catch((function(t){return wi.callback(null,t,e)}))}},{key:"getByChannelUrl",value:function(e,n){var i;ur[e]?wi.callback(ur[e],null,n):(i="".concat(wi.apiHost,"/tickets/?").concat(Gi.getParam,"&limit=10&channelUrl=").concat(e),ne.create({headers:Gi.header}).get(i).then((function(i){var r=null;i&&i.data&&0<i.data.results.length&&(r=new t(i.data.results[0])),r?rr([e],(function(t,i){0<(i=wi.getParamsFromCallback(t,i).result).length&&(r.channel=i[0]),ur[e]=r,Oi.write("[REQ] get ticket for channel ".concat(e,":"),r),wi.callback(r,null,n)})):wi.callback(null,Hi.Type.ERROR_DATA_NOT_FOUND,n)})).catch((function(e){return wi.callback(null,e,n)})))}},{key:"getOpenedList",value:function(e,t,n){"function"==typeof t&&(n=t,t=null),sr({offset:e,customFieldFilter:t,status:this.Status.OPEN},n)}},{key:"getClosedList",value:function(e,t,n){"function"==typeof t&&(n=t,t=null),sr({offset:e,customFieldFilter:t,status:this.Status.CLOSED},n)}},{key:"getUrlPreview",value:function(e,t){var n="".concat(wi.apiHost,"/tickets/url_preview/"),i=Gi.postParam;i.url=e,ne.create({headers:Gi.header}).post(n,i).then((function(e){return wi.callback(e.data,null,t)})).catch((function(e){return wi.callback(null,e,t)}))}},{key:"confirmEndOfChat",value:function(e,n,i){"string"==typeof n&&-1<["yes","no"].indexOf(n)?t.getByChannelUrl(e.channelUrl,(function(t,r){var s=wi.getParamsFromCallback(t,r).result;t="".concat(wi.apiHost,"/tickets/").concat(s.id,"/edit_message/"),(r=Gi.postParam).messageId=e.messageId,r.messageData=JSON.stringify({type:ar.DataType.TICKET_INQUIRE_CLOSURE,body:{state:"yes"===n?ar.ClosureState.CONFIRMED:ar.ClosureState.DECLINED,ticketId:s.id}}),ne.create({headers:Gi.header}).patch(t,r).then((function(e){Oi.write("[REQ] confirmed end of chat:",s),wi.callback(e.data,null,i)})).catch((function(e){return wi.callback(null,e,i)}))})):wi.callback(null,Hi.create(Hi.Type.ERROR_INVALID_PARAMETER))}},{key:"submitFeedback",value:function(e,n,i,r){var s=2<arguments.length&&void 0!==i?i:"",a=3<arguments.length?r:void 0;e&&0<e.messageId&&e.channelUrl&&"number"==typeof n&&1<=n&&n<=5&&"string"==typeof s?t.getByChannelUrl(e.channelUrl,(function(t,i){var r=wi.getParamsFromCallback(t,i).result;t="".concat(wi.apiHost,"/tickets/").concat(r.id,"/edit_message/"),(i=Gi.postParam).messageId=e.messageId,i.messageData=JSON.stringify({type:ar.DataType.TICKET_FEEDBACK,body:{state:ar.FeedbackState.CONFIRMED,customerSatisfactionScore:n,customerSatisfactionComment:s,ticketId:r.id}}),ne.create({headers:Gi.header}).patch(t,i).then((function(e){Oi.write("[REQ] customer feedback:",r),wi.callback(e.data,null,a)})).catch((function(e){return wi.callback(null,e,a)}))})):wi.callback(null,Hi.create(Hi.Type.ERROR_INVALID_PARAMETER))}},{key:"Status",get:function(){return{INITIALIZED:"INITIALIZED",PROACTIVE:"PROACTIVE",UNASSIGNED:"UNASSIGNED",ASSIGNED:"ASSIGNED",OPEN:"OPEN",CLOSED:"CLOSED"}}},{key:"Priority",get:function(){return{URGENT:"URGENT",HIGH:"HIGH",MEDIUM:"MEDIUM",LOW:"LOW"}}},{key:"defaultLimit",get:function(){return 10}}]),t}(),dr=!1;return function(){function t(){i(this,t)}return s(t,null,[{key:"init",value:function(e){try{e||(window&&window.SendBird&&(e=window.SendBird),n&&n.SendBird&&(e=n.SendBird)),e&&e.version?(wi.sendBird=e,wi.isSendBirdSdkCompatible(e.version)?dr=!0:Hi.throw(Hi.Type.ERROR_SENDBIRD_SDK_VERSION_NOT_SUPPORTED)):Hi.throw(Hi.Type.ERROR_SENDBIRD_SDK_MISSING)}catch(e){Hi.throw(Hi.Type.ERROR_SENDBIRD_SDK_MISSING)}}},{key:"authenticate",value:function(e,t,n){dr?Gi.connect(e,t,n):Hi.throw(Hi.Type.ERROR_SENDBIRD_DESK_INIT_MISSING)}},{key:"isDeskChannel",value:function(e){return cr.isDeskCustomType(e.customType)}},{key:"setApiHost",value:function(e){wi.apiHost=e}},{key:"setDebugMode",value:function(){wi.setDebugMode()}},{key:"setCustomerCustomFields",value:function(t,n){if("object"!==e(t)||null===t||Array.isArray(t))wi.callback(null,Hi.create(Hi.Type.ERROR_INVALID_PARAMETER),n);else{var i,r={};for(i in t)r[i]="string"==typeof t[i]?t[i]:JSON.stringify(t[i]);var s="".concat(wi.apiHost,"/customers/custom_fields/"),a=Gi.postParam;a.customFields=JSON.stringify(r),ne.create({headers:Gi.header}).patch(s,a).then((function(e){var t,i={};for(t in e.data.customFields){var r=e.data.customFields[t];i[r.key]=r.value}wi.callback(i,null,n)})).catch((function(e){wi.callback(null,e,n)}))}}},{key:"version",get:function(){return wi.sdkVersion}},{key:"Error",get:function(){return Hi}},{key:"Agent",get:function(){return xi}},{key:"Ticket",get:function(){return cr}},{key:"Message",get:function(){return ar}},{key:"RelatedChannel",get:function(){return or}},{key:"UrlRegExp",get:function(){return ar.UrlRegExp}}]),t}()}()}).call(this,n(3),n(4))},function(e,t,n){"use strict";var i=n(6),r=Object.prototype.toString;function s(e){return"[object Array]"===r.call(e)}function a(e){return void 0===e}function o(e){return null!==e&&"object"==typeof e}function l(e){if("[object Object]"!==r.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function u(e){return"[object Function]"===r.call(e)}function c(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),s(e))for(var n=0,i=e.length;n<i;n++)t.call(null,e[n],n,e);else for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.call(null,e[r],r,e)}e.exports={isArray:s,isArrayBuffer:function(e){return"[object ArrayBuffer]"===r.call(e)},isBuffer:function(e){return null!==e&&!a(e)&&null!==e.constructor&&!a(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:o,isPlainObject:l,isUndefined:a,isDate:function(e){return"[object Date]"===r.call(e)},isFile:function(e){return"[object File]"===r.call(e)},isBlob:function(e){return"[object Blob]"===r.call(e)},isFunction:u,isStream:function(e){return o(e)&&u(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:c,merge:function e(){var t={};function n(n,i){l(t[i])&&l(n)?t[i]=e(t[i],n):l(n)?t[i]=e({},n):s(n)?t[i]=n.slice():t[i]=n}for(var i=0,r=arguments.length;i<r;i++)c(arguments[i],n);return t},extend:function(e,t,n){return c(t,(function(t,r){e[r]=n&&"function"==typeof t?i(t,n):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},function(e,t,n){(function(t,i,r){e.exports=function(e,n,s){"use strict";function a(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=a(e),l=a(n),u=a(s);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function g(e,t,n){return t&&f(e.prototype,t),n&&f(e,n),e}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function E(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function C(e,t,n){return(C=E()?Reflect.construct:function(e,t,n){var i=[null];i.push.apply(i,t);var r=new(Function.bind.apply(e,i));return n&&v(r,n.prototype),r}).apply(null,arguments)}function b(e){var t="function"==typeof Map?new Map:void 0;return(b=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,i)}function i(){return C(e,arguments,_(this).constructor)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),v(i,e)})(e)}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function A(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return S(e)}function k(e){var t=E();return function(){var n,i=_(e);if(t){var r=_(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return A(this,n)}}function I(e,t,n){return(I="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function U(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,s=[],a=!0,o=!1;try{for(n=n.call(e);!(a=(i=n.next()).done)&&(s.push(i.value),!t||s.length!==t);a=!0);}catch(e){o=!0,r=e}finally{try{a||null==n.return||n.return()}finally{if(o)throw r}}return s}}(e,t)||T(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e){return function(e){if(Array.isArray(e))return R(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||T(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,t){if(e){if("string"==typeof e)return R(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?R(e,t):void 0}}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function N(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=T(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){o=!0,s=e},f:function(){try{a||null==n.return||n.return()}finally{if(o)throw s}}}}var w=function(){function e(){p(this,e)}return g(e,null,[{key:"OS_VERSION",get:function(){return"undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.replace(/,/g,"."):"noAgent"}},{key:"SDK_VERSION",get:function(){return"3.0.159"}},{key:"SDK_MAJOR_VERSION",get:function(){return e.SDK_VERSION.split(".")[0]}},{key:"DEFAULT_MAX_UNREAD_COUNT_OF_SUPER_GROUP_CHANNEL",get:function(){return 100}},{key:"INTERNAL_CALL",get:function(){return"ic"}}]),e}(),M={},P=new WeakMap,L=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};p(this,e),P.set(this,"object"===h(t)&&t?t:{})}return g(e,[{key:"container",get:function(){return P.get(this)}},{key:"get",value:function(e){return P.get(this)[e]}},{key:"set",value:function(e,t){P.get(this)[e]=t}},{key:"remove",value:function(e){var t=P.get(this);t.hasOwnProperty(e)&&delete t[e]}}],[{key:"create",value:function(t,n){return M[t]=new e(n),M[t]}},{key:"get",value:function(e){return e||(e=fn.getInstance()._iid),M[e]}}]),e}(),D=function(e){m(n,e);var t=k(n);function n(e,i){var r;return p(this,n),(r=t.call(this,i)).name="SendBirdException",r.code=i||0,r.message=e,r}return g(n,[{key:"isSessionKeyExpiredError",get:function(){return 400309===this.code}},{key:"isSessionTokenExpiredError",get:function(){return 400302===this.code}}],[{key:"INVALID_INITIALIZATION",get:function(){return 800100}},{key:"CONNECTION_REQUIRED",get:function(){return 800101}},{key:"CONNECTION_CANCELED",get:function(){return 800102}},{key:"INVALID_PARAMETER",get:function(){return 800110}},{key:"NETWORK_ERROR",get:function(){return 800120}},{key:"NETWORK_ROUTING_ERROR",get:function(){return 800121}},{key:"MALFORMED_DATA",get:function(){return 800130}},{key:"MALFORMED_ERROR_DATA",get:function(){return 800140}},{key:"WRONG_CHANNEL_TYPE",get:function(){return 800150}},{key:"MARK_AS_READ_RATE_LIMIT_EXCEEDED",get:function(){return 800160}},{key:"QUERY_IN_PROGRESS",get:function(){return 800170}},{key:"ACK_TIMEOUT",get:function(){return 800180}},{key:"LOGIN_TIMEOUT",get:function(){return 800190}},{key:"WEBSOCKET_CONNECTION_CLOSED",get:function(){return 800200}},{key:"WEBSOCKET_CONNECTION_FAILED",get:function(){return 800210}},{key:"REQUEST_FAILED",get:function(){return 800220}},{key:"FILE_UPLOAD_CANCEL_FAILED",get:function(){return 800230}},{key:"REQUEST_CANCELED",get:function(){return 800240}},{key:"REQUEST_DUPLICATED",get:function(){return 800250}},{key:"FILE_SIZE_LIMIT_EXCEEDED",get:function(){return 800260}},{key:"SESSION_TOKEN_REQUEST_FAILED",get:function(){return 800500}},{key:"SESSION_TOKEN_REFRESHED",get:function(){return 800501}},{key:"SESSION_TOKEN_REFRESH_FAILED",get:function(){return 800502}}]),n}(b(Error)),H=function(){function e(){p(this,e),this.sessionToken=null,this.sessionKey=null,this.eKey=null}return g(e,[{key:"hasSession",value:function(){return!!this.sessionKey}}]),e}(),F={},G=function(){function e(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};p(this,e),this._iid=t,Object.keys(i).forEach((function(e){var t=i[e];"function"==typeof t&&(n[e]=n.getClonedClass(t))})),F[t]=this}return g(e,[{key:"getClonedClass",value:function(e){var t=this._iid;return function(n){m(r,n);var i=k(r);function r(){return p(this,r),i.apply(this,arguments)}return g(r,[{key:"_iid",get:function(){return t}}],[{key:"_iid",get:function(){return t}},{key:"_name",get:function(){return e.name}}]),r}(e)}}],[{key:"get",value:function(e){return e?F[e]:{}}}]),e}(),x={verbose:"VERBOSE",info:"INFO",debug:"DEBUG",warn:"WARN",error:"ERROR",none:"NONE"},j=function(e){m(n,e);var t=k(n);function n(){return p(this,n),t.apply(this,arguments)}return g(n,[{key:"log",value:function(e){for(var t,n,i,r,s,a=this.getLogLevelText(e);a.length<8;)a+=" ";for(var o=arguments.length,l=new Array(o>1?o-1:0),u=1;u<o;u++)l[u-1]=arguments[u];switch(l.unshift("[".concat(a,"]")),e){case"verbose":(t=console).log.apply(t,l);break;case"debug":(n=console).log.apply(n,l);break;case"info":(i=console).info.apply(i,l);break;case"warn":(r=console).warn.apply(r,l);break;case"error":(s=console).error.apply(s,l)}}},{key:"groupStart",value:function(){var e;(e=console).group.apply(e,arguments)}},{key:"groupEnd",value:function(){var e;(e=console).groupEnd.apply(e,arguments)}}]),n}(function(){function e(){p(this,e)}return g(e,[{key:"getLogLevelText",value:function(e){return x[e]}}]),e}()),B={DEBUG:"debug",PRODUCTION:"production"},q=B.PRODUCTION,z={VERBOSE:"verbose",DEBUG:"debug",INFO:"info",WARN:"warn",ERROR:"error",NONE:"none"},Y=[z.NONE,z.ERROR,z.WARN,z.INFO,z.DEBUG,z.VERBOSE],V=z.WARN,K=Y.indexOf(V),Q=[new j],W=function(){function e(){p(this,e)}return g(e,null,[{key:"Mode",get:function(){return B}},{key:"mode",get:function(){return q},set:function(t){Object.keys(e.Mode).map((function(t){return e.Mode[t]})).indexOf(t)>-1&&(q=t)}},{key:"supportedLogLevels",get:function(){return z}},{key:"logLevel",get:function(){return Y[K]},set:function(e){Y.includes(e)||(e=V),K=Y.indexOf(e)}},{key:"defaultLogLevel",get:function(){return V}},{key:"isDisplayableLogLevel",value:function(e){var t=Y.indexOf(e);return 0<=t&&t<=K}},{key:"log",value:function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];e.isDisplayableLogLevel(t)&&Q.forEach((function(e){return e.log.apply(e,[t].concat(i))}))}},{key:"verbose",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];e.log.apply(e,[z.VERBOSE].concat(n))}},{key:"debug",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];e.log.apply(e,[z.DEBUG].concat(n))}},{key:"info",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];e.log.apply(e,[z.INFO].concat(n))}},{key:"warn",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];e.log.apply(e,[z.WARN].concat(n))}},{key:"error",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];e.log.apply(e,[z.ERROR].concat(n))}},{key:"group",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=[];Array.isArray(n[n.length-1])&&(r=n.pop()),r.some((function(t){return e.isDisplayableLogLevel(t.level)}))&&Q.filter((function(e){return e instanceof j})).forEach((function(e){e.groupStart.apply(e,n),r.forEach((function(t){return e.log.apply(e,[t.level].concat(O(t.messages)))})),e.groupEnd()}))}}]),e}(),J=function(){function e(){p(this,e),this._queue=[],this.locked=!1}return g(e,[{key:"lock",value:function(e){var t=this;this.locked?this._queue.push(e):(this.locked=!0,e((function(){return t.unlock()})))}},{key:"unlock",value:function(){if(this.locked=!1,this._queue.length>0){var e=this._queue.shift();this.lock(e)}}}]),e}(),$=function(){function e(t){p(this,e),this.sb=t,this.mutex=new J,this.pingTimer=null,this.pingTimeoutTimer=null}return g(e,[{key:"ping",value:function(){var e=this,t=G.get(this.sb._iid).Command.bPing(),n=L.get(this.sb._iid).container,i=n.wsAdapter,r=n.pongTimeout;i.client.send(t),W.debug("`PING`"),this.pingTimeoutTimer=setTimeout((function(){W.debug("`PING` timeout."),e.stop(),i.client.handler&&i.client.handler.onError()}),r)}},{key:"pong",value:function(){this.pingTimeoutTimer&&(clearTimeout(this.pingTimeoutTimer),this.pingTimeoutTimer=null)}},{key:"refreshTimer",value:function(){var e=this,t=L.get(this.sb._iid).container.pingInterval;this.mutex.lock((function(n){e.stop(),e.pingTimer=setInterval((function(){e.ping()}),t),n()}))}},{key:"start",value:function(){this.refreshTimer(),this.ping()}},{key:"stop",value:function(){this.pingTimer&&(clearInterval(this.pingTimer),this.pingTimer=null),this.pingTimeoutTimer&&(clearTimeout(this.pingTimeoutTimer),this.pingTimeoutTimer=null)}}]),e}();function X(){return"undefined"==typeof window&&void 0!==t&&("node"===t.title||void 0!==t.versions&&t.versions.node||"[object process]"===String(t))}var Z=[D.CONNECTION_REQUIRED,D.NETWORK_ERROR,D.ACK_TIMEOUT,D.WEBSOCKET_CONNECTION_CLOSED,D.WEBSOCKET_CONNECTION_FAILED,D.FILE_UPLOAD_CANCEL_FAILED,D.REQUEST_CANCELED,500901,500910,900200],ee=function(){function e(){p(this,e)}return g(e,null,[{key:"deepEqual",value:function(e,t){if(e!==t){var n=d({},e),i=d({},t);return!(n.messageId&&i.messageId&&n.messageId!==i.messageId||n.reqId&&i.reqId&&n.reqId!==i.reqId||(n.hasOwnProperty("messageId")&&delete n.messageId,n.hasOwnProperty("reqId")&&delete n.reqId,i.hasOwnProperty("messageId")&&delete i.messageId,i.hasOwnProperty("reqId")&&delete i.reqId,JSON.stringify(n)!==JSON.stringify(i)))}return!0}},{key:"isResendableError",value:function(e){return e>0&&Z.indexOf(e)>=0}},{key:"isFile",value:function(e){var t="object"===h(e)&&null!==e&&"string"==typeof e.name&&"string"==typeof e.uri&&"string"==typeof e.type;if(!t)if(X()){if(void 0!==i)return e instanceof i}else{if("undefined"!=typeof Blob)return e instanceof Blob;if("undefined"!=typeof File)return e instanceof File}return t}}]),e}(),te=function(){function e(t){var n=this;p(this,e),this.fields={},t&&Object.keys(t).forEach((function(e){n.fields[e]={value:t[e]},ee.isFile(t[e])&&(n.fields[e].filename=t[e].name)})),this.options={},this.internal=!1,this.upload={reqId:null,deleteRequest:null,progressHandler:null}}return g(e,[{key:"add",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.fields[e]={value:t,filename:n}}},{key:"remove",value:function(e){this.fields.hasOwnProperty(e)&&delete this.fields[e]}},{key:"yield",value:function(){for(var e=this,t=!1,n=Object.keys(this.fields),i=0;i<n.length;i++){var r=n[i];if(ee.isFile(this.fields[r].value)){t=!0;break}}if(t){var s=new l.default;return Object.keys(this.fields).forEach((function(t){var n=e.fields[t];if(ee.isFile(n.value)){var i=n.value;i.filename||i.name?s.append(t,n.value,i.filename||i.name):i.data?s.append(t,n.value,i.data.name):s.append(t,n.value,"unnamed")}else s.append(t,n.value)})),s}var a={};return Object.keys(this.fields).forEach((function(t){a[t]=e.fields[t].value})),a}}]),e}(),ne=888e3,ie=function(){function e(t){p(this,e),this.sb=t,this.cls=G.get(this.sb._iid)}return g(e,[{key:"checkRouting",value:function(e){if(this.sb.customApiHost&&this.sb.customWsHost)"function"==typeof e&&e(null,{apiHost:this.sb.customApiHost,wsHost:this.sb.customWsHost});else{var t=this.sb.getApplicationId();e(null,{apiHost:"https://api-".concat(t,".sendbird.com"),wsHost:"wss://ws-".concat(t,".sendbird.com")})}}},{key:"_buildUrl",value:function(e){var t=e.apiHost,n=e.url,i=e.params;return n?i&&i.internal?"".concat(t,"/v").concat(w.SDK_MAJOR_VERSION,"/sdk").concat(n):"".concat(t,"/v").concat(w.SDK_MAJOR_VERSION).concat(n):t}},{key:"_createHeader",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.noSessionKey,i=void 0!==n&&n,r=t.accessToken,s=void 0===r?null:r,a=e instanceof l.default&&"function"==typeof e.getHeaders?e.getHeaders():{},o=L.get(this.sb._iid),u=o.container,c=u.appId,d=u.auth,h=u.extensions,p=u.getUserAgentWithExtensions;return a.SendBird="JS,".concat(w.OS_VERSION,",").concat(w.SDK_VERSION,",").concat(c),a["SB-User-Agent"]=encodeURIComponent(p(h)),!i&&d.sessionKey&&(a["Session-Key"]=d.sessionKey),s&&(a["App-Id"]=c,a["Access-Token"]=s),a["Request-Sent-Timestamp"]=(new Date).getTime().toString(),a}},{key:"_createQuery",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{var n=[];return Object.keys(t).forEach((function(e){var i,r=t[e];null!=r&&(i="object"===h(r)?Array.isArray(r)?r.map((function(e){return encodeURIComponent("string"==typeof e?e.trim():e)})).join(","):encodeURIComponent(JSON.stringify(r)):encodeURIComponent(r),n.push("".concat(e,"=").concat(i)))})),n.length>0?"".concat(e,"?").concat(n.join("&")):e}catch(t){return W.debug("createWithEncodedGetParams is failed. - ",t),e}}},{key:"_request",value:function(e,t,n,i){var r=this;this.checkRouting((function(s,a){if(s)i(new D("Request failed.",D.REQUEST_FAILED),null);else{var u=r._buildUrl({apiHost:a.apiHost,url:t,params:n}),c=n?n.yield():{},d=r._createHeader(c,n?n.options:{}),h=[{level:W.supportedLogLevels.DEBUG,messages:["url:",t]},{level:W.supportedLogLevels.DEBUG,messages:["data:",c]}],p=null;switch(e){case"GET":p=r._createQuery(u,c);break;case"POST":case"PUT":p=u;break;case"DELETE":p=r._createQuery(u,c)}var f=null;if("undefined"==typeof ServiceWorker||"undefined"==typeof ServiceWorkerRegistration||"undefined"!=typeof ServiceWorkerContainer||X()||"function"!=typeof fetch)switch(e){case"GET":f=o.default.get(p,{headers:d,validateStatus:r._validateStatus});break;case"POST":var g=null;if(c instanceof l.default){var y=o.default.CancelToken.source();g=y.token;var m=r.cls.FileMessageQueue,_=n.upload.reqId;_&&(h.push({level:W.supportedLogLevels.DEBUG,messages:["request id:",_]}),m.uploadRequest[_]=y)}f=o.default.post(p,"function"==typeof c.getBuffer?c.getBuffer():c,{headers:d,validateStatus:r._validateStatus,cancelToken:g,onUploadProgress:function(e){n.upload.progressHandler&&n.upload.progressHandler(e,n.upload.reqId)}});break;case"PUT":f=o.default.put(p,c,{headers:d,validateStatus:r._validateStatus});break;case"DELETE":f=o.default.delete(p,{headers:d,validateStatus:r._validateStatus})}else{var v={method:e,headers:d};switch(e){case"GET":break;case"POST":if(c instanceof l.default){if("function"==typeof AbortController){var E=new AbortController,C=E.signal;v.signal=C;var b=r.cls.FileMessageQueue,S=n.upload.reqId;S&&(h.push({level:W.supportedLogLevels.DEBUG,messages:["request id:",S]}),b.uploadRequest[S]=E)}v.body="function"==typeof c.getBuffer?c.getBuffer():c}else d["Content-Type"]="application/json; charset=utf-8",v.body=JSON.stringify(c);break;case"PUT":c instanceof l.default?v.body="function"==typeof c.getBuffer?c.getBuffer():c:(d["Content-Type"]="application/json; charset=utf-8",v.body=JSON.stringify(c))}f=fetch(p,v).then((function(e){return e.json().then((function(t){if(!r._validateStatus(e.status))throw{request:{isAbort:!1},response:{data:t}};return Promise.resolve({data:t})}))}))}W.group("".concat(e," request"),h),h=[],f.then((function(t){try{var r=t.data;"POST"===e&&"function"==typeof n.upload.deleteRequest&&n.upload.deleteRequest(),h.push({level:W.supportedLogLevels.DEBUG,messages:["data:",r]}),i(null,r)}catch(e){throw{code:ne,rawError:e}}})).catch((function(s){if(s.code===ne)throw s.rawError;"POST"===e&&"function"==typeof n.upload.deleteRequest&&n.upload.deleteRequest();var a=r._handleError(s);h.push({level:W.supportedLogLevels.DEBUG,messages:["error:",a]}),t&&n&&a.isSessionKeyExpiredError?L.get(r.sb._iid).container.sessionManager.refresh((function(e){return i(e,null)})):i(a,null)})).finally((function(){return W.group("".concat(e," response"),h)}))}}))}},{key:"_validateStatus",value:function(e){return e>=200&&e<400}},{key:"_handleError",value:function(e){var t=e.request,n=e.response;if(t){if(t.isAbort||t.aborted)return new D("Request has been canceled.",D.REQUEST_CANCELED);if(n){var i=n.data,r=i?i.message:"Request failed.",s=i?i.code:D.REQUEST_FAILED;return new D(r,s)}return new D("Request failed.",D.REQUEST_FAILED)}return new D("There was a network error.",D.NETWORK_ERROR)}},{key:"get",value:function(e,t,n){this._request("GET",e,t,n)}},{key:"dummyCall",value:function(e){this._request("GET",null,null,e)}},{key:"post",value:function(e,t,n){this._request("POST",e,t,n)}},{key:"put",value:function(e,t,n){this._request("PUT",e,t,n)}},{key:"delete",value:function(e,t,n){this._request("DELETE",e,t,n)}},{key:"refreshSessionKey",value:function(t,n){var i=this,r=t.accessToken;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var a=e.Path.USERS_USERID_SESSION_KEY.replace("%s",encodeURIComponent(s.userId)),o=new te;o.options.noSessionKey=!0,o.options.accessToken=r,i.post(a,o,n)}}))}},{key:"updateCurrentUserInfo",value:function(t,n){var i=this,r=t.nickname,s=t.profileUrl,a=t.profileImage,o=t.preferredLanguages;this.sb.ConnectionManager.ready((function(t,l){if(t)n(t,null);else{var u=e.Path.USERS_USERID.replace("%s",encodeURIComponent(l.userId)),c=new te;r&&c.add("nickname",r),s&&c.add("profile_url",s),a&&c.add("profile_file",a,a.name),o&&c.add("preferred_languages",o),i.put(u,c,n)}}))}},{key:"getMyGroupChannelChangeLogs",value:function(t,n){var i=this,r=t.ts,s=t.token,a=t.customTypes,o=t.includeEmpty,l=t.includeFrozen;this.sb.ConnectionManager.ready((function(t,u){if(t)n(t,null);else{var c=e.Path.USERS_USERID_MY_GROUP_CHANNEL_CHANGELOGS.replace("%s",encodeURIComponent(u.userId)),d=new te({show_read_receipt:!0,show_delivery_receipt:!0,show_member:!0});s&&d.add("token",s),r&&d.add("change_ts",r),a&&a.length>0&&d.add("custom_types",a),"boolean"==typeof o&&d.add("show_empty",o),"boolean"==typeof l&&d.add("show_frozen",l),i.get(c,d,n)}}))}},{key:"getChannelInvitationPreference",value:function(t,n){var i=this;this.sb.ConnectionManager.ready((function(t,r){if(t)n(t,null);else{var s=e.Path.USERS_USERID_GROUP_CHANNEL_INVITATION_PREFERENCE.replace("%s",encodeURIComponent(r.userId));i.get(s,null,n)}}))}},{key:"getGroupChannelCount",value:function(t,n){var i=this,r=t.memberStateFilter;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var a=i.cls.GroupChannel,o=e.Path.USERS_USERID_GROUP_CHANNEL_COUNT.replace("%s",encodeURIComponent(s.userId)),l="";switch(r){case a.MemberStateFilter.JOINED:l="joined";break;case a.MemberStateFilter.INVITED:l="invited";break;case a.MemberStateFilter.INVITED_BY_FRIEND:l="invited_by_friend";break;case a.MemberStateFilter.INVITED_BY_NON_FRIEND:l="invited_by_non_friend";break;default:l="all"}var u=new te({state:l});i.get(o,u,n)}}))}},{key:"getUnreadItemCount",value:function(t,n){var i=this,r=t.keys;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var a=e.Path.USERS_USERID_UNREAD_ITEM_COUNT.replace("%s",encodeURIComponent(s.userId)),o=new te({item_keys:r});i.get(a,o,n)}}))}},{key:"getTotalUnreadMessageCount",value:function(t,n){var i=this,r=t.customTypesFilter,s=t.superChannelFilter;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var o=e.Path.USERS_USERID_UNREAD_MESSAGE_COUNT.replace("%s",encodeURIComponent(a.userId)),l=new te({super_mode:s});null!==r&&r.length>0&&l.add("custom_types",r),i.get(o,l,n)}}))}},{key:"getTotalUnreadChannelCount",value:function(t,n){var i=this;this.sb.ConnectionManager.ready((function(t,r){if(t)n(t,null);else{var s=e.Path.USERS_USERID_UNREAD_CHANNEL_COUNT.replace("%s",encodeURIComponent(r.userId));i.get(s,null,n)}}))}},{key:"searchMessages",value:function(t,n){var i=this,r=t.keyword,s=t.limit,a=t.reverse,o=t.exactMatch,l=t.channelUrl,u=t.channelCustomType,c=t.messageTimestampFrom,d=t.messageTimestampTo,h=t.order,p=t.nextToken,f=t.advancedQuery,g=t.targetFields;this.sb.ConnectionManager.ready((function(t,y){if(t)n(t,null);else{var m=e.Path.SEARCH_MESSAGE,_=new te({limit:s,reverse:a,query:r,custom_type:u});c&&_.add("message_ts_from",c),d&&_.add("message_ts_to",d),l&&_.add("channel_url",l),h&&_.add("sort_field",h),"boolean"==typeof o&&_.add("exact_match",o),null!==p&&p.length>0&&_.add("after",p),"boolean"==typeof f&&_.add("advanced_query",f),g&&Array.isArray(g)&&_.add("target_fields",g),i.get(m,_,n)}}))}},{key:"markAsReadAll",value:function(t,n){var i=this,r=t.channelUrls;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var a=e.Path.USERS_USERID_MARKASREADALL.replace("%s",encodeURIComponent(s.userId)),o=new te;r&&o.add("channel_urls",r),i.put(a,o,n)}}))}},{key:"markAsDelivered",value:function(t,n){var i=this,r=t.channelUrl,s=t.userId;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var o=e.Path.GROUPCHANNELS_CHANNELURL_MESSAGES_MARKASDELIVERED.replace("%s",encodeURIComponent(r)),l=new te;s&&l.add("user_id",s),i.put(o,l,n)}}))}},{key:"setChannelInvitationPreference",value:function(t,n){var i=this,r=t.isAutoAccept;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var a=e.Path.USERS_USERID_GROUP_CHANNEL_INVITATION_PREFERENCE.replace("%s",encodeURIComponent(s.userId)),o=new te({auto_accept:r});i.put(a,o,n)}}))}},{key:"blockUser",value:function(t,n){var i=this,r=t.blockedUserId;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var a=e.Path.USERS_USERID_BLOCK.replace("%s",encodeURIComponent(s.userId)),o=new te({target_id:r});i.post(a,o,n)}}))}},{key:"unblockUser",value:function(t,n){var i=this,r=t.unblockedUserId;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var a=e.Path.USERS_USERID_BLOCK_TARGETID.replace("%s",encodeURIComponent(s.userId)).replace("%s",encodeURIComponent(r));i.delete(a,null,n)}}))}},{key:"getPushTriggerOption",value:function(t,n){var i=this;this.sb.ConnectionManager.ready((function(t,r){if(t)n(t,null);else{var s=e.Path.USERS_USERID_PUSHPREFERENCE.replace("%s",encodeURIComponent(r.userId));i.get(s,null,n)}}))}},{key:"setPushTriggerOption",value:function(t,n){var i=this,r=t.pushTriggerOption;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var a=e.Path.USERS_USERID_PUSHPREFERENCE.replace("%s",encodeURIComponent(s.userId)),o=new te({push_trigger_option:r});i.put(a,o,n)}}))}},{key:"getPushTokens",value:function(t,n){var i=this,r=t.ts,s=t.token,a=t.type;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=e.Path.USERS_USERID_PUSH_DEVICE_TOKENS.replace("%s",encodeURIComponent(o.userId)).replace("%s",encodeURIComponent(a)),u=new te;s&&u.add("token",s),r&&u.add("created_ts",r),i.get(l,u,n)}}))}},{key:"getPushTemplate",value:function(t,n){var i=this;this.sb.ConnectionManager.ready((function(t,r){if(t)n(t,null);else{var s=e.Path.USERS_USERID_PUSH_TEMPLATE.replace("%s",encodeURIComponent(r.userId));i.get(s,null,n)}}))}},{key:"setPushTemplate",value:function(t,n){var i=this,r=t.templateName;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var a=e.Path.USERS_USERID_PUSH_TEMPLATE.replace("%s",encodeURIComponent(s.userId)),o=new te({name:r});i.put(a,o,n)}}))}},{key:"getDoNotDisturb",value:function(t,n){var i=this;this.sb.ConnectionManager.ready((function(t,r){if(t)n(t,null);else{var s=e.Path.USERS_USERID_PUSHPREFERENCE.replace("%s",encodeURIComponent(r.userId));i.get(s,null,n)}}))}},{key:"setDoNotDisturb",value:function(t,n){var i=this,r=t.doNotDisturbOn,s=t.startHour,a=t.startMin,o=t.endHour,l=t.endMin,u=t.timezone;this.sb.ConnectionManager.ready((function(t,c){if(t)n(t,null);else{var d=e.Path.USERS_USERID_PUSHPREFERENCE.replace("%s",encodeURIComponent(c.userId)),h=new te({do_not_disturb:r,start_hour:s,start_min:a,end_hour:o,end_min:l,timezone:u});i.put(d,h,n)}}))}},{key:"getSnoozePeriod",value:function(t,n){var i=this;this.sb.ConnectionManager.ready((function(t,r){if(t)n(t,null);else{var s=e.Path.USERS_USERID_PUSHPREFERENCE.replace("%s",encodeURIComponent(r.userId));i.get(s,null,n)}}))}},{key:"setSnoozePeriod",value:function(t,n){var i=this,r=t.snoozeOn,s=t.startTs,a=t.endTs;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=e.Path.USERS_USERID_PUSHPREFERENCE.replace("%s",encodeURIComponent(o.userId)),u=new te({snooze_enabled:r,snooze_start_ts:s,snooze_end_ts:a});i.put(l,u,n)}}))}},{key:"registerGCMPushToken",value:function(t,n){var i=this,r=t.token;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var a=e.Path.USERS_USERID_PUSH_GCM.replace("%s",encodeURIComponent(s.userId)),o=new te({gcm_reg_token:r,always_push:!0});i.post(a,o,n)}}))}},{key:"unregisterGCMPushToken",value:function(t,n){var i=this,r=t.token;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var a=e.Path.USERS_USERID_PUSH_GCM_TOKEN.replace("%s",encodeURIComponent(s.userId)).replace("%s",encodeURIComponent(r));i.delete(a,null,n)}}))}},{key:"unregisterAllGCMPushTokens",value:function(t,n){var i=this;this.sb.ConnectionManager.ready((function(t,r){if(t)n(t,null);else{var s=e.Path.USERS_USERID_PUSH_GCM.replace("%s",encodeURIComponent(r.userId));i.delete(s,null,n)}}))}},{key:"registerAPNSPushToken",value:function(t,n){var i=this,r=t.token;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var a=e.Path.USERS_USERID_PUSH_APNS.replace("%s",encodeURIComponent(s.userId)),o=new te({apns_device_token:r,always_push:!0});i.post(a,o,n)}}))}},{key:"unregisterAPNSPushToken",value:function(t,n){var i=this,r=t.token;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var a=e.Path.USERS_USERID_PUSH_APNS_TOKEN.replace("%s",encodeURIComponent(s.userId)).replace("%s",encodeURIComponent(r));i.delete(a,null,n)}}))}},{key:"unregisterAllAPNSPushTokens",value:function(t,n){var i=this;this.sb.ConnectionManager.ready((function(t,r){if(t)n(t,null);else{var s=e.Path.USERS_USERID_PUSH_APNS.replace("%s",encodeURIComponent(r.userId));i.delete(s,null,n)}}))}},{key:"unregisterAllPushTokens",value:function(t,n){var i=this;this.sb.ConnectionManager.ready((function(t,r){if(t)n(t,null);else{var s=e.Path.USERS_USERID_PUSH.replace("%s",encodeURIComponent(r.userId));i.delete(s,null,n)}}))}},{key:"loadFriendList",value:function(t,n){var i=this,r=t.token,s=t.limit;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var o=e.Path.FRIENDS.replace("%s",encodeURIComponent(a.userId)),l=new te({limit:s,token:r});i.get(o,l,n)}}))}},{key:"getFriendChangeLogsByToken",value:function(t,n){var i=this,r=t.token;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var a=e.Path.FRIENDS_CHANGE_LOGS.replace("%s",encodeURIComponent(s.userId)),o=new te;r&&o.add("token",r),i.get(a,o,n)}}))}},{key:"addFriends",value:function(t,n){var i=this,r=t.userIds;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var a=e.Path.FRIENDS.replace("%s",encodeURIComponent(s.userId)),o=new te({user_ids:r});i.post(a,o,n)}}))}},{key:"deleteFriends",value:function(t,n){var i=this,r=t.userIds;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var a=e.Path.FRIENDS.replace("%s",encodeURIComponent(s.userId)),o=new te({user_ids:r});i.delete(a,o,n)}}))}},{key:"uploadFriendDiscoveries",value:function(t,n){var i=this,r=t.discoveries;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var a=e.Path.FRIENDS_DISCOVERIES.replace("%s",encodeURIComponent(s.userId)),o=[];r.forEach((function(e){o.push({friend_discovery_key:e.friendDiscoveryKey,friend_name:"string"==typeof e.friendName||e.friendName?e.friendName:null})}));var l=new te({friend_discoveries:o});i.put(a,l,n)}}))}},{key:"deleteFriendDiscoveries",value:function(t,n){var i=this,r=t.discoveryKeys;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var a=e.Path.FRIENDS_DISCOVERIES.replace("%s",encodeURIComponent(s.userId)),o=new te({friend_discovery_keys:r});i.delete(a,o,n)}}))}},{key:"loadUserList",value:function(t,n){var i=this,r=t.token,s=t.limit,a=t.userIdsFilter,o=t.metaDataKeyFilter,l=t.metaDataValuesFilter,u=t.nicknameStartsWithFilter;this.sb.ConnectionManager.ready((function(t,c){if(t)n(t,null);else{var d=e.Path.USERS,h=new te({token:r,limit:s});a&&a.length>0&&h.add("user_ids",a),o&&l&&l.length>0&&(h.add("metadatakey",o),h.add("metadatavalues_in",l)),u&&h.add("nickname_startswith",u),i.get(d,h,n)}}))}},{key:"loadBlockedUserList",value:function(t,n){var i=this,r=t.token,s=t.limit,a=t.userIdsFilter;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=e.Path.USERS_USERID_BLOCK.replace("%s",encodeURIComponent(o.userId)),u=new te({token:r,limit:s});a&&a.length>0&&u.add("user_ids",a),i.get(l,u,n)}}))}},{key:"createUserMetaData",value:function(t,n){var i=this,r=t.metaData;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var a=e.Path.USERS_USERID_METADATA.replace("%s",encodeURIComponent(s.userId)),o=new te({metadata:r});i.post(a,o,n)}}))}},{key:"updateUserMetaData",value:function(t,n){var i=this,r=t.metaData,s=t.upsert;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var o=e.Path.USERS_USERID_METADATA.replace("%s",encodeURIComponent(a.userId)),l=new te({metadata:r,upsert:s});i.put(o,l,n)}}))}},{key:"deleteUserMetaData",value:function(t,n){var i=this,r=t.metaDataKey;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var a=e.Path.USERS_USERID_METADATA_KEY.replace("%s",encodeURIComponent(s.userId)).replace("%s",encodeURIComponent(r));i.delete(a,null,n)}}))}},{key:"deleteAllUserMetaData",value:function(t,n){var i=this;this.sb.ConnectionManager.ready((function(t,r){if(t)n(t,null);else{var s=e.Path.USERS_USERID_METADATA.replace("%s",encodeURIComponent(r.userId));i.delete(s,null,n)}}))}},{key:"getMessageChangeLogs",value:function(t,n){var i=this,r=t.channelUrl,s=t.ts,a=t.timestamp,o=t.token,l=t.isOpenChannel,u=t.includeMetaArray,c=t.includeReaction,d=t.includeReactions,h=t.includeReplies,p=t.includeParentMessageText,f=t.includeThreadInfo,g=t.replyType,y=t.includeParentMessageInfo,m=t.includePollDetails;this.sb.ConnectionManager.ready((function(t,_){if(t)n(t,null);else{var v=l?e.Path.OPENCHANNELS_CHANNELURL_MESSAGES_CHANGELOGS.replace("%s",encodeURIComponent(r)):e.Path.GROUPCHANNELS_CHANNELURL_MESSAGES_CHANGELOGS.replace("%s",encodeURIComponent(r)),E=new te;o&&E.add("token",o),s&&E.add("change_ts",s),a&&E.add("change_ts",a),"boolean"==typeof u&&E.add("with_sorted_meta_array",u),"boolean"==typeof d?E.add("include_reactions",d):E.add("include_reactions","boolean"==typeof c&&c),"boolean"==typeof f&&E.add("include_thread_info",f),"string"==typeof g?E.add("include_reply_type",g):E.add("include_reply_type","boolean"==typeof h&&h?i.cls.BaseMessage.ReplyType.ALL:i.cls.BaseMessage.ReplyType.NONE),"boolean"==typeof y?E.add("include_parent_message_info",y):E.add("include_parent_message_info","boolean"==typeof p&&p),"boolean"==typeof m&&E.add("include_poll_details",m),i.get(v,E,n)}}))}},{key:"getMyMutedInfo",value:function(t,n){var i=this,r=t.channelUrl,s=t.userId,a=t.isGroupChannel;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=a?e.Path.GROUPCHANNELS_CHANNELURL_MUTE_USERID.replace("%s",encodeURIComponent(r)).replace("%s",encodeURIComponent(s)):e.Path.OPENCHANNELS_CHANNELURL_MUTE_USERID.replace("%s",encodeURIComponent(r)).replace("%s",encodeURIComponent(s));i.get(l,null,n)}}))}},{key:"loadBannedUserList",value:function(t,n){var i=this,r=t.token,s=t.limit,a=t.channelUrl,o=t.isOpenChannel;this.sb.ConnectionManager.ready((function(t,l){if(t)n(t,null);else{var u=o?e.Path.OPENCHANNELS_CHANNELURL_BAN.replace("%s",encodeURIComponent(a)):e.Path.GROUPCHANNELS_CHANNELURL_BAN.replace("%s",encodeURIComponent(a)),c=new te({token:r,limit:s});i.get(u,c,n)}}))}},{key:"loadMutedUserList",value:function(t,n){var i=this,r=t.token,s=t.limit,a=t.channelUrl,o=t.isOpenChannel;this.sb.ConnectionManager.ready((function(t,l){if(t)n(t,null);else{var u=o?e.Path.OPENCHANNELS_CHANNELURL_MUTE.replace("%s",encodeURIComponent(a)):e.Path.GROUPCHANNELS_CHANNELURL_MUTE.replace("%s",encodeURIComponent(a)),c=new te({token:r,limit:s});i.get(u,c,n)}}))}},{key:"getMessageList",value:function(t,n){var i=this,r=t.channel,s=t.token,a=t.tokenType,o=t.isInclusive,l=t.prevResultSize,u=void 0===l?0:l,c=t.nextResultSize,d=void 0===c?0:c,h=t.shouldReverse,p=t.messageType,f=t.customType,g=t.customTypes,y=t.senderUserIds,m=t.includeMetaArray,_=t.includeReaction,v=t.includeReactions,E=t.includeReplies,C=t.includeParentMessageText,b=t.includeThreadInfo,S=t.replyType,A=t.includeParentMessageInfo,k=t.showSubchannelMessagesOnly,I=t.includePollDetails,U=t.rootMessageId,O=t.parentMessageId;this.sb.ConnectionManager.ready((function(t,l){if(t)n(t,null);else{var c=r.isOpenChannel()?e.Path.OPENCHANNELS_CHANNELURL_MESSAGES.replace("%s",r.url):e.Path.GROUPCHANNELS_CHANNELURL_MESSAGES.replace("%s",r.url),T=new te({is_sdk:String(!0),prev_limit:String(u),next_limit:String(d),include:String(o),reverse:String(h)});"timestamp"===a?T.add("message_ts",s):"messageId"===a&&T.add("message_id",String(s)),p&&T.add("message_type",String(p)),Array.isArray(g)&&(0===g.length&&("string"==typeof f?g.push(f):g.push("*")),T.add("custom_types",g)),Array.isArray(y)&&y.length>0&&T.add("sender_ids",y),"boolean"==typeof m&&T.add("with_sorted_meta_array",m),"boolean"==typeof v?T.add("include_reactions",v):T.add("include_reactions","boolean"==typeof _&&_),"boolean"==typeof b&&T.add("include_thread_info",b),"string"==typeof S?T.add("include_reply_type",S):T.add("include_reply_type","boolean"==typeof E&&E?i.cls.BaseMessage.ReplyType.ALL:i.cls.BaseMessage.ReplyType.NONE),"boolean"==typeof A?T.add("include_parent_message_info",A):T.add("include_parent_message_info","boolean"==typeof C&&C),"boolean"==typeof k&&r.isOpenChannel()&&T.add("show_subchannel_messages_only",k),"boolean"==typeof I&&T.add("include_poll_details",I),U&&T.add("root_message_id",U),O&&T.add("parent_message_id",O),i.get(c,T,n)}}))}},{key:"translateUserMessage",value:function(t,n){var i=this,r=t.channelUrl,s=t.isOpenChannel,a=t.messageId,o=t.translationTargetLanguages;this.sb.ConnectionManager.ready((function(t,l){if(t)n(t,null);else{var u=s?e.Path.OPENCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_TRANSLATION.replace("%s",encodeURIComponent(r)).replace("%s",a):e.Path.GROUPCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_TRANSLATION.replace("%s",encodeURIComponent(r)).replace("%s",a),c=new te({target_langs:o});i.post(u,c,n)}}))}},{key:"getMessage",value:function(t,n){var i=this,r=t.channel,s=t.messageId,a=t.includeMetaArray,o=t.includeReactions,l=t.includeParentMessageText,u=t.includeThreadInfo,c=t.includeParentMessageInfo,d=t.includePollDetails;this.sb.ConnectionManager.ready((function(t,h){if(t)n(t,null);else{var p=r.isOpenChannel()?e.Path.OPENCHANNELS_CHANNELURL_MESSAGES_MESSAGEID.replace("%s",encodeURIComponent(r.url)).replace("%s",encodeURIComponent(s)):e.Path.GROUPCHANNELS_CHANNELURL_MESSAGES_MESSAGEID.replace("%s",encodeURIComponent(r.url)).replace("%s",encodeURIComponent(s)),f=new te({is_sdk:String(!0)});"boolean"==typeof a&&f.add("with_sorted_meta_array",a),"boolean"==typeof o&&f.add("include_reactions",o),"boolean"==typeof u&&f.add("include_thread_info",u),"boolean"==typeof c?f.add("include_parent_message_info",c):f.add("include_parent_message_info","boolean"==typeof l&&l),"boolean"==typeof d&&f.add("include_poll_details",d),i.get(p,f,n)}}))}},{key:"deleteMessage",value:function(t,n){var i=this,r=t.channelUrl,s=t.isOpenChannel,a=t.messageId;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=s?e.Path.OPENCHANNELS_CHANNELURL_MESSAGES_MESSAGEID.replace("%s",encodeURIComponent(r)).replace("%s",encodeURIComponent(a)):e.Path.GROUPCHANNELS_CHANNELURL_MESSAGES_MESSAGEID.replace("%s",encodeURIComponent(r)).replace("%s",encodeURIComponent(a));i.delete(l,null,n)}}))}},{key:"muteUser",value:function(t,n){var i=this,r=t.channelUrl,s=t.userId,a=t.description,o=t.seconds,l=t.isGroupChannel;this.sb.ConnectionManager.ready((function(t,u){if(t)n(t,null);else{var c=l?e.Path.GROUPCHANNELS_CHANNELURL_MUTE.replace("%s",encodeURIComponent(r)):e.Path.OPENCHANNELS_CHANNELURL_MUTE.replace("%s",encodeURIComponent(r)),d=new te({user_id:s});o&&(o>0||-1!==o)&&d.add("seconds",o),a&&d.add("description",a),i.post(c,d,n)}}))}},{key:"unmuteUser",value:function(t,n){var i=this,r=t.channelUrl,s=t.userId,a=t.isGroupChannel;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=a?e.Path.GROUPCHANNELS_CHANNELURL_MUTE_USERID.replace("%s",encodeURIComponent(r)).replace("%s",encodeURIComponent(s)):e.Path.OPENCHANNELS_CHANNELURL_MUTE_USERID.replace("%s",encodeURIComponent(r)).replace("%s",encodeURIComponent(s));i.delete(l,null,n)}}))}},{key:"banUser",value:function(t,n){var i=this,r=t.channelUrl,s=t.userId,a=t.description,o=t.seconds,l=t.isGroupChannel;this.sb.ConnectionManager.ready((function(t,u){if(t)n(t,null);else{var c=l?e.Path.GROUPCHANNELS_CHANNELURL_BAN.replace("%s",encodeURIComponent(r)):e.Path.OPENCHANNELS_CHANNELURL_BAN.replace("%s",encodeURIComponent(r)),d=new te({user_id:s});a&&d.add("description",a),d.add("seconds",String(o)),i.post(c,d,n)}}))}},{key:"unbanUser",value:function(t,n){var i=this,r=t.channelUrl,s=t.userId,a=t.isGroupChannel;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=a?e.Path.GROUPCHANNELS_CHANNELURL_BAN_USERID.replace("%s",encodeURIComponent(r)).replace("%s",encodeURIComponent(s)):e.Path.OPENCHANNELS_CHANNELURL_BAN_USERID.replace("%s",encodeURIComponent(r)).replace("%s",encodeURIComponent(s));i.delete(l,null,n)}}))}},{key:"getMetaCounters",value:function(t,n){var i=this,r=t.channelUrl,s=t.isOpenChannel,a=t.keys;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=s?e.Path.OPENCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(r)):e.Path.GROUPCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(r)),u=new te({keys:a});i.get(l,u,n)}}))}},{key:"createMetaCounters",value:function(t,n){var i=this,r=t.channelUrl,s=t.isOpenChannel,a=t.metaCounter;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=s?e.Path.OPENCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(r)):e.Path.GROUPCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(r)),u=new te({metacounter:a});i.post(l,u,n)}}))}},{key:"updateMetaCounters",value:function(t,n){var i=this,r=t.channelUrl,s=t.isOpenChannel,a=t.metaCounter,o=t.upsert,l=t.mode;this.sb.ConnectionManager.ready((function(t,u){if(t)n(t,null);else{var c=s?e.Path.OPENCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(r)):e.Path.GROUPCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(r)),d=new te({metacounter:a,upsert:o,mode:l});i.put(c,d,n)}}))}},{key:"deleteMetaCounter",value:function(t,n){var i=this,r=t.channelUrl,s=t.isOpenChannel,a=t.key;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=s?e.Path.OPENCHANNELS_CHANNELURL_METACOUNTER_KEY.replace("%s",encodeURIComponent(r)).replace("%s",a):e.Path.GROUPCHANNELS_CHANNELURL_METACOUNTER_KEY.replace("%s",encodeURIComponent(r)).replace("%s",a);i.delete(l,null,n)}}))}},{key:"deleteAllMetaCounters",value:function(t,n){var i=this,r=t.channelUrl,s=t.isOpenChannel;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var o=s?e.Path.OPENCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(r)):e.Path.GROUPCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(r));i.delete(o,null,n)}}))}},{key:"getMetaData",value:function(t,n){var i=this,r=t.channelUrl,s=t.isOpenChannel,a=t.keys;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=s?e.Path.OPENCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(r)):e.Path.GROUPCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(r)),u=new te({keys:a,include_ts:!0});i.get(l,u,n)}}))}},{key:"createMetaData",value:function(t,n){var i=this,r=t.channelUrl,s=t.isOpenChannel,a=t.metaData;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=s?e.Path.OPENCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(r)):e.Path.GROUPCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(r)),u=new te({metadata:a,include_ts:!0});i.post(l,u,n)}}))}},{key:"updateMetaData",value:function(t,n){var i=this,r=t.channelUrl,s=t.isOpenChannel,a=t.metaData,o=t.upsert;this.sb.ConnectionManager.ready((function(t,l){if(t)n(t,null);else{var u=s?e.Path.OPENCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(r)):e.Path.GROUPCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(r)),c=new te({metadata:a,upsert:o,include_ts:!0});i.put(u,c,n)}}))}},{key:"deleteMetaData",value:function(t,n){var i=this,r=t.channelUrl,s=t.isOpenChannel,a=t.key;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=s?e.Path.OPENCHANNELS_CHANNELURL_METADATA_KEY.replace("%s",encodeURIComponent(r)).replace("%s",a):e.Path.GROUPCHANNELS_CHANNELURL_METADATA_KEY.replace("%s",encodeURIComponent(r)).replace("%s",a),u=new te({include_ts:!0});i.delete(l,u,n)}}))}},{key:"deleteAllMetaData",value:function(t,n){var i=this,r=t.channelUrl,s=t.isOpenChannel;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var o=s?e.Path.OPENCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(r)):e.Path.GROUPCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(r)),l=new te({include_ts:!0});i.delete(o,l,n)}}))}},{key:"loadOperatorList",value:function(t,n){var i=this,r=t.channelUrl,s=t.isOpenChannel,a=t.token,o=t.limit;this.sb.ConnectionManager.ready((function(t,l){if(t)n(t,null);else{var u=s?e.Path.OPENCHANNELS_OPERATORS.replace("%s",encodeURIComponent(r)):e.Path.GROUPCHANNELS_OPERATORS.replace("%s",encodeURIComponent(r)),c=new te({token:a,limit:o});i.get(u,c,n)}}))}},{key:"getOpenChannel",value:function(t,n){var i=this,r=t.channelUrl,s=t.internalCall;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var o=e.Path.OPENCHANNELS_CHANNELURL.replace("%s",encodeURIComponent(r)),l=new te({});l.internal=s===w.INTERNAL_CALL,i.get(o,l,n)}}))}},{key:"loadOpenChannelList",value:function(t,n){var i=this,r=t.token,s=t.limit,a=t.nameKeyword,o=t.urlKeyword,l=t.customTypes,u=t.includeFrozen,c=t.includeMetaData;this.sb.ConnectionManager.ready((function(t,d){if(t)n(t,null);else{var h=e.Path.OPENCHANNELS,p=new te({token:r,limit:s});a&&p.add("name_contains",a),o&&p.add("url_contains",o),l&&l.length>0&&p.add("custom_types",l),"boolean"==typeof u&&p.add("show_frozen",u),"boolean"==typeof c&&p.add("show_metadata",c),i.get(h,p,n)}}))}},{key:"loadParticipantList",value:function(t,n){var i=this,r=t.token,s=t.limit,a=t.channelUrl;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=e.Path.OPENCHANNELS_CHANNELURL_PARTICIPANTS.replace("%s",encodeURIComponent(a)),u=new te({token:r,limit:s});i.get(l,u,n)}}))}},{key:"createOpenChannel",value:function(t,n){var i=this,r=t.name,s=t.coverUrlOrImage,a=t.data,o=t.operatorUserIds,l=t.customType,u=t.channelUrl;this.sb.ConnectionManager.ready((function(t,c){if(t)n(t,null);else{var d=e.Path.OPENCHANNELS,h=new te;"string"==typeof s&&h.add("cover_url",s),ee.isFile(s)&&h.add("cover_file",s),null!==u&&"string"==typeof u&&h.add("channel_url",u),null!==r&&"string"==typeof r&&h.add("name",r),a&&h.add("data",a),o&&(Array.isArray(o)?h.add("operators",o):h.add("operators",[o])),l&&h.add("custom_type",l),i.post(d,h,n)}}))}},{key:"updateOpenChannel",value:function(t,n){var i=this,r=t.channelUrl,s=t.name,a=t.coverUrlOrImage,o=t.data,l=t.operatorUserIds,u=t.customType;this.sb.ConnectionManager.ready((function(t,c){if(t)n(t,null);else{var d=e.Path.OPENCHANNELS_CHANNELURL.replace("%s",encodeURIComponent(r)),h=new te;"string"==typeof a&&h.add("cover_url",a),ee.isFile(a)&&h.add("cover_file",a,a.name),null!==s&&"string"==typeof s&&h.add("name",s),null!==o&&"string"==typeof o&&h.add("data",o),null!==l&&(Array.isArray(l)?h.add("operator_ids",l):h.add("operator_ids",[l])),null!==u&&"string"==typeof u&&h.add("custom_type",u),i.put(d,h,n)}}))}},{key:"deleteOpenChannel",value:function(t,n){var i=this,r=t.channelUrl;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var a=e.Path.OPENCHANNELS_CHANNELURL.replace("%s",encodeURIComponent(r));i.delete(a,null,n)}}))}},{key:"getGroupChannel",value:function(t,n){var i=this,r=t.channelUrl,s=t.showMember,a=t.internalCall;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=e.Path.GROUPCHANNELS_CHANNELURL.replace("%s",encodeURIComponent(r)),u=new te({show_member:s,show_read_receipt:!0,show_delivery_receipt:!0});u.internal=a===w.INTERNAL_CALL,i.get(l,u,n)}}))}},{key:"loadGroupChannelList",value:function(t,n){var i=this,r=t.token,s=t.limit,a=t.includeEmpty,o=t.order,l=t.userIdsFilter,u=t.nicknameContainsFilter,c=t.channelNameContainsFilter,d=t.channelUrlsFilter,h=t.customTypesFilter,p=t.customTypeStartsWithFilter,f=t.memberStateFilter,g=t.superChannelFilter,y=t.publicChannelFilter,m=t.unreadChannelFilter,_=t.metadataOrderKeyFilter,v=t.metadataKey,E=t.metadataValues,C=t.metadataValueStartsWith,b=t.hiddenChannelFilter,S=t.searchFilter,A=t.includeFrozen,k=t.includeMetaData;this.sb.ConnectionManager.ready((function(t,I){if(t)n(t,null);else{var U=e.Path.MYGROUPCHANNELS.replace("%s",encodeURIComponent(I.userId)),O=new te({token:r,limit:s,order:o,show_member:!0,show_read_receipt:!0,show_delivery_receipt:!0,show_empty:String(a),member_state_filter:f});h&&h.length>0&&O.add("custom_types",h),u&&O.add("members_nickname_contains",u),c&&O.add("name_contains",c),S.hasOwnProperty("search_query")&&S.hasOwnProperty("search_fields")&&(O.add("search_query",S.search_query),O.add("search_fields",S.search_fields)),l.userIds&&l.userIds.length>0&&(l.includeMode?(O.add("members_include_in",l.userIds),O.add("query_type",l.queryType.toUpperCase())):O.add("members_exactly_in",l.userIds)),d&&d.length>0&&O.add("channel_urls",d),O.add("super_mode",g),O.add("public_mode",y),O.add("unread_filter",m),_&&O.add("metadata_order_key",_),v&&O.add("metadata_key",v),E&&E.length>0&&O.add("metadata_values",E),C&&O.add("metadata_value_startswith",C),p&&O.add("custom_type_startswith",p),b&&O.add("hidden_mode",b),"boolean"==typeof A&&O.add("show_frozen",A),"boolean"==typeof k&&O.add("show_metadata",k),i.get(U,O,n)}}))}},{key:"loadPublicGroupChannelList",value:function(t,n){var i=this,r=t.token,s=t.limit,a=t.includeEmpty,o=t.order,l=t.channelNameContainsFilter,u=t.channelUrlsFilter,c=t.customTypesFilter,d=t.customTypeStartsWithFilter,h=t.superChannelFilter,p=t.membershipFilter,f=t.metadataOrderKeyFilter,g=t.metadataKey,y=t.metadataValues,m=t.metadataValueStartsWith,_=t.includeFrozen,v=t.includeMetaData;this.sb.ConnectionManager.ready((function(t,E){if(t)n(t,null);else{var C=i.cls.GroupChannel,b=e.Path.GROUPCHANNELS,S=new te({token:r,limit:s,order:o,show_member:!0,show_read_receipt:!0,show_delivery_receipt:!0,show_empty:String(a),public_mode:C.PublicChannelFilter.PUBLIC,public_membership_mode:p});c&&c.length>0&&S.add("custom_types",c),l&&S.add("name_contains",l),u&&u.length>0&&S.add("channel_urls",u),S.add("super_mode",h),f&&S.add("metadata_order_key",f),g&&S.add("metadata_key",g),y&&y.length>0&&S.add("metadata_values",y),m&&S.add("metadata_value_startswith",m),d&&S.add("custom_type_startswith",d),"boolean"==typeof _&&S.add("show_frozen",_),"boolean"==typeof v&&S.add("show_metadata",v),i.get(b,S,n)}}))}},{key:"createGroupChannel",value:function(t,n){var i=this,r=t.isDistinct,s=t.isSuper,a=t.isBroadcast,o=t.isPublic,l=t.channelUrl,u=t.isDiscoverable,c=t.isStrict,d=t.name,h=t.data,p=t.customType,f=t.coverUrl,g=t.coverImage,y=t.accessCode,m=t.isEphemeral,_=t._invitedUserIds,v=void 0===_?[]:_,E=t.operatorUserIds,C=t.messageSurvivalSeconds;this.sb.ConnectionManager.ready((function(t,_){if(t)n(t,null);else{var b=e.Path.GROUPCHANNELS,S=new te({user_ids:[_.userId].concat(O(v)).filter((function(e,t,n){return t===n.indexOf(e)}))});null!==f&&"string"==typeof f&&S.add("cover_url",f),ee.isFile(g)&&S.add("cover_file",g,g.name),null!==l&&S.add("channel_url",l),null!==r&&S.add("is_distinct",r),null!==s&&S.add("is_super",s),null!==a&&S.add("is_broadcast",a),null!==o&&S.add("is_public",o),null!==u&&S.add("is_discoverable",u),null!==c&&S.add("strict",c),null!==m&&S.add("is_ephemeral",m),y&&S.add("access_code",y),null!==d&&"string"==typeof d&&S.add("name",d),h&&S.add("data",h),p&&S.add("custom_type",p),Array.isArray(E)&&E.length>0&&S.add("operator_ids",E),null!==C&&C>-1&&S.add("message_survival_seconds",C),i.post(b,S,n)}}))}},{key:"updateGroupChannel",value:function(t,n){var i=this,r=t.isDistinct,s=t.isPublic,a=t.channelUrl,o=t.isDiscoverable,l=t.name,u=t.data,c=t.customType,d=t.coverUrl,h=t.coverImage,p=t.accessCode,f=t.operatorUserIds,g=t.messageSurvivalSeconds;this.sb.ConnectionManager.ready((function(t,y){if(t)n(t,null);else{var m=e.Path.GROUPCHANNELS_CHANNELURL.replace("%s",encodeURIComponent(a)),_=new te;null!==r&&_.add("is_distinct",r),null!==s&&_.add("is_public",s),null!==o&&_.add("is_discoverable",o),null!==p&&_.add("access_code",p),null!==d&&"string"==typeof d&&_.add("cover_url",d),ee.isFile(h)&&_.add("cover_file",h,h.name),null!==l&&"string"==typeof l&&_.add("name",l),null!==u&&"string"==typeof u&&_.add("data",u),null!==c&&"string"==typeof c&&_.add("custom_type",c),null!==f&&(Array.isArray(f)?_.add("operator_ids",f):f&&_.add("operator_ids",[f])),null!==g&&g>-1&&_.add("message_survival_seconds",g),i.put(m,_,n)}}))}},{key:"addOperators",value:function(t,n){var i=this,r=t.channelUrl,s=t.isOpenChannel,a=void 0!==s&&s,o=t.operatorUserIds;this.sb.ConnectionManager.ready((function(t,s){if(!t){var l=(a?e.Path.OPENCHANNELS_CHANNELURL_OPERATORS:e.Path.GROUPCHANNELS_CHANNELURL_OPERATORS).replace("%s",encodeURIComponent(r)),u=new te({operator_ids:o});i.post(l,u,n)}}))}},{key:"removeOperators",value:function(t,n){var i=this,r=t.channelUrl,s=t.isOpenChannel,a=void 0!==s&&s,o=t.operatorUserIds;this.sb.ConnectionManager.ready((function(t,s){if(!t){var l=(a?e.Path.OPENCHANNELS_CHANNELURL_OPERATORS:e.Path.GROUPCHANNELS_CHANNELURL_OPERATORS).replace("%s",encodeURIComponent(r)),u=new te({operator_ids:o});i.delete(l,u,n)}}))}},{key:"inviteToGroupChannel",value:function(t,n){var i=this,r=t.channelUrl,s=t.userIds;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var o=e.Path.GROUPCHANNELS_CHANNELURL_INVITE.replace("%s",encodeURIComponent(r)),l=new te({user_ids:s});i.post(o,l,n)}}))}},{key:"acceptInvitation",value:function(t,n){var i=this,r=t.channelUrl,s=t.accessCode;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var o=e.Path.GROUPCHANNELS_CHANNELURL_ACCEPT_INVITATION.replace("%s",encodeURIComponent(r)),l=new te({user_id:a.userId});s&&l.add("access_code",s),i.put(o,l,n)}}))}},{key:"declineInvitation",value:function(t,n){var i=this,r=t.channelUrl;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var a=e.Path.GROUPCHANNELS_CHANNELURL_DECLINE_INVITATION.replace("%s",encodeURIComponent(r)),o=new te({user_id:s.userId});i.put(a,o,n)}}))}},{key:"joinGroupChannel",value:function(t,n){var i=this,r=t.channelUrl,s=t.accessCode;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var o=e.Path.GROUPCHANNELS_CHANNELURL_JOIN.replace("%s",encodeURIComponent(r)),l=new te({user_id:a.userId});s&&l.add("access_code",s),i.put(o,l,n)}}))}},{key:"leaveGroupChannel",value:function(t,n){var i=this,r=t.channelUrl;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var a=e.Path.GROUPCHANNELS_CHANNELURL_LEAVE.replace("%s",encodeURIComponent(r)),o=new te({user_id:s.userId});i.put(a,o,n)}}))}},{key:"hideGroupChannel",value:function(t,n){var i=this,r=t.channelUrl,s=t.hidePreviousMessages,a=t.allowAutoUnhide;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=e.Path.GROUPCHANNELS_CHANNELURL_HIDE.replace("%s",encodeURIComponent(r)),u=new te({user_id:o.userId,hide_previous_messages:s,allow_auto_unhide:a});i.put(l,u,n)}}))}},{key:"unhideGroupChannel",value:function(t,n){var i=this,r=t.channelUrl;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var a=e.Path.GROUPCHANNELS_CHANNELURL_HIDE.replace("%s",encodeURIComponent(r));i.delete(a,null,n)}}))}},{key:"freeze",value:function(t,n){var i=this,r=t.channelUrl,s=t.isGroupChannel,a=t.freezing;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=s?e.Path.GROUPCHANNELS_CHANNELURL_FREEZE.replace("%s",encodeURIComponent(r)):e.Path.OPENCHANNELS_CHANNELURL_FREEZE.replace("%s",encodeURIComponent(r)),u=new te({freeze:a});i.put(l,u,n)}}))}},{key:"deleteGroupChannel",value:function(t,n){var i=this,r=t.channelUrl;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var a=e.Path.GROUPCHANNELS_CHANNELURL.replace("%s",encodeURIComponent(r));i.delete(a,null,n)}}))}},{key:"loadMemberList",value:function(t,n){var i=this,r=t.channelUrl,s=t.token,a=t.limit,o=t.mutedMemberFilter,l=t.order,u=t.memberStateFilter,c=t.nicknameStartsWithFilter;this.sb.ConnectionManager.ready((function(t,d){if(t)n(t,null);else{var h=e.Path.GROUPCHANNELS_MEMBERS.replace("%s",encodeURIComponent(r)),p=new te({token:s,limit:a,order:l.toLowerCase(),muted_member_filter:o.toLowerCase(),member_state_filter:u,show_member_is_muted:!0,show_read_receipt:!0,show_delivery_receipt:!0});c&&p.add("nickname_startswith",c),i.get(h,p,n)}}))}},{key:"report",value:function(t,n){var i=this,r=t.channelUrl,s=t.isOpenChannel,a=t.reportCategory,o=t.reportingUserId,l=t.reportDescription;this.sb.ConnectionManager.ready((function(t,u){if(t)n(t,null);else{var c=e.Path.REPORT_CHANNELS.replace("%s",encodeURIComponent(s?"open_channels":"group_channels")).replace("%s",encodeURIComponent(r)),d=new te({report_category:a});null!=o&&d.add("reporting_user_id",o),null!=l&&d.add("report_description",l),i.post(c,d,n)}}))}},{key:"reportUser",value:function(t,n){var i=this,r=t.offendingUserId,s=t.channelUrl,a=t.isOpenChannel,o=t.reportCategory,l=t.reportingUserId,u=t.reportDescription;this.sb.ConnectionManager.ready((function(t,c){if(t)n(t,null);else{var d=e.Path.REPORT_USERS.replace("%s",encodeURIComponent(r)),h=new te({channel_url:s,channel_type:a?"open_channels":"group_channels",report_category:o});null!=l&&h.add("reporting_user_id",l),null!=u&&h.add("report_description",u),i.post(d,h,n)}}))}},{key:"reportMessage",value:function(t,n){var i=this,r=t.channelUrl,s=t.isOpenChannel,a=t.messageId,o=t.reportCategory,l=t.reportingUserId,u=t.reportDescription,c=t.offendingUserId;this.sb.ConnectionManager.ready((function(t,d){if(t)n(t,null);else{var h=e.Path.REPORT_MESSAGES.replace("%s",encodeURIComponent(s?"open_channels":"group_channels")).replace("%s",encodeURIComponent(r)).replace("%s",encodeURIComponent(a)),p=new te({report_category:o,offending_user_id:c});null!=l&&p.add("reporting_user_id",l),null!=u&&p.add("report_description",u),i.post(h,p,n)}}))}},{key:"sendUserMessage",value:function(t,n){var i=this,r=t.channelUrl,s=t.isOpenChannel,a=t.message,o=t.data,l=t.customType,u=t.translationTargetLanguages,c=t.metaArrays,d=t.mentionType,h=t.mentionedUserIds,p=t.pushNotificationDeliveryOption,f=t.rootMessageId,g=t.parentMessageId,y=t.appleCriticalAlertOptions,m=t.pollId,_=t.isReplyToChannel;this.sb.ConnectionManager.ready((function(t,v){if(t)n(t,null);else{var E=i.cls.FileMessageParams,C=s?e.Path.OPENCHANNELS_CHANNELURL_MESSAGES.replace("%s",encodeURIComponent(r)):e.Path.GROUPCHANNELS_CHANNELURL_MESSAGES.replace("%s",encodeURIComponent(r)),b=new te({message_type:"MESG",user_id:v.userId,message:a,mention_type:d,mentioned_user_ids:[]});null!=o&&b.add("data",o),null!=l&&b.add("custom_type",l),u&&b.add("translation_target_langs",u),c&&c.length>0&&b.add("sorted_metaarray",c.map((function(e){return e.encode()}))),d===i.cls.BaseMessageParams.MentionType.CHANNEL?b.add("mentioned_user_ids",[]):Array.isArray(h)&&h.length>0&&b.add("mentioned_user_ids",h),p&&p!==E.PushNotificationDeliveryOption.DEFAULT&&b.add("push_option",p),f&&b.add("root_message_id",f),g&&b.add("parent_message_id",g),y&&b.add("apple_critical_alert_options",y.serialize()),"number"==typeof m?b.add("poll_id",m):null===m&&b.add("poll_id",-1),_&&b.add("reply_to_channel",_),i.post(C,b,n)}}))}},{key:"sendFileMessage",value:function(t,n){var i=this,r=t.channelUrl,s=t.isOpenChannel,a=t.fileUrl,o=t.fileName,l=t.fileSize,u=t.fileType,c=t.data,d=t.customType,h=t.thumbnailSizes,p=t.requireAuth,f=t.metaArrays,g=t.mentionType,y=t.mentionedUserIds,m=t.pushNotificationDeliveryOption,_=t.rootMessageId,v=t.parentMessageId,E=t.appleCriticalAlertOptions,C=t.isReplyToChannel;this.sb.ConnectionManager.ready((function(t,b){if(t)n(t,null);else{var S=i.cls.FileMessageParams,A=s?e.Path.OPENCHANNELS_CHANNELURL_MESSAGES.replace("%s",encodeURIComponent(r)):e.Path.GROUPCHANNELS_CHANNELURL_MESSAGES.replace("%s",encodeURIComponent(r)),k=new te({message_type:"FILE",user_id:b.userId,url:a,mention_type:g,mentioned_user_ids:[]});null!=o&&k.add("file_name",o),null!=l&&k.add("file_size",l),null!=u&&k.add("file_type",u),null!=c&&k.add("custom_field",c),null!=d&&k.add("custom_type",d),h&&k.add("thumbnails",h),p&&k.add("require_auth",p),f&&f.length>0&&k.add("sorted_metaarray",f.map((function(e){return e.encode()}))),g===i.cls.BaseMessageParams.MentionType.CHANNEL?k.add("mentioned_user_ids",[]):Array.isArray(y)&&y.length>0&&k.add("mentioned_user_ids",y),m&&m!==S.PushNotificationDeliveryOption.DEFAULT&&k.add("push_option",m),_&&k.add("root_message_id",_),v&&k.add("parent_message_id",v),E&&k.add("apple_critical_alert_options",E.serialize()),C&&k.add("reply_to_channel",C),i.post(A,k,n)}}))}},{key:"uploadFile",value:function(t,n){var i=this,r=t.file,s=t.thumbnailSizes,a=t.channelUrl,o=t.progressHandler,l=t.reqId;this.sb.ConnectionManager.ready((function(t,u){if(t)n(t,null);else{var c=L.get(i.sb._iid).container.appInfo;if(c)if("number"==typeof r.size||r.size||(r.size=0),"number"==typeof r.size)if(r.size<=c.uploadSizeLimit){var d=e.Path.STORAGE_FILE,h=new te;if(h.add("file",r,r.name),a&&"string"==typeof a&&h.add("channel_url",a),s)for(var p=0;p<s.length;p++)h.add("thumbnail"+(p+1),s[p].maxWidth+","+s[p].maxHeight);h.upload.reqId=l,h.upload.deleteRequest=function(){var e=i.cls.FileMessageQueue;e.uploadRequest[l]&&delete e.uploadRequest[l]},h.upload.progressHandler=function(e){o&&"function"==typeof o&&o(e,l)},i.post(d,h,n)}else n(new D("The file size exceeded the upload limit: ".concat(c.uploadSizeLimit),D.FILE_SIZE_LIMIT_EXCEEDED),null);else n(new D("Invalid file size: ".concat(r.size),D.INVALID_PARAMETER),null);else n(new D("Connection should be made first.",D.CONNECTION_REQUIRED),null)}}))}},{key:"registerScheduledUserMessage",value:function(t,n){var i=this,r=t.groupChannelParams,s=t.channelUrl,a=t.isOpenChannel;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=a?e.Path.OPENCHANNELS_CHANNELURL_SCHEDULED_MESSAGES.replace("%s",encodeURIComponent(s)):e.Path.GROUPCHANNELS_CHANNELURL_SCHEDULED_MESSAGES.replace("%s",encodeURIComponent(s)),u=new te({scheduled_dt:r._getScheduleString(),user_id:o.userId,message:r.message,data:r.data});r.customType&&u.add("custom_type",r.customType),r.metaArrayKeys&&Object.keys(r.metaArrayKeys).length>0&&u.add("metaarray",r.metaArrayKeys),r.mentionType&&u.add("mention_type",r._mentionType),r._mentionType===i.cls.BaseMessageParams.MentionType.CHANNEL?u.add("mentioned_user_ids",[]):Array.isArray(r._mentionedUserIds)&&r._mentionedUserIds.length>0&&u.add("mentioned_user_ids",r._mentionedUserIds),r.translationTargetLanguages&&r.translationTargetLanguages.length>0&&u.add("translation_target_langs",r.translationTargetLanguages),r.pushNotificationDeliveryOption&&r.pushNotificationDeliveryOption!==i.cls.BaseMessageParams.PushNotificationDeliveryOption.DEFAULT&&u.add("push_option",r.pushNotificationDeliveryOption),r.appleCriticalAlertOptions&&u.add("apple_critical_alert_options",r.appleCriticalAlertOptions.serialize()),i.post(l,u,n)}}))}},{key:"getMyPushTriggerOption",value:function(t,n){var i=this,r=t.channelUrl;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var a=e.Path.USERS_USERID_PUSHPREFERENCE_CHANNELURL.replace("%s",encodeURIComponent(s.userId)).replace("%s",encodeURIComponent(r));i.get(a,null,n)}}))}},{key:"setMyPushTriggerOption",value:function(t,n){var i=this,r=t.channelUrl,s=t.pushTriggerOption,a=t.enable;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=e.Path.USERS_USERID_PUSHPREFERENCE_CHANNELURL.replace("%s",encodeURIComponent(o.userId)).replace("%s",encodeURIComponent(r)),u=new te;s&&u.add("push_trigger_option",s),"boolean"==typeof a&&u.add("enable",a),i.put(l,u,n)}}))}},{key:"setMyCountPreference",value:function(t,n){var i=this,r=t.channelUrl,s=t.countPreference;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var o=e.Path.USERS_COUNT_PREFERENCE.replace("%s",encodeURIComponent(a.userId)).replace("%s",encodeURIComponent(r)),l=new te({count_preference:s});i.put(o,l,n)}}))}},{key:"resetMyHistory",value:function(t,n){var i=this,r=t.channelUrl;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var a=e.Path.GROUPCHANNELS_RESET_USER_HISTORY.replace("%s",encodeURIComponent(r));i.put(a,null,n)}}))}},{key:"addReaction",value:function(t,n){var i=this,r=t.isGroupChannel,s=t.channelUrl,a=t.messageId,o=t.key;this.sb.ConnectionManager.ready((function(t,l){if(t)n(t,null);else{var u=r?e.Path.GROUPCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_REACTION.replace("%s",encodeURIComponent(s)).replace("%s",encodeURIComponent(a)):e.Path.OPENCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_REACTION.replace("%s",encodeURIComponent(s)).replace("%s",encodeURIComponent(a)),c=new te({reaction:o});i.post(u,c,n)}}))}},{key:"deleteReaction",value:function(t,n){var i=this,r=t.isGroupChannel,s=t.channelUrl,a=t.messageId,o=t.key;this.sb.ConnectionManager.ready((function(t,l){if(t)n(t,null);else{var u=r?e.Path.GROUPCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_REACTION.replace("%s",encodeURIComponent(s)).replace("%s",encodeURIComponent(a)):e.Path.OPENCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_REACTION.replace("%s",encodeURIComponent(s)).replace("%s",encodeURIComponent(a)),c=new te({reaction:o});i.delete(u,c,n)}}))}},{key:"getAllEmoji",value:function(t){var n=this;this.sb.ConnectionManager.ready((function(i,r){i?t(i,null):n.get(e.Path.EMOJI_CATEGORIES,null,t)}))}},{key:"getEmojiCategory",value:function(t,n){var i=this,r=t.categoryId;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var a=e.Path.EMOJI_CATEGORIES_CATEGORYID.replace("%s",r);i.get(a,null,n)}}))}},{key:"getEmoji",value:function(t,n){var i=this,r=t.emojiKey;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var a=e.Path.EMOJIS_EMOJIKEY.replace("%s",r);i.get(a,null,n)}}))}},{key:"getAllowFriendDiscovery",value:function(t){var n=this;this.sb.ConnectionManager.ready((function(i,r){if(i)t(i,null);else{var s=e.Path.USERS_USERID_ALLOW_FRIEND_DISCOVERY.replace("%s",encodeURIComponent(r.userId));n.get(s,null,t)}}))}},{key:"setAllowFriendDiscovery",value:function(t,n){var i=this,r=t.allowFriendDiscovery;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var a=e.Path.USERS_USERID_ALLOW_FRIEND_DISCOVERY.replace("%s",encodeURIComponent(s.userId)),o=new te;"boolean"==typeof r&&o.add("allow_friend_discovery",r),i.put(a,o,n)}}))}},{key:"getPollList",value:function(t,n){var i=this,r=t.channelUrl,s=t.token,a=t.limit;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=e.Path.POLLS,u=new te({channel_url:r});s&&u.add("token",s),a&&u.add("limit",a),i.get(l,u,n)}}))}},{key:"getPoll",value:function(t,n){var i=this,r=t.channelUrl,s=t.pollId,a=t.showPartialVoters;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=e.Path.POLLS_POLLID.replace("%s",s),u=new te({channel_url:r});"boolean"==typeof a&&u.add("show_partial_voter_list",a),i.get(l,u,n)}}))}},{key:"createPoll",value:function(t,n){var i=this,r=t.title,s=t.options,a=t.data,o=t.isAnonymous,l=t.allowUserSuggestion,u=t.allowMultipleVotes,c=t.closeAt;this.sb.ConnectionManager.ready((function(t,d){if(t)n(t,null);else{var p=e.Path.POLLS,f=new te({title:r,options:s});"object"===h(a)&&f.add("data",a),"boolean"==typeof o&&f.add("is_anonymous",o),"boolean"==typeof l&&f.add("allow_user_suggestion",l),"boolean"==typeof u&&f.add("allow_multiple_votes",u),"number"==typeof c&&f.add("close_at",c),i.post(p,f,n)}}))}},{key:"updatePoll",value:function(t,n){var i=this,r=t.pollId,s=t.title,a=t.options,o=t.data,l=t.isAnonymous,u=t.allowUserSuggestion,c=t.allowMultipleVotes,d=t.closeAt;this.sb.ConnectionManager.ready((function(t,p){if(t)n(t,null);else{var f=e.Path.POLLS_POLLID.replace("%s",r),g=new te;"string"==typeof s&&g.add("title",s),Array.isArray(a)&&g.add("options",a),"object"===h(o)&&g.add("data",o),"boolean"==typeof l&&g.add("is_anonymous",l),"boolean"==typeof u&&g.add("allow_user_suggestion",u),"boolean"==typeof c&&g.add("allow_multiple_votes",c),"number"==typeof d&&g.add("close_at",d),i.put(f,g,n)}}))}},{key:"deletePoll",value:function(t,n){var i=this,r=t.pollId;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var a=e.Path.POLLS_POLLID.replace("%s",r);i.delete(a,null,n)}}))}},{key:"votePoll",value:function(t,n){var i=this,r=t.channelUrl,s=t.pollId,a=t.optionIds;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=e.Path.POLLS_POLLID_VOTE.replace("%s",s),u=new te({channel_url:r});Array.isArray(a)&&u.add("option_ids",a),i.put(l,u,n)}}))}},{key:"closePoll",value:function(t,n){var i=this,r=t.pollId;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var a=e.Path.POLLS_POLLID_CLOSE.replace("%s",r);i.put(a,null,n)}}))}},{key:"getPollOption",value:function(t,n){var i=this,r=t.channelUrl,s=t.pollId,a=t.optionId;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=e.Path.POLLS_POLLID_OPTIONS_OPTIONID.replace("%s",s).replace("%s",a),u=new te({channel_url:r});i.get(l,u,n)}}))}},{key:"addPollOption",value:function(t,n){var i=this,r=t.channelUrl,s=t.pollId,a=t.text;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=e.Path.POLLS_POLLID_OPTIONS.replace("%s",s),u=new te({channel_url:r,text:a});i.post(l,u,n)}}))}},{key:"updatePollOption",value:function(t,n){var i=this,r=t.pollId,s=t.optionId,a=t.text;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=e.Path.POLLS_POLLID_OPTIONS_OPTIONID.replace("%s",r).replace("%s",s),u=new te({text:a});i.put(l,u,n)}}))}},{key:"deletePollOption",value:function(t,n){var i=this,r=t.pollId,s=t.optionId;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var o=e.Path.POLLS_POLLID_OPTIONS_OPTIONID.replace("%s",r).replace("%s",s);i.delete(o,null,n)}}))}},{key:"getPollOptionVoterList",value:function(t,n){var i=this,r=t.channelUrl,s=t.pollId,a=t.optionId,o=t.token,l=t.limit;this.sb.ConnectionManager.ready((function(t,u){if(t)n(t,null);else{var c=e.Path.POLLS_POLLID_OPTIONS_OPTIONID_VOTERS.replace("%s",s).replace("%s",a),d=new te({channel_url:r});o&&d.add("token",o),l&&d.add("limit",l),i.get(c,d,n)}}))}}],[{key:"Path",get:function(){return{USERS:"/users",USERS_USERID:"/users/%s",USERS_USERID_LOGIN:"/users/%s/login",USERS_USERID_SESSION_KEY:"/users/%s/session_key",USERS_USERID_METADATA:"/users/%s/metadata",USERS_USERID_METADATA_KEY:"/users/%s/metadata/%s",USERS_USERID_MARKASREADALL:"/users/%s/mark_as_read_all",USERS_USERID_MY_GROUP_CHANNEL_CHANGELOGS:"/users/%s/my_group_channels/changelogs",USERS_USERID_UNREAD_ITEM_COUNT:"/users/%s/unread_item_count",USERS_USERID_UNREAD_MESSAGE_COUNT:"/users/%s/unread_message_count",USERS_USERID_UNREAD_CHANNEL_COUNT:"/users/%s/unread_channel_count",USERS_USERID_PUSH_GCM_TOKEN:"/users/%s/push/gcm/%s",USERS_USERID_PUSH_GCM:"/users/%s/push/gcm",USERS_USERID_PUSH_DEVICE_TOKENS:"/users/%s/push/%s/device_tokens",USERS_USERID_PUSHPREFERENCE_CHANNELURL:"/users/%s/push_preference/%s",USERS_USERID_PUSHPREFERENCE:"/users/%s/push_preference/",USERS_USERID_PUSH_TEMPLATE:"/users/%s/push/template",USERS_USERID_BLOCK:"/users/%s/block",USERS_USERID_BLOCK_TARGETID:"/users/%s/block/%s",USERS_USERID_PUSH_APNS_TOKEN:"/users/%s/push/apns/%s",USERS_USERID_PUSH_APNS:"/users/%s/push/apns",USERS_USERID_PUSH:"/users/%s/push",USERS_USERID_GROUP_CHANNEL_INVITATION_PREFERENCE:"/users/%s/channel_invitation_preference",USERS_USERID_GROUP_CHANNEL_COUNT:"/users/%s/group_channel_count",USERS_COUNT_PREFERENCE:"/users/%s/count_preference/%s",USERS_USERID_ALLOW_FRIEND_DISCOVERY:"/users/%s/allow_friend_discovery",OPENCHANNELS:"/open_channels",OPENCHANNELS_CHANNELURL:"/open_channels/%s",OPENCHANNELS_CHANNELURL_MESSAGES:"/open_channels/%s/messages",OPENCHANNELS_CHANNELURL_MESSAGES_MESSAGEID:"/open_channels/%s/messages/%s",OPENCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_TRANSLATION:"/open_channels/%s/messages/%s/translation",OPENCHANNELS_CHANNELURL_MESSAGES_CHANGELOGS:"/open_channels/%s/messages/changelogs",OPENCHANNELS_CHANNELURL_SCHEDULED_MESSAGES:"/open_channels/%s/scheduled_messages",OPENCHANNELS_CHANNELURL_PARTICIPANTS:"/open_channels/%s/participants",OPENCHANNELS_CHANNELURL_OPERATORS:"/open_channels/%s/operators",OPENCHANNELS_CHANNELURL_METADATA:"/open_channels/%s/metadata",OPENCHANNELS_CHANNELURL_METADATA_KEY:"/open_channels/%s/metadata/%s",OPENCHANNELS_CHANNELURL_METACOUNTER:"/open_channels/%s/metacounter",OPENCHANNELS_CHANNELURL_METACOUNTER_KEY:"/open_channels/%s/metacounter/%s",OPENCHANNELS_CHANNELURL_BAN:"/open_channels/%s/ban",OPENCHANNELS_CHANNELURL_BAN_USERID:"/open_channels/%s/ban/%s",OPENCHANNELS_CHANNELURL_MUTE:"/open_channels/%s/mute",OPENCHANNELS_CHANNELURL_MUTE_USERID:"/open_channels/%s/mute/%s",OPENCHANNELS_CHANNELURL_FREEZE:"/open_channels/%s/freeze",OPENCHANNELS_OPERATORS:"/open_channels/%s/operators",OPENCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_REACTION:"/open_channels/%s/messages/%s/reactions",GROUPCHANNELS:"/group_channels",MYGROUPCHANNELS:"/users/%s/my_group_channels",GROUPCHANNELS_CHANNELURL:"/group_channels/%s",GROUPCHANNELS_CHANNELURL_INVITE:"/group_channels/%s/invite",GROUPCHANNELS_CHANNELURL_ACCEPT_INVITATION:"/group_channels/%s/accept",GROUPCHANNELS_CHANNELURL_DECLINE_INVITATION:"/group_channels/%s/decline",GROUPCHANNELS_CHANNELURL_HIDE:"/group_channels/%s/hide",GROUPCHANNELS_CHANNELURL_LEAVE:"/group_channels/%s/leave",GROUPCHANNELS_CHANNELURL_JOIN:"/group_channels/%s/join",GROUPCHANNELS_CHANNELURL_OPERATORS:"/group_channels/%s/operators",GROUPCHANNELS_CHANNELURL_MESSAGES:"/group_channels/%s/messages",GROUPCHANNELS_CHANNELURL_MESSAGES_MARKASREAD:"/group_channels/%s/messages/mark_as_read",GROUPCHANNELS_CHANNELURL_MESSAGES_MARKASDELIVERED:"/group_channels/%s/messages/mark_as_delivered",GROUPCHANNELS_CHANNELURL_MESSAGES_TOTALCOUNT:"/group_channels/%s/messages/total_count",GROUPCHANNELS_CHANNELURL_MESSAGES_UNREADCOUNT:"/group_channels/%s/messages/unread_count",GROUPCHANNELS_CHANNELURL_MESSAGES_MESSAGEID:"/group_channels/%s/messages/%s",GROUPCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_TRANSLATION:"/group_channels/%s/messages/%s/translation",GROUPCHANNELS_CHANNELURL_MESSAGES_CHANGELOGS:"/group_channels/%s/messages/changelogs",GROUPCHANNELS_CHANNELURL_SCHEDULED_MESSAGES:"/group_channels/%s/scheduled_messages",GROUPCHANNELS_CHANNELURL_MEMBERS:"/group_channels/%s/members",GROUPCHANNELS_CHANNELURL_METADATA:"/group_channels/%s/metadata",GROUPCHANNELS_CHANNELURL_METADATA_KEY:"/group_channels/%s/metadata/%s",GROUPCHANNELS_CHANNELURL_METACOUNTER:"/group_channels/%s/metacounter",GROUPCHANNELS_CHANNELURL_METACOUNTER_KEY:"/group_channels/%s/metacounter/%s",GROUPCHANNELS_RESET_USER_HISTORY:"/group_channels/%s/reset_user_history",GROUPCHANNELS_OPERATORS:"/group_channels/%s/operators",GROUPCHANNELS_MEMBERS:"/group_channels/%s/members",GROUPCHANNELS_CHANNELURL_BAN:"/group_channels/%s/ban",GROUPCHANNELS_CHANNELURL_BAN_USERID:"/group_channels/%s/ban/%s",GROUPCHANNELS_CHANNELURL_MUTE:"/group_channels/%s/mute",GROUPCHANNELS_CHANNELURL_MUTE_USERID:"/group_channels/%s/mute/%s",GROUPCHANNELS_CHANNELURL_FREEZE:"/group_channels/%s/freeze",GROUPCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_REACTION:"/group_channels/%s/messages/%s/reactions",STORAGE_FILE:"/storage/file",STORAGE_PROFILE:"/storage/profile_image",FRIENDS:"/users/%s/friends",FRIENDS_CHANGE_LOGS:"/users/%s/friends/changelogs",FRIENDS_DISCOVERIES:"/users/%s/friend_discoveries",SEARCH_MESSAGE:"/search/messages",REPORT_USERS:"/report/users/%s",REPORT_CHANNELS:"/report/%s/%s",REPORT_MESSAGES:"/report/%s/%s/messages/%s",EMOJIS_EMOJIKEY:"/emojis/%s",EMOJI_CATEGORIES:"/emoji_categories",EMOJI_CATEGORIES_CATEGORYID:"/emoji_categories/%s",POLLS:"/polls",POLLS_POLLID:"/polls/%s",POLLS_POLLID_VOTE:"/polls/%s/vote",POLLS_POLLID_CLOSE:"/polls/%s/close",POLLS_POLLID_OPTIONS:"/polls/%s/options",POLLS_POLLID_OPTIONS_OPTIONID:"/polls/%s/options/%s",POLLS_POLLID_OPTIONS_OPTIONID_VOTERS:"/polls/%s/options/%s/voters"}}}]),e}(),re=function(){function e(t,n){p(this,e),this.sb=t,this.ws=null,this.wsHost=null,this.WebSocket=null,this.handler=n||new e.ConnectionHandler,this.explicitDisconnect=!1,this.lastActiveMillis=0;try{this.WebSocket="undefined"==typeof WebSocket?u.default:WebSocket}catch(e){this.WebSocket=WebSocket}}return g(e,[{key:"connect",value:function(e,t,n){var i=this;W.debug("`WebSocketClient.connect` called.");var r=L.get(this.sb._iid).container,s=r.pinger,a=r.auth,o=r.extensions,l=r.getUserAgentWithExtensions,u=r.sessionManager;this.wsHost=n;try{var c="/?p=JS&pv="+encodeURIComponent(w.OS_VERSION)+"&sv="+encodeURIComponent(w.SDK_VERSION)+"&ai="+encodeURIComponent(this.sb.getApplicationId());if(a.sessionKey?c+="&key="+encodeURIComponent(a.sessionKey):c+="&user_id="+encodeURIComponent(e)+"&access_token="+encodeURIComponent(t),c+="&active=1",c+="&SB-User-Agent="+encodeURIComponent(l(o)),c+="&Request-Sent-Timestamp="+(new Date).getTime().toString(),c+="&include_extra_data="+encodeURIComponent(["premium_feature_list","file_upload_size_limit","application_attributes","emoji_hash"].join(",")),u.handler&&(c+="&expiring_session=1"),this.sb.Options.includePollDetails&&(c+="&include_poll_details=1"),this.ws=new this.WebSocket(this.wsHost+c),!this.ws)return this.sb.isReconnectingOnError=!0,void this.handler.onError("ws does not exist.")}catch(e){return this.sb.isReconnectingOnError=!0,void this.handler.onError(e)}try{this.sb.getDebugMode()&&"undefined"!=typeof window&&(window.ws=this.ws)}catch(e){W.debug("`window` object does not exist.")}var d=!1;this.ws.onopen=function(e){W.debug("`WebSocket.onopen` called."),i.handler.onOpen(e)},this.ws.onmessage=function(e){i.active();for(var t=e.data.split("\n"),n=0;n<t.length;n++){var r=t[n];if(r&&"string"==typeof r){try{if("PONG"===r.substring(0,4)){s.pong();continue}}catch(e){W.debug("`WebSocket.onmessage` command check error:",e)}i.handler.onMessage(r)}}},this.ws.onerror=function(e){W.debug("`WebSocket.onerror` called:",e),s&&s.stop(),d=!0,i.sb.isReconnectingOnError=!0,i.handler.onError(e)},this.ws.onclose=function(e){W.group("`WebSocket.onclose` called.",[{level:W.supportedLogLevels.DEBUG,messages:["e",e]},{level:W.supportedLogLevels.DEBUG,messages:["explicitDisconnect",i.explicitDisconnect]}]),s&&s.stop(),i.explicitDisconnect?i.handler.onClose(e):d||i.handler.onError(e),i.explicitDisconnect=!1}}},{key:"disconnect",value:function(e,t){W.group("`WebSocketClient.onclose` called.",[{level:W.supportedLogLevels.DEBUG,messages:["explicit",e]}]);var n=L.get(this.sb._iid).container.pinger;n&&n.stop(),this.explicitDisconnect=!0===e,this.ws&&(this.ws.onopen=function(){},this.ws.onmessage=function(){},this.ws.onclose=function(){t&&t()},this.ws.onerror=function(){},this.ws.close(),this.ws=null),this.explicitDisconnect?this.handler.onClose():this.handler.onError(),this.explicitDisconnect=!1}},{key:"send",value:function(e,t){if(1!==this.ws.readyState)t&&t(new D("Connection is not valid. Please reconnect.",D.WEBSOCKET_CONNECTION_CLOSED),null);else{var n=L.get(this.sb._iid).container.pinger;this.ws.send(e.encode()),"PING"!==e.command&&n.refreshTimer(),t&&t(null,null)}}},{key:"active",value:function(){this.lastActiveMillis=(new Date).getTime()}},{key:"getConnectionState",value:function(){try{return 1===this.ws.readyState?this.sb.ConnectionState.OPEN:0===this.ws.readyState?this.sb.ConnectionState.CONNECTING:this.sb.ConnectionState.CLOSED}catch(e){return this.sb.ConnectionState.CLOSED}}}]),e}();re.ConnectionHandler=function e(){p(this,e),this.onReady=function(){},this.onOpen=function(){},this.onClose=function(){},this.onMessage=function(){},this.onError=function(){}};var se=function(){function e(t){p(this,e),this.sb=t,this.cls=G.get(this.sb._iid),this.client=new re(this.sb),this.connectParams={retryCount:1},this.reconnectParams={interval:3,retryCount:3,multiplier:2,maxInterval:24},this.connectCount=0,this.reconnectCount=0,this.reconnectDelay=0}return g(e,[{key:"isConnected",get:function(){return this.client&&this.client.getConnectionState()===this.sb.ConnectionState.OPEN}},{key:"connect",value:function(e,t){var n=this,i=L.get(this.sb._iid).container,r=i.auth,s=i.apiClient,a=i.commandHandler;r.sessionToken=t||null;var o=this.cls.GroupChannel,l=null,u=new re.ConnectionHandler;this.client=new re(this.sb,u),u.onMessage=function(e){a.onRawCommandReceived(e)},this.sb.loginHandler=function(e,t){if(n.sb.connecting=!1,e)n.disconnect({clearSession:!0,err:e},null);else{clearInterval(n.sb.globalTimer);var i=function(){o.cachedChannels&&Object.keys(o.cachedChannels).forEach((function(e){var t=o.cachedChannels[e];t.invalidateTypingStatus()&&Object.keys(n.sb.channelHandlers).forEach((function(e){n.sb.channelHandlers[e].onTypingStatusUpdated(t)}))}))};i(),n.sb.globalTimer=setInterval((function(){return i()}),1e3),n.flushConnectionCallbacks(null,t),n.sb.connecting=!1,n.sb.reconnecting=!1,n.sb.ConnectionManager.processAllReadyHandler(null)}},u.onOpen=function(){n.connectCount=0,n.sb.loginTimer=setTimeout((function(){n.sb.loginTimer=null,n.sb.onLoginTimerCancel=null,n.flushConnectionCallbacks(new D("Connection timeout.",D.LOGIN_TIMEOUT),null),n.sb.disconnect(null)}),n.sb.Options.websocketResponseTimeout),n.sb.onLoginTimerCancel=function(){n.connectCount=0,n.flushConnectionCallbacks(new D("Connection has been canceled.",D.REQUEST_FAILED),null)},n.sb.connecting=!1},u.onError=function(i){W.debug("Connect: `WebSocketClient.ConnectionHandler.onError` called.",i),r.sessionKey?(n.sb.isReconnectingOnError=!0,n.sb.ConnectionManager.errorAllReadyHandler(),n.reconnect(e,!0),n.sb.connecting=!1):n.connectCount<n.connectParams.retryCount?(n.connectCount++,n.client.connect(e,t,l)):(n.connectCount=0,n.flushConnectionCallbacks(new D("Websocket connection failed.",D.WEBSOCKET_CONNECTION_FAILED),null),n.sb.connecting=!1)},u.onClose=function(){W.debug("Connect: `WebSocketClient.ConnectionHandler.onClose` called."),n.connectCount=0,n.sb.connecting=!1},s.checkRouting((function(i,r){if(i)return n.sb.connecting=!1,void n.flushConnectionCallbacks(new D("Connection routing failed.",D.REQUEST_FAILED),null);l=r.wsHost,s.dummyCall((function(e){e&&W.error("API dummy call failed:",e)})),n.client.connect(e,t,l)}))}},{key:"reconnect",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=L.get(this.sb._iid),r=i.container,s=r.auth,a=r.apiClient,o=r.commandHandler,l=r.sessionManager,u=this.cls.OpenChannel;if(this.sb.reconnecting=!0,this.sb.reconnectTimer)W.debug("Reconnect: still reconnecting.");else{if(this.reconnectCount+=1,this.reconnectCount<=1?(n&&Object.keys(this.sb.connectionHandlers).forEach((function(e){t.sb.connectionHandlers[e].onReconnectStarted()})),this.reconnectDelay=0):this.reconnectDelay=Math.min(1e3*this.reconnectParams.interval*Math.pow(this.reconnectParams.multiplier,this.reconnectCount-2),this.reconnectParams.maxInterval>0?1e3*this.reconnectParams.maxInterval:Number.MAX_SAFE_INTEGER),!e||!s.sessionKey||this.reconnectParams.retryCount>0&&this.reconnectCount>this.reconnectParams.retryCount)return this.disconnect({clearSession:!1,err:new D("Websocket connection failed.",D.WEBSOCKET_CONNECTION_FAILED)},null),this.reconnectCount=0,Object.keys(this.sb.connectionHandlers).forEach((function(e){t.sb.connectionHandlers[e].onReconnectFailed()})),this.sb.connecting=!1,this.sb.reconnecting=!1,this.sb.isReconnectingOnError=!1,void this.sb.ConnectionManager.errorAllReadyHandler();this.sb.onReconnectTimerCancel=function(){t.reconnectCount=0},this.sb.reconnectTimer=setTimeout((function(){t.sb.reconnectTimer=null,t.sb.onReconnectTimerCancel=null,t.client&&t.client.disconnect(!0);var n=new re.ConnectionHandler;t.client=new re(t.sb,n),t.sb.loginHandler=function(n,i){n?n.isSessionKeyExpiredError?l.refresh((function(){})):(clearTimeout(t.sb.reconnectTimer),t.sb.reconnectTimer=null,t.reconnect(e,!1)):(t.reconnectCount=0,t.sb.connecting=!1,t.sb.reconnecting=!1,t.sb.isReconnectingOnError=!1,Object.keys(t.sb.connectionHandlers).forEach((function(e){t.sb.connectionHandlers[e].onReconnectSucceeded()})),t.sb.ConnectionManager.processAllReadyHandler(null),t.sb.isReconnectingOnError&&Object.keys(t.sb.ConnectionManager.networkHandlers).forEach((function(e){t.sb.ConnectionManager.networkHandlers[e].onReconnected()})),Object.keys(u.enteredChannels).forEach((function(e){u.enteredChannels[e].enter((function(n,i){if(n){var r=t.cls.FileMessageQueue;delete u.enteredChannels[e],r.delete(e)}}))})))},n.onOpen=function(){W.debug("Reconnect: `WebSocketClient.ConnectionHandler.onOpen` called."),t.sb.loginTimer=setTimeout((function(){W.debug("Reconnect: `loginTimer` timeout."),t.sb.loginTimer=null,t.reconnect(e,!0)}),t.sb.Options.websocketResponseTimeout),t.sb.onLoginTimerCancel=null,t.sb.reconnecting=!1},n.onMessage=function(e){o.onRawCommandReceived(e)},n.onError=function(n){W.debug("Reconnect: `WebSocketClient.ConnectionHandler.onError` called.",n),t.sb.isReconnectingOnError=!0,t.sb.ConnectionManager.errorAllReadyHandler(),t.reconnect(e,!0)},n.onClose=function(){W.debug("Reconnect: `WebSocketClient.ConnectionHandler.onClose` called."),t.sb.reconnecting=!1},a.checkRouting((function(n,i){n?t.reconnect(e,!0):(t.sb.getCurrentApiHost()!==i.apiHost&&a.get("/",null,(function(){})),t.client.connect(e,null,i.wsHost))}))}),this.reconnectDelay)}}},{key:"disconnect",value:function(e,t){var n=L.get(this.sb._iid),i=n.container.ackStateMap,r=this.cls,s=r.GroupChannel,a=r.OpenChannel,o=e.clearSession,l=e.err;this.sb.loginTimer&&(clearTimeout(this.sb.loginTimer),this.sb.onLoginTimerCancel&&(this.sb.onLoginTimerCancel(),this.sb.onLoginTimerCancel=null),this.sb.loginTimer=null),this.sb.reconnectTimer&&(clearTimeout(this.sb.reconnectTimer),this.sb.onReconnectTimerCancel&&(this.sb.onReconnectTimerCancel(),this.sb.onReconnectTimerCancel=null),this.sb.reconnectTimer=null),this.client&&(this.reconnectCount=0,this.client.disconnect(!0),this.client=null),o&&(a.clearEnteredChannels(),a.clearCache(),s.clearCache(),this.sb.globalTimer&&(clearInterval(this.sb.globalTimer),this.sb.globalTimer=null),Object.keys(i).forEach((function(e){clearTimeout(i[e].timer)})),this.sb.currentUser=null,n.set("ackStateMap",{}),n.set("subscribedUnreadMessageCount",{all:0,custom_types:{},ts:0}),n.set("auth",new H)),l&&(this.flushConnectionCallbacks(l,null),this.sb.connecting=!1,this.sb.reconnecting=!1,this.sb.isReconnectingOnError=!1),t&&t(null,null)}},{key:"flushConnectionCallbacks",value:function(e,t){var n=this.sb.connectionCallbacks;this.sb.connectionCallbacks=[],n.forEach((function(n){return n(e,t)}))}}]),e}(),ae=function(){function e(t){var n=t.type,i=t.nullable,r=void 0!==i&&i,s=t.optional,a=void 0!==s&&s,o=t.optionalIf,l=void 0===o?null:o,u=t.ignoreIf,c=void 0===u?null:u,d=t.defaultValue,h=void 0===d?null:d,f=t.constraint,g=void 0===f?null:f;p(this,e),this.type=n,this.nullable=r,this.optional=a,this.optionalIf=l,this.ignoreIf=c,this.defaultValue=h,this.constraint=g}return g(e,[{key:"isMatchingType",value:function(e){var t=function(t,n){return"string"==typeof n?h(t)===n||"array"===n&&Array.isArray(t)||"file"===n&&ee.isFile(t)||"null"===n&&null===t||"date"===n&&t instanceof Date:"function"==typeof n?t instanceof n:"object"===h(n)&&Object.keys(n).map((function(e){return n[e]})).indexOf(e)>-1};return t(e,this.type)||Array.isArray(this.type)&&this.type.some((function(n){return t(e,n)}))||this.nullable&&null===e}}],[{key:"parse",value:function(t,n){for(t=e.toArray(t);t.length>0&&void 0===t[t.length-1];)t.pop();var i=!1,r=null;"callback"===n[n.length-1].type&&("function"==typeof t[t.length-1]&&(r=t.pop()),n.pop(),i=!0);var s=[],a=null,o=0;return n.forEach((function(n){"function"==typeof n.ignoreIf&&n.ignoreIf(t)?s.push(n.hasOwnProperty("defaultValue")?n.defaultValue:null):n.isMatchingType(t[o])?(n.nullable&&null===t[o]||!n.constraint||n.constraint(t[o])||(a=e.error),s.push(t[o]),o++):n.optional||"function"==typeof n.optionalIf&&n.optionalIf(t)?s.push(n.hasOwnProperty("defaultValue")?n.defaultValue:null):(a=e.error,s.push(t[o]),o++)})),i&&r&&s.push(r),t.length!==o&&(a=e.error),[a].concat(s)}},{key:"error",get:function(){return new D("Invalid parameter.",D.INVALID_PARAMETER)}},{key:"toArray",value:function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t}}]),e}(),oe=function(){function e(t){p(this,e),this.sb=t,this.authCount=0,this.readyHandlers=[],this.networkHandlers={},this.authenticateTimer=1e4,this.authInfoRequester=null}return g(e,[{key:"addReadyHandler",value:function(e){e&&"function"==typeof e&&this.readyHandlers.push(e)}},{key:"ready",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=L.get(this.sb._iid),i=n.container,r=i.auth,s=i.isInBackground;t&&r.hasSession()?e&&(this.sb.currentUser?e(null,this.sb.currentUser):(this.addReadyHandler(e),this.errorAllReadyHandler()),this.sb.getConnectionState()!==this.sb.ConnectionState.CLOSED||s||this.sb.reconnect()):(this.addReadyHandler(e),this.sb.isReconnectingOnError?this.errorAllReadyHandler():this.sb.getConnectionState()===this.sb.ConnectionState.OPEN?this.processAllReadyHandler(null):this.sb.getConnectionState()===this.sb.ConnectionState.CONNECTING||this.errorAllReadyHandler())}},{key:"processAllReadyHandler",value:function(e){if(this.readyHandlers.length>0){var t=this.sb.currentUser,n=this.readyHandlers;this.readyHandlers=[],n.forEach((function(n){n&&"function"==typeof n&&n(e,t)}))}}},{key:"errorAllReadyHandler",value:function(){this.processAllReadyHandler(new D("Connection should be made first.",D.CONNECTION_REQUIRED))}},{key:"NetworkHandler",value:function(){this.onReconnected=function(){}}},{key:"addNetworkHandler",value:function(e,t){this.networkHandlers[e]=t}},{key:"removeNetworkHandler",value:function(e){delete this.networkHandlers[e]}},{key:"removeAllNetworkHandler",value:function(){this.networkHandlers={}}},{key:"authenticate",value:function(e){var t=this;if(this.sb.getConnectionState()===this.sb.ConnectionState.OPEN||this.sb.reconnecting)this.sb.connecting=!1,e(null,this.sb.currentUser);else if(this.authInfoRequester&&"function"==typeof this.authInfoRequester){this.sb.connecting=!0,this.authCount++;var n=setTimeout((function(){n=null,t.authCount--,0===t.authCount&&0===t.sb.connectionCallbacks.length&&(t.sb.connecting=!1),t.errorAllReadyHandler(),e(new D("Connection should be made first.",D.CONNECTION_REQUIRED),null)}),this.authenticateTimer);this.authInfoRequester((function(i){if(n){clearTimeout(n),n=null,t.authCount--;var r=function(n,i){t.sb.connecting=!1,e(n,null)};i&&i.hasOwnProperty("userId")?i.accessToken?i.apiHost&&i.wsHost?t.sb.connect(i.userId,i.accessToken,i.apiHost,i.wsHost,r):t.sb.connect(i.userId,i.accessToken,r):i.apiHost&&i.wsHost?t.sb.connect(i.userId,i.apiHost,i.wsHost,r):t.sb.connect(i.userId,r):e(ae.error,null)}}))}else e(ae.error,null)}}]),e}(),le=function e(){p(this,e),this.onSessionExpired=function(){},this.onSessionTokenRequired=function(e,t){return e(null)},this.onSessionError=function(e){},this.onSessionRefreshed=function(){},this.onSessionClosed=function(){}},ue=function(){function e(t){p(this,e),this.sb=t,this.handler=null,this.callbacks=[]}return g(e,[{key:"_refreshSessionKey",value:function(){var e=this;L.get(this._iid).container.wsAdapter.isConnected?this._refreshSessionKeyByCommand((function(t){t?t.isSessionTokenExpiredError?e._handleRefreshError(t):e._refreshSessionKeyByApi((function(t){t?e._handleRefreshError(t):e._handleRefreshSuccess()})):e._handleRefreshSuccess()})):this._refreshSessionKeyByApi((function(t){t?e._handleRefreshError(t):e._handleRefreshSuccess()}))}},{key:"_refreshSessionKeyByCommand",value:function(e){var t=this.sb,n=L.get(this._iid).container.auth,i=G.get(this._iid).Command,r=i.bSessionRefresh({token:n.sessionToken,requestId:i.generateRequestId()});t.sendCommand(r,(function(i,r){if(t.getErrorFirstCallback()){var s=[i,r];r=s[0],i=s[1]}i&&(i.hasOwnProperty("error")?r=new D("Failed to refresh the session key.",D.SESSION_TOKEN_REFRESH_FAILED):i.hasOwnProperty("new_key")&&(n.sessionKey=i.new_key)),e(r)}))}},{key:"_refreshSessionKeyByApi",value:function(e){var t=this;!function n(i){if(i<3){var r=L.get(t._iid).container,s=r.auth,a=r.apiClient,o={};s.sessionToken&&(o.accessToken=s.sessionToken),a.refreshSessionKey(o,(function(t,r){if(t)t.isSessionTokenExpiredError?e(new D("Failed to refresh the session key.",D.SESSION_TOKEN_REFRESH_FAILED)):n(i+1);else{var a=r.key;s.sessionKey=a,e(null)}}))}else e(new D("Failed to refresh the session key.",D.SESSION_TOKEN_REFRESH_FAILED))}(0)}},{key:"_handleRefreshSuccess",value:function(){var e=this.sb;e.reconnectTimer&&(clearTimeout(e.reconnectTimer),e.reconnectTimer=null),e.reconnect(),this._flushCallbacks(new D("Session key refreshed.",D.SESSION_TOKEN_REFRESHED)),this.handler&&this.handler.onSessionRefreshed()}},{key:"_handleRefreshError",value:function(e){this._flushCallbacks(e),this.handler&&this.handler.onSessionError(e)}},{key:"_handleClose",value:function(){var e=this;this.sb.disconnect((function(){e._flushCallbacks(new D("Failed to refresh the session key.",D.SESSION_TOKEN_REFRESH_FAILED)),e.handler&&e.handler.onSessionClosed()}))}},{key:"_flushCallbacks",value:function(e){this.callbacks.forEach((function(t){return t(e)})),this.callbacks=[]}},{key:"setHandler",value:function(e){e instanceof le&&(this.handler=e)}},{key:"refresh",value:function(e){var t=this,n=this.sb,i=L.get(this._iid).container.auth;this.handler?(this.callbacks.push(e),1===this.callbacks.length&&(this.handler.onSessionExpired(),i.sessionToken?this.handler.onSessionTokenRequired((function(e){e?(i.sessionToken=e,t._refreshSessionKey()):t._handleClose()}),(function(){n.reconnectTimer&&(clearTimeout(n.reconnectTimer),n.reconnectTimer=null);var e=new D("Failed to get the session token.",D.SESSION_TOKEN_REQUEST_FAILED);t._flushCallbacks(e),t.handler&&t.handler.onSessionError(e)})):this._refreshSessionKey())):e(null)}}]),e}(),ce=function(){function e(t){p(this,e),this.sb=t}return g(e,[{key:"onlineWorker",value:function(){try{if("undefined"!=typeof navigator&&navigator.onLine){var e=L.get(this.sb._iid).container.auth;this.sb.reconnecting||this.sb.connecting||!e.sessionKey||this.sb.getConnectionState()===this.sb.ConnectionState.OPEN||this.sb.reconnect()}}catch(e){W.debug("There is no `window.addEventListener.ononline` or `navigator.onLine`")}}},{key:"offlineWorker",value:function(){try{if("undefined"!=typeof navigator&&!navigator.onLine){var e=L.get(this.sb._iid).container,t=e.auth,n=e.pinger;this.sb.reconnecting||this.sb.connecting||!t.sessionKey||(n&&n.stop(),this.sb.reconnect())}}catch(e){W.debug("There is no `window.addEventListener.ononline` or `navigator.onLine`")}}},{key:"start",value:function(){try{"undefined"!=typeof window&&window.addEventListener&&"ononline"in window&&"onoffline"in window&&"undefined"!=typeof navigator&&"boolean"==typeof navigator.onLine&&(window.addEventListener("online",this.onlineWorker),window.addEventListener("offline",this.offlineWorker))}catch(e){W.debug("There is no `window.addEventListener.ononline` or `navigator.onLine`")}}},{key:"stop",value:function(){try{window.removeEventListener("online",this.onlineWorker,!1),window.removeEventListener("offline",this.offlineWorker,!1)}catch(e){W.debug("There is no `window.addEventListener.ononline` or `navigator.onLine`")}}}]),e}(),de=(new Date).getTime(),he=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;switch(p(this,e),this.command=t,this.requestId=i,arguments.length){case 1:if(!t||t.length<=4)this.command="NOOP",this.payload="{}";else if(this.decode(t),this.isRequestIdCommand){var r=this.getJsonElement();r&&(this.requestId=r.req_id||"")}break;case 2:case 3:!this.requestId&&this.isRequestIdCommand&&(this.requestId=e.generateRequestId()),n.req_id=this.requestId||"",this.payload=JSON.stringify(n)}}return g(e,[{key:"isRequestIdCommand",get:function(){return this.isAckRequired||"EROR"===this.command}},{key:"isAckRequired",get:function(){return"MESG"===this.command||"FILE"===this.command||"ENTR"===this.command||"EXIT"===this.command||"READ"===this.command||"MEDI"===this.command||"FEDI"===this.command}},{key:"encode",value:function(){return this.command+this.payload+"\n"}},{key:"decode",value:function(e){e=e.trim(),this.command=e.substring(0,4),this.payload=e.substring(4)}},{key:"getJsonElement",value:function(){return JSON.parse(this.payload)}}],[{key:"bSessionRefresh",value:function(e){return new this("LOGI",{token:e.token},e.requestId)}},{key:"bPing",value:function(){return new this("PING",{id:(new Date).getTime(),active:1})}},{key:"bMessage",value:function(e){var t=e.channelUrl,n=e.message,i=e.data,r=e.customType,s=e.metaArrays,a=e.mentionType,o=e.mentionedUserIds,l=e.translationTargetLanguages,u=e.pushNotificationDeliveryOption,c=e.appleCriticalAlertOptions,d=e.requestId,h=void 0===d?null:d,p=e.silent,f=void 0!==p&&p,g=e.rootMessageId,y=void 0===g?null:g,m=e.parentMessageId,_=void 0===m?null:m,v=e.pollId,E=e.isReplyToChannel,C=void 0!==E&&E,b=G.get(this._iid),S=b.UserMessageParams,A=b.BaseMessageParams,k={};return k.channel_url=t,k.message=n,k.data=i,s&&s.length>0&&(k.metaarray=s.map((function(e){return e.encode()}))),a&&(k.mention_type=a),k.mentioned_user_ids=[],a===A.MentionType.CHANNEL?k.mentioned_user_ids=[]:Array.isArray(o)&&o.length>0&&(k.mentioned_user_ids=o),r&&(k.custom_type=r),l&&l.length>0&&(k.target_langs=l),u&&u!==S.PushNotificationDeliveryOption.DEFAULT&&(k.push_option=u),c&&(k.apple_critical_alert_options=c.serialize()),f&&(k.silent=f),y&&(k.root_message_id=y),_&&(k.parent_message_id=_),"number"==typeof v?k.poll_id=v:null===v&&(k.poll_id=-1),C&&(k.reply_to_channel=C),new this("MESG",k,h)}},{key:"bFile",value:function(e){var t=e.channelUrl,n=e.url,i=e.name,r=e.type,s=e.size,a=e.data,o=e.customType,l=e.thumbnailSizes,u=e.requireAuth,c=e.metaArrays,d=e.mentionType,h=e.mentionedUserIds,p=e.pushNotificationDeliveryOption,f=e.appleCriticalAlertOptions,g=e.requestId,y=void 0===g?null:g,m=e.silent,_=void 0!==m&&m,v=e.rootMessageId,E=void 0===v?null:v,C=e.parentMessageId,b=void 0===C?null:C,S=e.isReplyToChannel,A=void 0!==S&&S,k=G.get(this._iid),I=k.BaseMessageParams,U=k.FileMessageParams,O={};return O.channel_url=t,O.url=n,O.name=i||"",O.type=r||"",O.size=s||0,O.custom=a,o&&(O.custom_type=o),l&&(O.thumbnails=l),u&&(O.require_auth=u),c&&c.length>0&&(O.metaarray=c.map((function(e){return e.encode()}))),d&&(O.mention_type=d),O.mentioned_user_ids=[],d===I.MentionType.CHANNEL?O.mentioned_user_ids=[]:Array.isArray(h)&&h.length>0&&(O.mentioned_user_ids=h),p&&p!==U.PushNotificationDeliveryOption.DEFAULT&&(O.push_option=p),f&&(O.apple_critical_alert_options=f.serialize()),_&&(O.silent=_),E&&(O.root_message_id=E),b&&(O.parent_message_id=b),A&&(O.reply_to_channel=A),new this("FILE",O,y)}},{key:"bUpdateUserMessage",value:function(e){var t=e.channelUrl,n=e.messageId,i=e.appleCriticalAlertOptions,r=e.message,s=void 0===r?null:r,a=e.data,o=void 0===a?null:a,l=e.customType,u=void 0===l?null:l,c=e.mentionType,d=void 0===c?null:c,h=e.mentionedUserIds,p=void 0===h?null:h,f=e.metaArrayParams,g=void 0===f?null:f,y=e.pollId,m=G.get(this._iid).BaseMessageParams,_={};return _.channel_url=t,_.msg_id=n,null!=s&&void 0!==s&&(_.message=s),null!=o&&void 0!==o&&(_.data=o),null!=u&&void 0!==u&&(_.custom_type=u),d&&(_.mention_type=d),d===m.MentionType.CHANNEL?_.mentioned_user_ids=[]:Array.isArray(p)&&p.length>0&&(_.mentioned_user_ids=p),g&&(_.metaarray=g),i&&(_.apple_critical_alert_options=i.serialize()),"number"==typeof y?_.poll_id=y:null===y&&(_.poll_id=-1),new this("MEDI",_)}},{key:"bUpdateFileMessage",value:function(e){var t=e.channelUrl,n=e.messageId,i=e.appleCriticalAlertOptions,r=e.data,s=void 0===r?null:r,a=e.customType,o=void 0===a?null:a,l=e.mentionType,u=void 0===l?null:l,c=e.mentionedUserIds,d=void 0===c?null:c,h=e.metaArrayParams,p=void 0===h?null:h,f=G.get(this._iid).BaseMessageParams,g={};return g.channel_url=t,g.msg_id=n,null!=s&&void 0!==s&&(g.data=s),null!=o&&void 0!==o&&(g.custom_type=o),u&&(g.mention_type=u),u===f.MentionType.CHANNEL?g.mentioned_user_ids=[]:Array.isArray(d)&&d.length>0&&(g.mentioned_user_ids=d),p&&(g.metaarray=p),i&&(g.apple_critical_alert_options=i.serialize()),new this("FEDI",g)}},{key:"bRead",value:function(e){var t=e.channelUrl,n={};return n.channel_url=t,new this("READ",n)}},{key:"bMessageAck",value:function(e){var t=e.channelUrl,n=e.messageId,i={};return i.channel_url=t,i.msg_id=n,new this("MACK",i)}},{key:"bTypeStart",value:function(e){var t=e.channelUrl,n=e.time,i={};return i.channel_url=t,i.time=n,new this("TPST",i)}},{key:"bTypeEnd",value:function(e){var t=e.channelUrl,n=e.time,i={};return i.channel_url=t,i.time=n,new this("TPEN",i)}},{key:"bEnter",value:function(e){var t=e.channelUrl,n={};return n.channel_url=t,new this("ENTR",n)}},{key:"bExit",value:function(e){var t=e.channelUrl,n={};return n.channel_url=t,new this("EXIT",n)}},{key:"generateRequestId",value:function(){return de++,String(de)}}]),e}(),pe=new WeakMap,fe=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};p(this,e);var n=[];if(t.hasOwnProperty("premium_feature_list")&&Array.isArray(t.premium_feature_list))try{var i=t.premium_feature_list;n.push.apply(n,O(i))}catch(e){}var r=[];if(t.hasOwnProperty("application_attributes")&&Array.isArray(t.application_attributes))try{var s=t.application_attributes;r.push.apply(r,O(s))}catch(e){}var a=!1;t.hasOwnProperty("disable_supergroup_mack")&&"boolean"==typeof t.disable_supergroup_mack&&(a=t.disable_supergroup_mack),pe.set(this,{emojiHash:t.hasOwnProperty("emoji_hash")?t.emoji_hash:"",uploadSizeLimit:t.hasOwnProperty("file_upload_size_limit")?1048576*t.file_upload_size_limit:Number.MAX_VALUE,useReaction:t.hasOwnProperty("use_reaction")&&t.use_reaction,disableSupergroupMack:a,applicationAttributes:r,premiumFeatureList:n})}return g(e,[{key:"emojiHash",get:function(){return pe.get(this).emojiHash}},{key:"uploadSizeLimit",get:function(){return pe.get(this).uploadSizeLimit}},{key:"premiumFeatureList",get:function(){return pe.get(this).premiumFeatureList}},{key:"applicationAttributes",get:function(){return pe.get(this).applicationAttributes}},{key:"isUsingReaction",get:function(){return pe.get(this).useReaction}},{key:"isSupergroupMackDisabled",get:function(){return pe.get(this).disableSupergroupMack}}]),e}(),ge=function(){function e(){p(this,e),this.messageId=null,this.userId=null,this.key=null,this.operation="",this.updatedAt=null}return g(e,null,[{key:"createFromJson",value:function(e){var t=parseInt(e.msg_id),n=e.user_id,i=e.operation,r=e.reaction,s=e.updated_at;if(t&&"string"==typeof n&&"string"==typeof i&&["add","delete"].indexOf(i.toLowerCase())>=0&&"string"==typeof r&&r&&"number"==typeof s){var a=new this;return a.messageId=t,a.userId=n,a.key=r,a.operation=i.toLowerCase(),a.updatedAt=s,a}return null}}]),e}();function ye(e){return Object.keys(e).forEach((function(t){e[t]&&"object"===h(e[t])&&ye(e[t])})),Object.freeze(e)}var me=function(){function e(){p(this,e)}return g(e,null,[{key:"serialize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=JSON.parse(JSON.stringify(e));return t&&t(n),ye(n)}},{key:"deserialize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=JSON.parse(JSON.stringify(e));return t&&t(n),n}}]),e}(),_e=function(e,t,n){return new Promise((function(i,r){t((function(t,s){n&&"function"==typeof n&&(L.get(e).container.isErrorFirstInCallback?n(t,s):n(s,t)),t?r(t):i(s)}))}))},ve={TIMESTAMP:"timestamp",MESSAGE_ID:"messageId"},Ee=new WeakMap,Ce=function(){function e(t){p(this,e),this.messageId=0,this.messageType=e.MESSAGE_TYPE_BASE,this.channelUrl="",this.data=null,this.customType=null,this.silent=!1,this.createdAt=0,this.updatedAt=0,this.channelType=null,this.metaArrays=[],this.reactions=[],this.mentionType=null,this.mentionedUsers=[],this.sendingStatus=null,Ee.set(this,0),this.parentMessageId=0,this.parentMessageText=null,this.threadInfo=null,this.isReplyToChannel=!1,this.parentMessage=null,this.ogMetaData=null,this.isOperatorMessage=!1,this.appleCriticalAlertOptions=null,t&&this.__update(t)}return g(e,[{key:"serialize",value:function(){return me.serialize(this,(function(e){e.hasOwnProperty("_sender")&&(e.sender=e._sender,delete e._sender)}))}},{key:"isIdentical",value:function(e){return!("object"!==h(e)||!e.hasOwnProperty("messageId"))&&(0!==this.messageId&&0!==e.messageId?this.messageId===e.messageId:this.reqId===e.reqId)}},{key:"isEqual",value:function(e){return ee.deepEqual(this,e)}},{key:"isOpenChannel",value:function(){var e=G.get(this._iid).BaseChannel;return this.channelType===e.CHANNEL_TYPE_OPEN}},{key:"isGroupChannel",value:function(){var e=G.get(this._iid).BaseChannel;return this.channelType===e.CHANNEL_TYPE_GROUP}},{key:"isUserMessage",value:function(){return this.messageType===e.MESSAGE_TYPE_USER}},{key:"isAdminMessage",value:function(){return this.messageType===e.MESSAGE_TYPE_ADMIN}},{key:"isFileMessage",value:function(){return this.messageType===e.MESSAGE_TYPE_FILE}},{key:"__update",value:function(e){var t=this,n=fn.getInstance(this._iid),i=G.get(this._iid),r=i.User,s=i.BaseChannel,a=i.BaseMessageParams,o=i.BaseMessage,l=i.Reaction,u=i.MessageMetaArray,c=i.ThreadInfo,h=i.OGMetaData,p=i.AppleCriticalAlertOptions;e.hasOwnProperty("msg_id")&&(this.messageId=parseInt(e.msg_id)),e.hasOwnProperty("message_id")&&(this.messageId=parseInt(e.message_id)),this.channelUrl=e.hasOwnProperty("channel_url")?String(e.channel_url):"",this.data=e.hasOwnProperty("data")?String(e.data):"",this.customType=e.hasOwnProperty("custom_type")?String(e.custom_type):"",this.silent=!!e.hasOwnProperty("silent")&&e.silent,this.createdAt=e.hasOwnProperty("ts")?parseInt(e.ts):0,e.hasOwnProperty("created_at")&&(this.createdAt=parseInt(e.created_at)),this.updatedAt=e.hasOwnProperty("updated_at")?parseInt(e.updated_at):0,this.channelType=e.hasOwnProperty("channel_type")?String(e.channel_type):s.CHANNEL_TYPE_GROUP;var f=e.hasOwnProperty("metaarray")?e.metaarray:{},g=e.hasOwnProperty("metaarray_key_order")?e.metaarray_key_order:Object.keys(f).sort((function(e,t){return e.localeCompare(t)}));this.metaArrays=[];for(var y=0;y<g.length;y++){var m=g[y];this.metaArrays.push(new u(m,f[m]||[]))}if(e.hasOwnProperty("sorted_metaarray")){var _=e.sorted_metaarray;Array.isArray(_)&&(this.metaArrays=_.map((function(e){return new u(e.key,e.value)})))}if(this.reactions=[],e.hasOwnProperty("reactions")&&Array.isArray(e.reactions))for(var v=0;v<e.reactions.length;v++){var E=l.createFromJson(e.reactions[v]);E&&this.reactions.push(E)}if(this.mentionType=e.hasOwnProperty("mention_type")?e.mention_type:a.MentionType.USERS,this.mentionedUsers=[],e.hasOwnProperty("mentioned_users")&&e.mentioned_users.forEach((function(e){var n=new r(e);t.mentionedUsers.push(n)})),this.sendingStatus=this.messageId>0?n.MessageSendingStatus.SUCCEEDED:n.MessageSendingStatus.FAILED,e.hasOwnProperty("sending_status")&&(this.sendingStatus=e.sending_status),e.hasOwnProperty("root_message_id")&&Ee.set(this,parseInt(e.root_message_id)),e.hasOwnProperty("parent_message_id")&&(this.parentMessageId=parseInt(e.parent_message_id)),this.threadInfo=new c(e.thread_info),this.isReplyToChannel=!!e.hasOwnProperty("is_reply_to_channel")&&e.is_reply_to_channel,e.hasOwnProperty("parent_message_info")){var C=d({},e.parent_message_info);e.parent_message_info.hasOwnProperty("file")&&(C.require_auth=!!e.parent_message_info.file.require_auth);var b={channelType:this.channelType,channelUrl:this.channelUrl};switch(this.parentMessage=s.buildMessage(C,b),this.parentMessage.messageType){case o.MESSAGE_TYPE_USER:this.parentMessageText=this.parentMessage.message;break;case o.MESSAGE_TYPE_FILE:this.parentMessageText=this.parentMessage.name}}e.hasOwnProperty("og_tag")&&(this.ogMetaData=new h(e.og_tag)),this.isOperatorMessage=!!e.hasOwnProperty("is_op_msg")&&e.is_op_msg,e.hasOwnProperty("apple_critical_alert_options")&&(this.appleCriticalAlertOptions=new p(e.apple_critical_alert_options))}},{key:"getMetaArraysByKeys",value:function(e){return Array.isArray(e)?this.metaArrays.filter((function(t){return e.indexOf(t.key)>-1})):[]}},{key:"metaArray",get:function(){var e={};return this.metaArrays.forEach((function(t){e[t.key]=t.value})),e},set:function(e){if("object"===h(e)&&e){var t=G.get(this._iid).MessageMetaArray,n=[];Object.keys(e).forEach((function(i){n.push(new t(i,e[i]))})),this.metaArrays=n}}},{key:"getMetaArrayByKeys",value:function(e){var t={};return this.getMetaArraysByKeys(e).forEach((function(e){t[e.key]=e.value})),t}},{key:"applyReactionEvent",value:function(e){var t=this,n=G.get(this._iid),i=n.Reaction,r=null,s=ae.parse(arguments,[new ae({type:ge,constraint:function(e){return parseInt(e.messageId)===parseInt(t.messageId)}})]),a=U(s,2);if(r=a[0],e=a[1],!r){for(var o=!1,l=0;l<this.reactions.length;l++)if(this.reactions[l].key===e.key){this.reactions[l]._applyEvent(e),this.reactions[l].isEmpty&&this.reactions.splice(l,1),o=!0;break}o||"add"!==e.operation||this.reactions.push(new i(e.key,[e.userId],e.updatedAt))}}},{key:"_getThreadedMessageList",value:function(t,n,i,r){var s=this,a=G.get(this._iid),o=a.ThreadedMessageListParams,l=null,u=ae.parse(arguments,[new ae({type:"number"}),new ae({type:"string",constraint:function(e){return Object.values(ve).includes(e)}}),new ae({type:o,constraint:function(e){return e._validate()}}),new ae({type:"callback"})]),c=U(u,5);return l=c[0],t=c[1],n=c[2],i=c[3],r=c[4],_e(this._iid,(function(r){if(l)r(l,null);else{var a=G.get(s._iid),o=a.GroupChannel,u=a.OpenChannel;s.isGroupChannel()?o.getChannel(s.channelUrl,w.INTERNAL_CALL,(function(a,o){if(fn.getInstance(s._iid).getErrorFirstCallback()){var l=[a,o];o=l[0],a=l[1]}o?r(o,null):L.get(s._iid).container.apiClient.getMessageList(d(d({channel:a,token:t,tokenType:n},i),{},{shouldReverse:i.reverse,parentMessageId:s.messageId,includeThreadInfo:!0,replyType:e.ReplyType.ALL}),(function(e,t){if(e)r(e,null);else{var n=G.get(s._iid).BaseChannel,i=t.messages.map((function(e){return n.buildMessage(e,a)})).filter((function(e){return null!==e})),o=i.filter((function(e){return e.messageId===s.messageId}))[0],l=i.filter((function(e){return e.parentMessageId===s.messageId}));r(null,{parentMessage:o,threadedReplies:l})}}))})):s.isOpenChannel()&&u.getChannel(s.channelUrl,w.INTERNAL_CALL,(function(a,o){if(fn.getInstance(s._iid).getErrorFirstCallback()){var l=[a,o];o=l[0],a=l[1]}o?r(o,null):L.get(s._iid).container.apiClient.getMessageList(d(d({channel:a,token:t,tokenType:n},i),{},{shouldReverse:i.reverse,parentMessageId:s.messageId,includeThreadInfo:!0,replyType:e.ReplyType.ALL}),(function(e,t){if(e)r(e,null);else{var n=G.get(s._iid).BaseChannel,i=t.messages.map((function(e){return n.buildMessage(e,a)})).filter((function(e){return null!==e})),o=i.filter((function(e){return e.messageId===s.messageId}))[0],l=i.filter((function(e){return e.parentMessageId===s.messageId}));r(null,{parentMessage:o,threadedReplies:l})}}))}))}}),r)}},{key:"getThreadedMessagesByTimestamp",value:function(e,t,n){return this._getThreadedMessageList(e,ve.TIMESTAMP,t,n)}},{key:"applyThreadInfoUpdateEvent",value:function(e){var t=this,n=G.get(this._iid),i=n.ThreadInfoUpdateEvent,r=null,s=ae.parse(arguments,[new ae({type:i,constraint:function(e){return parseInt(e.targetMessageId)===parseInt(t.messageId)}})]),a=U(s,2);return r=a[0],e=a[1],!r&&(this.threadInfo=e.threadInfo,!0)}}],[{key:"MESSAGE_TYPE_BASE",get:function(){return"base"}},{key:"MESSAGE_TYPE_ADMIN",get:function(){return"admin"}},{key:"MESSAGE_TYPE_USER",get:function(){return"user"}},{key:"MESSAGE_TYPE_FILE",get:function(){return"file"}},{key:"SendingStatus",get:function(){return{NONE:"none",PENDING:"pending",FAILED:"failed",CANCELED:"canceled",SUCCEEDED:"succeeded"}}},{key:"ReplyType",get:function(){return{ALL:"all",NONE:"none",ONLY_REPLY_TO_CHANNEL:"only_reply_to_channel"}}},{key:"getMessage",value:function(e,t){var n=this,i=G.get(this._iid),r=i.BaseChannel,s=i.MessageRetrievalParams,a=null,o=ae.parse(arguments,[new ae({type:s,constraint:function(e){return e._validate()}}),new ae({type:"callback"})]),l=U(o,3);return a=l[0],e=l[1],t=l[2],_e(this._iid,(function(t){if(a)t(a,null);else{var i=G.get(n._iid),s=i.GroupChannel,o=i.OpenChannel;switch(e.channelType){case r.CHANNEL_TYPE_GROUP:s.getChannel(e.channelUrl,w.INTERNAL_CALL,(function(i,s){if(fn.getInstance(n._iid).getErrorFirstCallback()){var a=[i,s];s=a[0],i=a[1]}s?t(s,null):L.get(n._iid).container.apiClient.getMessage(d({channel:i},e),(function(e,n){if(e)t(e,null);else{var s=r.buildMessage(n,i);t(null,s)}}))}));break;case r.CHANNEL_TYPE_OPEN:o.getChannel(e.channelUrl,w.INTERNAL_CALL,(function(i,s){if(fn.getInstance(n._iid).getErrorFirstCallback()){var a=[i,s];s=a[0],i=a[1]}s?t(s,null):L.get(n._iid).container.apiClient.getMessage(d({channel:i},e),(function(e,n){if(e)t(e,null);else{var s=r.buildMessage(n,i);t(null,s)}}))}))}}}),t)}}]),e}(),be=function(){function e(t){p(this,e),this.nickname="",this.plainProfileUrl="",this.userId="",this.connectionStatus="",this.lastSeenAt=null,this.metaData={},this.isActive=!0,this.friendDiscoveryKey=null,this.friendName=null,this._preferredLanguages=null,this.requireAuth=null,t&&this.__update(t)}return g(e,[{key:"preferredLanguages",get:function(){return this._preferredLanguages}},{key:"__update",value:function(t){var n=L.get(this._iid).container.auth;t.hasOwnProperty("guest_id")&&(this.userId=String(t.guest_id)),t.hasOwnProperty("user_id")&&(this.userId=String(t.user_id)),t.hasOwnProperty("name")&&(this.nickname=String(t.name)),t.hasOwnProperty("nickname")&&(this.nickname=String(t.nickname)),t.hasOwnProperty("require_auth_for_profile_image")?this.requireAuth=t.require_auth_for_profile_image:this.requireAuth=null,(t.hasOwnProperty("image")||t.hasOwnProperty("profile_url"))&&(this.plainProfileUrl=String(t.image||t.profile_url||""),Object.defineProperty(this,"profileUrl",{value:this.requireAuth?"".concat(this.plainProfileUrl,"?auth=").concat(n.eKey):this.plainProfileUrl,configurable:!0,writable:!1})),t.hasOwnProperty("is_online")?t.is_online===e.NON_AVAILABLE?this.connectionStatus=e.NON_AVAILABLE:this.connectionStatus=t.is_online?e.ONLINE:e.OFFLINE:this.connectionStatus=e.NON_AVAILABLE,t.hasOwnProperty("last_seen_at")?this.lastSeenAt=parseInt(t.last_seen_at):this.lastSeenAt=0,t.hasOwnProperty("metadata")?this.metaData=t.metadata:this.metaData={},t.hasOwnProperty("is_active")?this.isActive=void 0===t.is_active||t.is_active:this.isActive=!0,t.hasOwnProperty("friend_discovery_key")?this.friendDiscoveryKey=t.friend_discovery_key:this.friendDiscoveryKey=null,t.hasOwnProperty("friend_name")?this.friendName=t.friend_name:this.friendName=null,t.hasOwnProperty("preferred_languages")?this._preferredLanguages=t.preferred_languages||null:this._preferredLanguages=null}},{key:"_updateMetaData",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=G.get(this._iid),r=i.GroupChannel;Object.keys(e).forEach((function(i){n?delete t.metaData[i]:t.metaData[i]=e[i]})),Object.keys(r.cachedChannels).forEach((function(e){if(r.cachedChannels.hasOwnProperty(e)){var n=r.cachedChannels[e];n.memberMap.hasOwnProperty(t.userId)&&(n.memberMap[t.userId].metaData=t.metaData)}}))}},{key:"serialize",value:function(){return me.serialize(this,(function(e){e.hasOwnProperty("_preferredLanguages")&&(e.preferredLanguages=e._preferredLanguages,delete e._preferredLanguages)}))}},{key:"getOriginalProfileUrl",value:function(){var e="";if(((e=(e=this.plainProfileUrl.indexOf("://")>-1?this.plainProfileUrl.split("/")[2]:this.plainProfileUrl.split("/")[0]).split("?")[0]).indexOf("sendbird.com")>-1||e.indexOf("sendbirdtest.com")>-1||e.indexOf("intoz.com")>-1||e.indexOf("file-local")>-1)&&this.plainProfileUrl.indexOf(e+"/profile_images/")>-1){var t=this.plainProfileUrl.replace("profile_images/","");return t===this.plainProfileUrl?"":t}return""}},{key:"createMetaData",value:function(e,t){var n=this,i=null,r=ae.parse(arguments,[new ae({type:"object",constraint:function(e){return Object.keys(e).length>0&&!Array.isArray(e)}}),new ae({type:"callback"})]),s=U(r,3);return i=s[0],e=s[1],t=s[2],_e(this._iid,(function(t){i?t(i,null):L.get(n._iid).container.apiClient.createUserMetaData({metaData:e},(function(e,i){e||n._updateMetaData(i),t(e,i)}))}),t)}},{key:"updateMetaData",value:function(e,t,n){var i=this,r=null,s=ae.parse(arguments,[new ae({type:"object",constraint:function(e){return!Array.isArray(e)&&Object.keys(e).length>0&&Object.keys(e).map((function(t){return e[t]})).every((function(e){return"string"==typeof e}))}}),new ae({type:"boolean",optional:!0,defaultValue:!1}),new ae({type:"callback"})]),a=U(s,4);return r=a[0],e=a[1],t=a[2],n=a[3],_e(this._iid,(function(n){r?n(r,null):L.get(i._iid).container.apiClient.updateUserMetaData({metaData:e,upsert:t},(function(e,t){e||i._updateMetaData(t),n(e,t)}))}),n)}},{key:"deleteMetaData",value:function(e,t){var n=this,i=null,r=ae.parse(arguments,[new ae({type:"string",constraint:function(e){return e.length>0}}),new ae({type:"callback"})]),s=U(r,3);return i=s[0],e=s[1],t=s[2],_e(this._iid,(function(t){if(i)t(i,null);else{var r={};r[e]="",L.get(n._iid).container.apiClient.deleteUserMetaData({metaDataKey:e},(function(e,i){e||n._updateMetaData(r,!0),t(e,i)}))}}),t)}},{key:"deleteAllMetaData",value:function(e){var t=this;return _e(this._iid,(function(e){var n=t.metaData;L.get(t._iid).container.apiClient.deleteAllUserMetaData({},(function(i,r){i||t._updateMetaData(n,!0),e(i,r)}))}),e)}}],[{key:"objectify",value:function(e){var t=e.userId,n=void 0===t?null:t,i=e.nickname,r=void 0===i?"":i,s=e.plainProfileUrl,a=void 0===s?"":s,o=e.connectionStatus,l=void 0===o?"":o,u=e.lastSeenAt,c=void 0===u?0:u,d=e.metaData,h=void 0===d?{}:d,p=e.isActive,f=void 0===p||p,g=e.friendDiscoveryKey,y=void 0===g?null:g,m=e.friendName,_=void 0===m?null:m,v=e.preferredLanguages,E=void 0===v?null:v,C=e.requireAuth;return{user_id:n,nickname:r,profile_url:a,is_online:l,last_seen_at:c,metadata:h,is_active:f,friend_discovery_key:y,friend_name:_,preferred_languages:E,require_auth_for_profile_image:void 0!==C&&C}}},{key:"build",value:function(e,t,n,i,r,s,a,o,l,u,c){return this.objectify({userId:e,nickname:t,plainProfileUrl:n,connectionStatus:i,lastSeenAt:r,metaData:s,isActive:a,friendDiscoveryKey:o,friendName:l,preferredLanguages:u,requireAuth:c})}},{key:"buildFromSerializedData",value:function(e){var t=G.get(this._iid).User,n=me.deserialize(e);return new t(t.objectify(n))}},{key:"NON_AVAILABLE",get:function(){return"nonavailable"}},{key:"ONLINE",get:function(){return"online"}},{key:"OFFLINE",get:function(){return"offline"}}]),e}(),Se={TIMESTAMP:"timestamp",MESSAGE_ID:"messageId"},Ae=new WeakMap,ke=function(){function e(t){p(this,e),this.url="",this.channelType=e.CHANNEL_TYPE_BASE,this.name="",this.coverUrl="",this.creator=null,this.createdAt=0,this.data=null,this.customType=null,this.isFrozen=!1,this.isEphemeral=!1,Ae.set(this,{}),t&&this.__update(t)}return g(e,[{key:"__update",value:function(e){this.url=e.hasOwnProperty("channel_url")?String(e.channel_url):"",this.name=e.hasOwnProperty("name")?String(e.name):"",this.coverUrl=e.hasOwnProperty("cover_url")?String(e.cover_url):"",this.createdAt=e.hasOwnProperty("created_at")?1e3*e.created_at:0,this.data=e.hasOwnProperty("data")?String(e.data):"",this.customType=e.hasOwnProperty("custom_type")?e.custom_type:"",this.isFrozen=!!e.hasOwnProperty("freeze")&&e.freeze,this.isEphemeral=!!e.hasOwnProperty("is_ephemeral")&&e.is_ephemeral,e.hasOwnProperty("created_by")&&null!==e.created_by&&"object"===h(e.created_by)&&Object.keys(e.created_by).length>0?this.creator=new be(e.created_by):this.creator=null,e.hasOwnProperty("metadata")&&null!==e.metadata&&e.hasOwnProperty("ts")&&"number"==typeof e.ts&&this._refreshMetaData(e.metadata,e.ts)}},{key:"_addOrUpdateCachedMetaData",value:function(e,t){var n=Ae.get(this);Object.keys(e).forEach((function(i){var r=n[i],s=e[i];r?t>r.updatedAt&&(r.value=s,r.updatedAt=t,r.isRemoved=!1):n[i]={value:s,updatedAt:t,isRemoved:!1}}))}},{key:"_markAsDeletedCachedMetaData",value:function(e,t){var n=Ae.get(this);e.forEach((function(e){var i=n[e];i?t>i.updatedAt&&(i.isRemoved=!0,i.updatedAt=t):n[e]={value:null,updatedAt:t,isRemoved:!0}}))}},{key:"_refreshMetaData",value:function(e,t){var n={};Object.keys(e).forEach((function(i){n[i]={value:e[i],updatedAt:t,isRemoved:!1}})),Ae.set(this,n)}},{key:"isGroupChannel",value:function(){var e=G.get(this._iid).BaseChannel;return this.channelType===e.CHANNEL_TYPE_GROUP}},{key:"isOpenChannel",value:function(){var e=G.get(this._iid).BaseChannel;return this.channelType===e.CHANNEL_TYPE_OPEN}},{key:"createOperatorListQuery",value:function(){return new(0,G.get(this._iid).OperatorListQuery)(this)}},{key:"createMessageListQuery",value:function(){return new(0,G.get(this._iid).MessageListQuery)(this)}},{key:"createPreviousMessageListQuery",value:function(){return new(0,G.get(this._iid).PreviousMessageListQuery)(this)}},{key:"createPollListQuery",value:function(){return new(0,G.get(this._iid).PollListQuery)({channelUrl:this.url})}},{key:"createPollVoterListQuery",value:function(e,t){return new(0,G.get(this._iid).PollVoterListQuery)({channelUrl:this.url,pollId:e,optionId:t})}},{key:"serialize",value:function(){return me.serialize(this,(function(e){if(null!==e.lastMessage&&"object"===h(e.lastMessage)){var t=e.lastMessage;t.hasOwnProperty("_sender")&&(t.sender=t._sender,delete t._sender,e.lastMessage=t)}e.hasOwnProperty("_messageOffsetTimestamp")&&(e.messageOffsetTimestamp=e._messageOffsetTimestamp,delete e._messageOffsetTimestamp)}))}},{key:"getMessageChangeLogsByTimestamp",value:function(e,t,n,i){var r=this,s=null,a=ae.parse(arguments,[new ae({type:"number",constraint:function(e){return e>=0}}),new ae({type:"boolean",optional:!0,defaultValue:!1}),new ae({type:"boolean",optional:!0,defaultValue:!1}),new ae({type:"callback"})]),o=U(a,5);return s=o[0],e=o[1],t=o[2],n=o[3],i=o[4],_e(this._iid,(function(i){s?i(s,null):L.get(r._iid).container.apiClient.getMessageChangeLogs({channelUrl:r.url,ts:e,token:null,isOpenChannel:r.isOpenChannel(),includeMetaArray:t,includeReactions:n},(function(e,t){var n=null;if(!e){var s=G.get(r._iid).BaseChannel;n={updatedMessages:t.updated.map((function(e){return s.buildMessage(e,r)})),deletedMessageIds:t.deleted.map((function(e){return parseInt(e.message_id)})),hasMore:t.has_more,token:t.next}}i(e,n)}))}),i)}},{key:"getMessageChangeLogsByToken",value:function(e,t,n,i){var r=this,s=null,a=ae.parse(arguments,[new ae({type:"string",nullable:!0}),new ae({type:"boolean",optional:!0,defaultValue:!1}),new ae({type:"boolean",optional:!0,defaultValue:!1}),new ae({type:"callback"})]),o=U(a,5);return s=o[0],e=o[1],t=o[2],n=o[3],i=o[4],_e(this._iid,(function(i){s?i(s,null):L.get(r._iid).container.apiClient.getMessageChangeLogs({channelUrl:r.url,ts:null,token:e,isOpenChannel:r.isOpenChannel(),includeMetaArray:t,includeReactions:n},(function(e,t){var n=null;if(!e){var s=G.get(r._iid).BaseChannel;n={updatedMessages:t.updated.map((function(e){return s.buildMessage(e,r)})),deletedMessageIds:t.deleted.map((function(e){return parseInt(e.message_id)})),hasMore:t.has_more,token:t.next}}i(e,n)}))}),i)}},{key:"getMessageChangeLogsSinceToken",value:function(e,t,n){var i=this,r=G.get(this._iid),s=r.BaseChannel,a=r.MessageChangeLogsParams,o=null,l=ae.parse(arguments,[new ae({type:"string",nullable:!0}),new ae({type:a,constraint:function(e){return e._validate()}}),new ae({type:"callback"})]),u=U(l,4);return o=u[0],e=u[1],t=u[2],n=u[3],_e(this._iid,(function(n){o?n(o,null):L.get(i._iid).container.apiClient.getMessageChangeLogs(d({channelUrl:i.url,ts:null,token:e,isOpenChannel:i.isOpenChannel()},t),(function(e,t){var r=null;e||(r={updatedMessages:t.updated.map((function(e){return s.buildMessage(e,i)})),deletedMessageIds:t.deleted.map((function(e){return parseInt(e.message_id)})),hasMore:t.has_more,token:t.next}),n(e,r)}))}),n)}},{key:"getMessageChangeLogsSinceTimestamp",value:function(e,t,n){var i=this,r=G.get(this._iid),s=r.BaseChannel,a=r.MessageChangeLogsParams,o=null,l=ae.parse(arguments,[new ae({type:"number",constraint:function(e){return e>=0}}),new ae({type:a,constraint:function(e){return e._validate()}}),new ae({type:"callback"})]),u=U(l,4);return o=u[0],e=u[1],t=u[2],n=u[3],_e(this._iid,(function(n){o?n(o,null):L.get(i._iid).container.apiClient.getMessageChangeLogs(d({channelUrl:i.url,timestamp:e,token:null,isOpenChannel:i.isOpenChannel()},t),(function(e,t){var r=null;e||(r={updatedMessages:t.updated.map((function(e){return s.buildMessage(e,i)})),deletedMessageIds:t.deleted.map((function(e){return parseInt(e.message_id)})),hasMore:t.has_more,token:t.next}),n(e,r)}))}),n)}},{key:"getMyMutedInfo",value:function(e){var t=this;return _e(this._iid,(function(e){var n=fn.getInstance(t._iid);L.get(t._iid).container.apiClient.getMyMutedInfo({channelUrl:t.url,userId:n.currentUser?n.currentUser.userId:null,isGroupChannel:t.isGroupChannel()},(function(t,n){var i=null;t||(i={isMuted:n.is_muted,startAt:n.start_at,endAt:n.end_at,remainingDuration:n.remaining_duration,description:n.description}),e(t,i)}))}),e)}},{key:"_parseMessageListParams",value:function(e){for(var t=G.get(this._iid),n=t.MessageListParams,i=new n,r=null,s=!1,a=0,o=0,l=!1,u="",c="",d=null,h=!1,p=!1,f=null,g=arguments.length,y=new Array(g>1?g-1:0),m=1;m<g;m++)y[m-1]=arguments[m];switch(e){case"prev":var _=ae.parse(y,[new ae({type:"number"}),new ae({type:"boolean"}),new ae({type:"number"}),new ae({type:"boolean"}),new ae({type:"string"}),new ae({type:"string"}),new ae({type:"array",optional:!0}),new ae({type:"boolean",optional:!0,defaultValue:!1}),new ae({type:"boolean",optional:!0,defaultValue:!1}),new ae({type:"callback"})]),v=U(_,11);r=v[0],s=v[2],a=v[3],l=v[4],u=v[5],c=v[6],d=v[7],h=v[8],p=v[9],f=v[10];break;case"next":var E=ae.parse(y,[new ae({type:"number"}),new ae({type:"boolean"}),new ae({type:"number"}),new ae({type:"boolean"}),new ae({type:"string"}),new ae({type:"string"}),new ae({type:"array",optional:!0}),new ae({type:"boolean",optional:!0,defaultValue:!1}),new ae({type:"boolean",optional:!0,defaultValue:!1}),new ae({type:"callback"})]),C=U(E,11);r=C[0],s=C[2],o=C[3],l=C[4],u=C[5],c=C[6],d=C[7],h=C[8],p=C[9],f=C[10];break;case"prevnext":var b=ae.parse(y,[new ae({type:"number"}),new ae({type:"number"}),new ae({type:"number"}),new ae({type:"boolean"}),new ae({type:"string"}),new ae({type:"string"}),new ae({type:"array",optional:!0}),new ae({type:"boolean",optional:!0,defaultValue:!1}),new ae({type:"boolean",optional:!0,defaultValue:!1}),new ae({type:"callback"})]),S=U(b,11);r=S[0],a=S[2],o=S[3],l=S[4],u=S[5],c=S[6],d=S[7],h=S[8],p=S[9],f=S[10],s=!0}return r?[null,f]:(i.isInclusive=s,i.prevResultSize=a,i.nextResultSize=o,i.reverse=l,i.messageType=u,i.customType=c,""===i.customType&&(i.customType="*"),i.senderUserIds=d,i.includeMetaArray=h,i.includeReactions=p,[i,f])}},{key:"_getMessageList",value:function(e,t,n,i){var r=this,s=G.get(this._iid),a=s.MessageListParams,o=null,l=ae.parse(arguments,[new ae({type:"number"}),new ae({type:"string",constraint:function(e){return Object.values(Se).includes(e)}}),new ae({type:a,constraint:function(e){return e._validate()}}),new ae({type:"callback"})]),u=U(l,5);return o=u[0],e=u[1],t=u[2],n=u[3],i=u[4],_e(this._iid,(function(i){o?i(o,null):L.get(r._iid).container.apiClient.getMessageList(d(d({channel:r,token:e,tokenType:t},n),{},{shouldReverse:n.reverse}),(function(e,t){if(e)i(e,null);else{var n=G.get(r._iid).BaseChannel,s=t.messages.map((function(e){return n.buildMessage(e,r)})).filter((function(e){return null!==e}));i(null,s)}}))}),i)}},{key:"getPreviousMessagesByTimestamp",value:function(e){var t=this._parseMessageListParams.apply(this,["prev"].concat(O(ae.toArray(arguments)))),n=U(t,2),i=n[0],r=n[1];return this._getMessageList(e,Se.TIMESTAMP,i,r)}},{key:"getNextMessagesByTimestamp",value:function(e){var t=this._parseMessageListParams.apply(this,["next"].concat(O(ae.toArray(arguments)))),n=U(t,2),i=n[0],r=n[1];return this._getMessageList(e,Se.TIMESTAMP,i,r)}},{key:"getPreviousAndNextMessagesByTimestamp",value:function(e){var t=this._parseMessageListParams.apply(this,["prevnext"].concat(O(ae.toArray(arguments)))),n=U(t,2),i=n[0],r=n[1];return this._getMessageList(e,Se.TIMESTAMP,i,r)}},{key:"getPreviousMessagesByID",value:function(e){var t=this._parseMessageListParams.apply(this,["prev"].concat(O(ae.toArray(arguments)))),n=U(t,2),i=n[0],r=n[1];return this._getMessageList(e,Se.MESSAGE_ID,i,r)}},{key:"getNextMessagesByID",value:function(e){var t=this._parseMessageListParams.apply(this,["next"].concat(O(ae.toArray(arguments)))),n=U(t,2),i=n[0],r=n[1];return this._getMessageList(e,Se.MESSAGE_ID,i,r)}},{key:"getPreviousAndNextMessagesByID",value:function(e){var t=this._parseMessageListParams.apply(this,["prevnext"].concat(O(ae.toArray(arguments)))),n=U(t,2),i=n[0],r=n[1];return this._getMessageList(e,Se.MESSAGE_ID,i,r)}},{key:"getMessagesByTimestamp",value:function(e,t,n){return this._getMessageList(e,Se.TIMESTAMP,t,n)}},{key:"getMessagesByMessageId",value:function(e,t,n){return this._getMessageList(e,Se.MESSAGE_ID,t,n)}},{key:"_sendUserMessage",value:function(e){var t=this,n=e.reqId,i=e.message,r=e.data,s=e.customType,a=e.metaArrays,o=e.mentionType,l=e.mentionedUserIds,u=e.pushNotificationDeliveryOption,c=e.rootMessageId,d=e.parentMessageId,h=e.translationTargetLanguages,p=e.appleCriticalAlertOptions,f=e.pollId,g=e.silent,y=void 0!==g&&g,m=e.isReplyToChannel,_=e.callback,v=G.get(this._iid),E=v.Command,C=v.UserMessage;n||(n=E.generateRequestId());var b=fn.getInstance(this._iid),S={};Array.isArray(h)&&h.forEach((function(e){return S[e]=""}));var A=C.objectify({messageId:0,reqId:n,user:b.currentUser||{},channel:this,message:i,data:r,customType:s,metaArrays:a,mentionType:o,mentionedUserIds:l,rootMessageId:c,parentMessageId:d,translations:S,silent:y,appleCriticalAlertOptions:p,isReplyToChannel:m,createdAt:(new Date).getTime()}),k=new C(A);if(k.requestState=b.MessageRequestState.PENDING,k.sendingStatus=b.MessageSendingStatus.PENDING,k.requestedMentionUserIds=l,!b.currentUser){var I=new D("Connection should be made first.",D.CONNECTION_REQUIRED),U=new C(A);return U.requestState=b.MessageRequestState.FAILED,U.sendingStatus=b.MessageSendingStatus.FAILED,U.requestedMentionUserIds=l,U.errorCode=I.code,_(I,U),k}var O=E.bMessage({channelUrl:this.url,message:i,data:r,customType:s,metaArrays:a,mentionType:o,mentionedUserIds:l,requestId:n,rootMessageId:c,parentMessageId:d,silent:y,translationTargetLanguages:h,pushNotificationDeliveryOption:u,appleCriticalAlertOptions:p,pollId:f,isReplyToChannel:m});return k.reqId=O.requestId,this.isGroupChannel()&&b.getConnectionState()!==b.ConnectionState.OPEN&&b.currentUser&&!b.connecting&&!b.reconnecting&&"string"==typeof s&&0===s.indexOf("SB_VIDEOCHAT")?L.get(b._iid).container.apiClient.sendUserMessage({channelUrl:this.url,isOpenChannel:this.isOpenChannel(),message:i,data:r,customType:s,translationTargetLanguages:h,metaArrays:a,mentionType:o,mentionedUserIds:l,pushNotificationDeliveryOption:u,rootMessageId:c,parentMessageId:d,appleCriticalAlertOptions:p,pollId:f,isReplyToChannel:m},(function(e,t){var n=null;e?((n=new C(A)).requestState=b.MessageRequestState.FAILED,n.sendingStatus=b.MessageSendingStatus.FAILED,e.code===D.REQUEST_CANCELED&&(n.sendingStatus=b.MessageSendingStatus.CANCELED),n.requestedMentionUserIds=l,n.errorCode=e.code):((n=new C(t)).requestState=b.MessageRequestState.SUCCEEDED,n.sendingStatus=b.MessageSendingStatus.SUCCEEDED),_(e,n)})):b.sendCommand(O,(function(e,n){if(b.getErrorFirstCallback()){var i=[e,n];n=i[0],e=i[1]}if(n){var r=new C(A);r.reqId=O.requestId,r.requestState=b.MessageRequestState.FAILED,r.sendingStatus=b.MessageSendingStatus.FAILED,n.code===D.REQUEST_CANCELED&&(r.sendingStatus=b.MessageSendingStatus.CANCELED),r.requestedMentionUserIds=l,r.errorCode=n.code,_(new D(n.message,n.code),r)}else{var s=new C(e.getJsonElement()),a=b.currentUser;a&&s._sender&&a.userId===s._sender.userId&&(a.nickname!==s._sender.nickname&&(a.nickname=s._sender.nickname),a.plainProfileUrl!==s._sender.plainProfileUrl&&(a.plainProfileUrl=s._sender.plainProfileUrl),ee.deepEqual(a.metaData,s._sender.metaData)||(a.metaData=s._sender.metaData)),t.isGroupChannel()&&(t.lastMessage=s,Object.keys(b.channelHandlers).forEach((function(e){b.channelHandlers[e].onChannelChanged(t)}))),s.requestState=b.MessageRequestState.SUCCEEDED,s.sendingStatus=b.MessageSendingStatus.SUCCEEDED,_(null,s)}})),k}},{key:"sendUserMessage",value:function(){var e=ae.toArray(arguments),t=e.pop(),n=null,i=null,r=G.get(this._iid),s=r.UserMessageParams;if("function"==typeof t)if(e[0]instanceof s)null===(i=e[0]).data&&(i.data=""),null===i.customType&&(i.customType="");else if("string"==typeof e[0])switch((i=new s).message=e[0],e.length){case 1:break;case 2:i.data=e[1]||"";break;case 3:i.data=e[1]||"",i.customType=e[2]||"";break;case 4:i.data=e[1]||"",i.customType=e[2]||"",i.translationTargetLanguages=Array.isArray(e[3])?e[3]:[e[3]];break;default:n=ae.error}else n=ae.error;else n=ae.error;var a=L.get(this._iid),o=a.container.isErrorFirstInCallback;return!n&&i._validate()&&i.message?this._sendUserMessage(d(d({},i),{},{metaArrays:i.metaArrays,mentionType:i.mentionType,mentionedUserIds:i._mentionedUserIds,rootMessageId:i.rootMessageId,parentMessageId:i.parentMessageId,translationTargetLanguages:i._translationTargetLanguages,callback:function(e,n){o?t(e,n):t(n,e)}})):(o?t(ae.error,null):t(null,ae.error),null)}},{key:"resendUserMessage",value:function(e,t){var n=this,i=G.get(this._iid),r=i.UserMessage,s=i.UserMessageParams,a=null,o=ae.parse(arguments,[new ae({type:r,constraint:function(e){return 0===e.messageId&&e.isResendable()&&e.reqId&&e.channelUrl===n.url&&"string"==typeof e.message&&"string"==typeof e.data&&"string"==typeof e.customType&&"object"===h(e.translations)&&!Array.isArray(e.translations)}}),new ae({type:"callback"})]),l=U(o,3);return a=l[0],e=l[1],t=l[2],_e(this._iid,(function(t){if(a)a.message+=" Please check if the failed message is resend-able with `message.isResendable().`",t(a,null);else{var i=Object.keys(e.translations),r=s.PushNotificationDeliveryOption.DEFAULT;n._sendUserMessage(d(d({},e),{},{mentionedUserIds:e.requestedMentionUserIds,translationTargetLanguages:i,pushNotificationDeliveryOption:r,reqId:e.reqId,callback:t}))}}),t)}},{key:"updateUserMessage",value:function(e,t,n,i,r){var s=this,a=G.get(this._iid),o=a.Command,l=a.UserMessage,u=a.UserMessageParams,c=arguments,h=null,p=null;if("number"==typeof e)switch(c.length){case 3:var f=ae.parse(c,[new ae({type:"number"}),new ae({type:u}),new ae({type:"callback"})]),g=U(f,4);h=g[0],e=g[1],p=g[2],r=g[3];break;case 5:p=new u;var y=ae.parse(c,[new ae({type:"number"}),new ae({type:"string",nullable:!0}),new ae({type:"string",nullable:!0}),new ae({type:"string",nullable:!0}),new ae({type:"callback"})]),m=U(y,6);h=m[0],e=m[1],t=m[2],n=m[3],i=m[4],r=m[5],p.message=t,p.data=n,p.customType=i}return _e(this._iid,(function(t){if(!h&&p&&p._validate()){var n=o.bUpdateUserMessage(d(d({channelUrl:s.url,messageId:e},p),{},{mentionType:p._mentionType,mentionedUserIds:p._mentionedUserIds})),i=fn.getInstance(s._iid);i.sendCommand(n,(function(e,n){if(i.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}var s=null;n||(s=new l(e.getJsonElement())),t(n,s)}))}else t(ae.error,null)}),r)}},{key:"translateUserMessage",value:function(e,t,n){var i=this,r=fn.getInstance(this._iid),s=G.get(this._iid),a=s.UserMessage,o=null,l=ae.parse(arguments,[new ae({type:a,constraint:function(e){return e.channelUrl===i.url&&e.sendingStatus===r.MessageSendingStatus.SUCCEEDED}}),new ae({type:"array",constraint:function(e){return e.every((function(e){return"string"==typeof e}))}}),new ae({type:"callback"})]),u=U(l,4);return o=u[0],e=u[1],t=u[2],n=u[3],_e(this._iid,(function(n){o?n(o,null):L.get(i._iid).container.apiClient.translateUserMessage({channelUrl:i.url,isOpenChannel:i.isOpenChannel(),messageId:e.messageId,translationTargetLanguages:t},(function(e,t){var i=null;e||(i=new a(t)),n(e,i)}))}),n)}},{key:"_parseFileMessageArguments",value:function(e){var t=G.get(this._iid),n=t.BaseMessageParams,i=t.FileMessageParams,r={error:null,file:null,name:null,type:null,size:null,data:"",customType:"",thumbnailSizes:[],metaArrays:[],mentionType:n.MentionType.USERS,mentionedUserIds:[],pushNotificationDeliveryOption:i.PushNotificationDeliveryOption.DEFAULT,rootMessageId:null,parentMessageId:null,progressHandler:null,silent:!1,appleCriticalAlertOptions:null,isReplyToChannel:!1,callback:null};if("function"==typeof e[e.length-1]&&(r.callback=e.pop()),"function"==typeof e[e.length-1]&&(r.progressHandler=e.pop()),e[0]instanceof i)r.file=e[0].file||e[0].fileUrl,r.name=e[0].fileName,r.type=e[0].mimeType,r.size=e[0].fileSize,r.data=e[0].data,r.customType=e[0].customType,r.thumbnailSizes=e[0].thumbnailSizes,r.metaArrays=e[0].metaArrays,r.mentionType=e[0]._mentionType,r.mentionedUserIds=e[0]._mentionedUserIds,r.pushNotificationDeliveryOption=e[0].pushNotificationDeliveryOption?e[0].pushNotificationDeliveryOption:i.PushNotificationDeliveryOption.DEFAULT,r.rootMessageId=e[0].rootMessageId,r.parentMessageId=e[0].parentMessageId,r.silent=e[0].silent,e[0]._validate()||(r.error=ae.error),r.appleCriticalAlertOptions=e[0].appleCriticalAlertOptions,r.isReplyToChannel=e[0].isReplyToChannel;else if(ee.isFile(e[0])||"string"==typeof e[0]){switch(r.file=e[0],e.length){case 1:break;case 2:r.data=e[1];break;case 3:r.data=e[1],r.customType=e[2];break;case 4:r.data=e[1],r.customType=e[2],r.thumbnailSizes=e[3];break;case 5:r.name=e[1],r.type=e[2],r.size=e[3],r.data=e[4];break;case 6:r.name=e[1],r.type=e[2],r.size=e[3],r.data=e[4],r.customType=e[5];break;case 7:r.name=e[1],r.type=e[2],r.size=e[3],r.data=e[4],r.customType=e[5],r.thumbnailSizes=e[6]}var s=U(ae.parse([r.file,r.name,r.type,r.size,r.data,r.customType,r.thumbnailSizes],[new ae({type:["file","string"]}),new ae({type:"string",nullable:!0}),new ae({type:"string",nullable:!0}),new ae({type:"number",nullable:!0,constraint:function(e){return e>=0}}),new ae({type:"string",nullable:!0}),new ae({type:"string",nullable:!0}),new ae({type:"array"})]),8);r.error=s[0],r.file=s[1],r.name=s[2],r.type=s[3],r.size=s[4],r.data=s[5],r.customType=s[6],r.thumbnailSizes=s[7]}else r.error=ae.error;return ee.isFile(r.file)&&(r.name=r.name||r.file.name,r.type=r.type||r.file.type,r.size=r.size||r.file.size),r}},{key:"_createTempFileMessage",value:function(e){try{var t=fn.getInstance(this._iid),n=G.get(this._iid),i=n.Command,r=n.FileMessage,s=r.objectify(d(d({},e),{},{messageId:0,reqId:i.generateRequestId(),user:t.currentUser||{},channel:this,plainUrl:"string"==typeof e.file?e.file:"",thumbnails:e.thumbnailSizes.map((function(e){return{url:"",plainUrl:"",width:e.maxWidth,height:e.maxHeight,real_width:0,real_height:0}})),sendingStatus:t.MessageSendingStatus.PENDING,createdAt:(new Date).getTime()}));return new r(s)}catch(e){return null}}},{key:"sendFileMessage",value:function(){var e=this._parseFileMessageArguments(ae.toArray(arguments)),t=G.get(this._iid),n=t.Command,i=null,r=n.generateRequestId();e.error||((i=this._createTempFileMessage(e)).requestedMentionUserIds=e.mentionedUserIds,r=i.reqId);var s=fn.getInstance(this._iid);s&&s.currentUser||(e.error=new D("Connection should be made first.",D.CONNECTION_REQUIRED));var a=G.get(this._iid),o=a.FileMessageQueue,l=o.create(this);return l.addJob(new o.Job({fileInfo:e,pendingMessage:i,requestId:r,error:e.error,response:null})),i}},{key:"sendFileMessages",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.progress?n.progress:function(){},r=n.sent?n.sent:function(){},s=n.complete?n.complete:function(){};if(Array.isArray(e)&&e.length>0&&e.length<=20){var a=[];return e.forEach((function(n,o){a.push(t.sendFileMessage(n,i,(function(t,n){r(t,n),o===e.length-1&&s(null)})))})),a}return s(ae.error),null}},{key:"resendFileMessage",value:function(e,t,n){var i=this,r=G.get(this._iid),s=r.FileMessage,a=r.FileMessageParams,o=null,l=ae.parse(arguments,[new ae({type:s,constraint:function(e){return 0===e.messageId&&e.isResendable()&&e.reqId&&e.channelUrl===i.url&&"string"==typeof e.data&&"string"==typeof e.customType&&Array.isArray(e.thumbnails)}}),new ae({type:"file",optionalIf:function(e){return!!e[0].url},defaultValue:null}),new ae({type:"callback"})]),u=U(l,4);return o=u[0],e=u[1],t=u[2],n=u[3],_e(this._iid,(function(n){if(o)o.message+=" Please check if the failed message is resend-able with `message.isResendable().`",n(o,null);else{var r=new a;e.url?r.fileUrl=e.url:r.file=t,r.fileName=e.name,r.fileSize=e.size,r.mimeType=e.type,r.data=e.data,r.customType=e.customType,r.mentionType=e.mentionType,r.mentionedUserIds=e.requestedMentionUserIds,r.metaArrays=e.metaArrays,r.thumbnailSizes=e.thumbnails.map((function(e){return{maxWidth:e.width,maxHeight:e.height}})),r.appleCriticalAlertOptions=e.appleCriticalAlertOptions,i.sendFileMessage(r,n)}}),n)}},{key:"updateFileMessage",value:function(e,t,n,i){var r=this,s=G.get(this._iid),a=s.Command,o=s.FileMessage,l=s.FileMessageParams,u=arguments,c=null,h=null;if("number"==typeof e)switch(u.length){case 3:var p=ae.parse(u,[new ae({type:"number"}),new ae({type:l}),new ae({type:"callback"})]),f=U(p,4);c=f[0],e=f[1],h=f[2],i=f[3],h&&(h._isUpdate=!0);break;case 4:h=new l;var g=ae.parse(u,[new ae({type:"number"}),new ae({type:"string",nullable:!0}),new ae({type:"string",nullable:!0}),new ae({type:"callback"})]),y=U(g,5);c=y[0],e=y[1],t=y[2],n=y[3],i=y[4],h.data=t,h.customType=n,h._isUpdate=!0}return _e(this._iid,(function(t){if(!c&&h&&h._validate()){var n=a.bUpdateFileMessage(d(d({channelUrl:r.url,messageId:e},h),{},{mentionType:h._mentionType,mentionedUserIds:h._mentionedUserIds})),i=fn.getInstance(r._iid);i.sendCommand(n,(function(e,n){if(i.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}var s=null;n||(s=new o(e.getJsonElement())),t(n,s)}))}else t(ae.error,null)}),i)}},{key:"cancelUploadingFileMessage",value:function(e,t){var n=null,i=ae.parse(arguments,[new ae({type:["number","string"]}),new ae({type:"callback"})]),r=U(i,3);n=r[0],e=r[1],t=r[2];var s=L.get(this._iid),a=s.container.isErrorFirstInCallback;if(n)return a?t(n,null):t(null,n),!1;var o=G.get(this._iid),l=o.FileMessageQueue,u=l.create(this);return u.cancelUploadItemByRequestId(e,(function(e,n){return a?t(e,n):t(n,e)}))}},{key:"addReaction",value:function(e,t,n){var i=this,r=fn.getInstance(this._iid),s=G.get(this._iid),a=s.ReactionEvent,o=null,l=ae.parse(arguments,[new ae({type:Ce}),new ae({type:"string",constraint:function(e){return e.length>0}}),new ae({type:"callback"})]),u=U(l,4);return o=u[0],e=u[1],t=u[2],n=u[3],_e(this._iid,(function(n){o?n(o,null):e.sendingStatus===r.MessageSendingStatus.SUCCEEDED?L.get(i._iid).container.apiClient.addReaction({isGroupChannel:e.isGroupChannel(),channelUrl:e.channelUrl,messageId:e.messageId,key:t},(function(t,i){var r=null;t||(r=a.createFromJson(d(d({},i),{},{msg_id:e.messageId}))),n(t,r)})):n(new D("Cannot add reaction to a non-succeeded message.",D.REQUEST_FAILED),null)}),n)}},{key:"deleteReaction",value:function(e,t,n){var i=this,r=fn.getInstance(this._iid),s=G.get(this._iid),a=s.ReactionEvent,o=null,l=ae.parse(arguments,[new ae({type:Ce}),new ae({type:"string",constraint:function(e){return e.length>0}}),new ae({type:"callback"})]),u=U(l,4);return o=u[0],e=u[1],t=u[2],n=u[3],_e(this._iid,(function(n){o?n(o,null):e.sendingStatus===r.MessageSendingStatus.SUCCEEDED?L.get(i._iid).container.apiClient.deleteReaction({isGroupChannel:e.isGroupChannel(),channelUrl:e.channelUrl,messageId:e.messageId,key:t},(function(t,i){var r=null;t||(r=a.createFromJson(d(d({},i),{},{msg_id:e.messageId}))),n(t,r)})):n(new D("Cannot remove reaction to a non-succeeded message.",D.REQUEST_FAILED),null)}),n)}},{key:"deleteMessage",value:function(e,t){var n=this,i=null,r=ae.parse(arguments,[new ae({type:"object",constraint:function(e){return!Array.isArray(e)&&null!==e&&e.hasOwnProperty("messageId")}}),new ae({type:"callback"})]),s=U(r,3);return i=s[0],e=s[1],t=s[2],_e(this._iid,(function(t){i?t(i,null):L.get(n._iid).container.apiClient.deleteMessage({channelUrl:n.url,isOpenChannel:n.isOpenChannel(),messageId:e.messageId},(function(e,n){return t(e,null)}))}),t)}},{key:"copyUserMessage",value:function(t,n,i){var r=G.get(this._iid);r.Command;var s=r.UserMessage,a=r.BaseMessageParams,o=null,l=ae.parse(arguments,[new ae({type:e}),new ae({type:s}),new ae({type:"callback"})]),u=U(l,4);o=u[0],t=u[1],n=u[2],i=u[3];var c=L.get(this._iid),h=c.container.isErrorFirstInCallback;if(o)return h?i(ae.error,null):i(null,ae.error),null;if(this.url!==n.channelUrl){var p=new D("The message does not belong to this channel",D.INVALID_PARAMETER);return h?i(p,null):i(null,p),null}var f={},g=Object.keys(n.translations);g.forEach((function(e){return f[e]=""}));var y=a.PushNotificationDeliveryOption.DEFAULT;return t._sendUserMessage(d(d({},n),{},{reqId:null,pushNotificationDeliveryOption:y,translationTargetLanguages:g,rootMessageId:null,parentMessageId:null,parentMessageText:null,callback:i}))}},{key:"copyFileMessage",value:function(t,n,i){var r=G.get(this._iid),s=r.Command;r.GroupChannel;var a=r.FileMessage,o=r.BaseMessageParams;r.FileMessageParams;var l=r.User,u=null,c=ae.parse(arguments,[new ae({type:e}),new ae({type:a}),new ae({type:"callback"})]),d=U(c,4);u=d[0],t=d[1],n=d[2],i=d[3];var h=L.get(this._iid),p=h.container.isErrorFirstInCallback;if(u)return p?i(ae.error,null):i(null,ae.error),null;if(this.url!==n.channelUrl){var f=new D("The message does not belong to this channel");return p?i(f,null):i(null,f),null}var g=fn.getInstance(this._iid),y=n,m=y.url,_=y.name,v=y.type,E=y.size,C=y.data,b=y.customType,S=y.mentionType,A=y.mentionedUserIds,k=y.mentionedUsers,I=y.metaArrays,O=y.thumbnails,T=y.requireAuth,R=y.messageSurvivalSeconds,N=y.silent,w=y.appleCriticalAlertOptions,M=s.generateRequestId(),P=g.currentUser||{},H=t.url,F=t.isOpenChannel(),x=k.filter((function(e){return new l(l.objectify(e))})),j=o.PushNotificationDeliveryOption.DEFAULT,B=a.objectify({messageId:0,reqId:M,user:P,channel:t,plainUrl:m,name:_,type:v,size:E,data:C,customType:b,mentionType:S,mentionedUserIds:A,mentionedUsers:x,requestedMentionUserIds:A,metaArrays:I,thumbnails:O,requireAuth:T,messageSurvivalSeconds:R,silent:N,createdAt:(new Date).getTime(),appleCriticalAlertOptions:w}),q=new a(B);if(q.requestState=g.MessageRequestState.PENDING,q.sendingStatus=g.MessageSendingStatus.PENDING,!g.currentUser){var z=new D("Connection should be made first.",D.CONNECTION_REQUIRED),Y=new a(B);return Y.requestState=g.MessageRequestState.FAILED,Y.sendingStatus=g.MessageSendingStatus.FAILED,Y.errorCode=z.code,p?i(z,Y):i(Y,z),q}var V=s.bFile({requestId:M,channelUrl:H,url:m,name:_,type:v,size:E,data:C,customType:b,metaArrays:I,mentionType:S,mentionedUserIds:A,thumbnailSizes:O,requireAuth:T,pushNotificationDeliveryOption:j,silent:N,appleCriticalAlertOptions:w});return g.getConnectionState()===g.ConnectionState.OPEN||g.connecting||g.reconnecting?g.sendCommand(V,(function(e,n){if(g.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}if(n)if(n.code!==D.INVALID_PARAMETER){var s=new a(B);s.requestState=g.MessageRequestState.FAILED,s.sendingStatus=g.MessageSendingStatus.FAILED,n.code!==D.FILE_UPLOAD_CANCEL_FAILED&&n.code!==D.REQUEST_CANCELED||(s.sendingStatus=g.MessageSendingStatus.CANCELED),s.errorCode=n.code,p?i(n,s):i(s,n)}else p?i(n,null):i(null,n);else{var o=new a(e.getJsonElement()),l=o._sender;P&&l&&P.userId===l.userId&&(P.nickname!==l.nickname&&(P.nickname=l.nickname),P.plainProfileUrl!==l.plainProfileUrl&&(P.plainProfileUrl=l.plainProfileUrl)),t.isGroupChannel()&&(t.lastMessage=o,Object.keys(g.channelHandlers).forEach((function(e){g.channelHandlers[e].onChannelChanged(t)}))),p?i(null,o):i(o,null)}})):h.container.apiClient.sendFileMessage({channelUrl:H,isOpenChannel:F,fileUrl:m,fileName:_,fileType:v,fileSize:E,data:C,customType:b,metaArrays:I,mentionType:S,mentionedUserIds:A,thumbnailSizes:O,requireAuth:T,pushNotificationDeliveryOption:j,appleCriticalAlertOptions:w},(function(e,n){if(e)if(e.code!==D.INVALID_PARAMETER){var r=new a(commnad.getJsonElement());r.requestState=g.MessageRequestState.FAILED,r.sendingStatus=g.MessageSendingStatus.FAILED,e.code!==D.FILE_UPLOAD_CANCEL_FAILED&&e.code!==D.REQUEST_CANCELED||(r.sendingStatus=g.MessageSendingStatus.CANCELED),r.errorCode=e.code,p?i(e,r):i(r,e)}else p?i(e,null):i(null,e);else{var s=new a(n),o=s._sender;P&&o&&P.userId===o.userId&&(P.nickname!==o.nickname&&(P.nickname=o.nickname),P.plainProfileUrl!==o.plainProfileUrl&&(P.plainProfileUrl=o.plainProfileUrl)),t.isGroupChannel()&&(t.lastMessage=s,Object.keys(g.channelHandlers).forEach((function(e){g.channelHandlers[e].onChannelChanged(t)}))),p?i(null,s):i(s,null)}})),q}},{key:"addOperators",value:function(e,t){var n=this,i=null,r=ae.parse(arguments,[new ae({type:"array",constraint:function(e){return Object.keys(e).map((function(t){return e[t]})).every((function(e){return"string"==typeof e}))}}),new ae({type:"callback"})]),s=U(r,3);return i=s[0],e=s[1],t=s[2],_e(this._iid,(function(t){i?t(i,null):L.get(n._iid).container.apiClient.addOperators({channelUrl:n.url,isOpenChannel:n.isOpenChannel(),operatorUserIds:e},(function(e,n){return t(e,n)}))}),t)}},{key:"removeOperators",value:function(e,t){var n=this,i=null,r=ae.parse(arguments,[new ae({type:"array",constraint:function(e){return Object.keys(e).map((function(t){return e[t]})).every((function(e){return"string"==typeof e}))}}),new ae({type:"callback"})]),s=U(r,3);return i=s[0],e=s[1],t=s[2],_e(this._iid,(function(t){i?t(i,null):L.get(n._iid).container.apiClient.removeOperators({channelUrl:n.url,isOpenChannel:n.isOpenChannel(),operatorUserIds:e},(function(e,n){return t(e,n)}))}),t)}},{key:"getMetaCounters",value:function(e,t){var n=this,i=null,r=ae.parse(arguments,[new ae({type:"array",constraint:function(e){return Object.keys(e).map((function(t){return e[t]})).every((function(e){return"string"==typeof e}))}}),new ae({type:"callback"})]),s=U(r,3);return i=s[0],e=s[1],t=s[2],_e(this._iid,(function(t){i?t(i,null):L.get(n._iid).container.apiClient.getMetaCounters({channelUrl:n.url,isOpenChannel:n.isOpenChannel(),keys:e},(function(e,n){return t(e,n)}))}),t)}},{key:"getAllMetaCounters",value:function(e){var t=this;return _e(this._iid,(function(e){L.get(t._iid).container.apiClient.getMetaCounters({channelUrl:t.url,isOpenChannel:t.isOpenChannel(),keys:[]},(function(t,n){return e(t,n)}))}),e)}},{key:"createMetaCounters",value:function(e,t){var n=this,i=null,r=ae.parse(arguments,[new ae({type:"object",constraint:function(e){return e&&!Array.isArray(e)&&Object.keys(e).length>0&&Object.keys(e).map((function(t){return e[t]})).every((function(e){return"number"==typeof e}))}}),new ae({type:"callback"})]),s=U(r,3);return i=s[0],e=s[1],t=s[2],_e(this._iid,(function(t){i?t(i,null):L.get(n._iid).container.apiClient.createMetaCounters({channelUrl:n.url,isOpenChannel:n.isOpenChannel(),metaCounter:e},(function(e,n){return t(e,n)}))}),t)}},{key:"updateMetaCounters",value:function(e,t,n){var i=this,r=null,s=ae.parse(arguments,[new ae({type:"object",constraint:function(e){return e&&!Array.isArray(e)&&Object.keys(e).length>0&&Object.keys(e).map((function(t){return e[t]})).every((function(e){return"number"==typeof e}))}}),new ae({type:"boolean",optional:!0,defaultValue:!1}),new ae({type:"callback"})]),a=U(s,4);return r=a[0],e=a[1],t=a[2],n=a[3],_e(this._iid,(function(n){r?n(r,null):L.get(i._iid).container.apiClient.updateMetaCounters({channelUrl:i.url,isOpenChannel:i.isOpenChannel(),metaCounter:e,upsert:t,mode:"set"},(function(e,t){return n(e,t)}))}),n)}},{key:"increaseMetaCounters",value:function(e,t){var n=this,i=null,r=ae.parse(arguments,[new ae({type:"object",constraint:function(e){return e&&!Array.isArray(e)&&Object.keys(e).length>0&&Object.keys(e).map((function(t){return e[t]})).every((function(e){return"number"==typeof e}))}}),new ae({type:"callback"})]),s=U(r,3);return i=s[0],e=s[1],t=s[2],_e(this._iid,(function(t){i?t(i,null):L.get(n._iid).container.apiClient.updateMetaCounters({channelUrl:n.url,isOpenChannel:n.isOpenChannel(),metaCounter:e,upsert:!1,mode:"increase"},(function(e,n){return t(e,n)}))}),t)}},{key:"decreaseMetaCounters",value:function(e,t){var n=this,i=null,r=ae.parse(arguments,[new ae({type:"object",constraint:function(e){return e&&!Array.isArray(e)&&Object.keys(e).length>0&&Object.keys(e).map((function(t){return e[t]})).every((function(e){return"number"==typeof e}))}}),new ae({type:"callback"})]),s=U(r,3);return i=s[0],e=s[1],t=s[2],_e(this._iid,(function(t){i?t(i,null):L.get(n._iid).container.apiClient.updateMetaCounters({channelUrl:n.url,isOpenChannel:n.isOpenChannel(),metaCounter:e,upsert:!1,mode:"decrease"},(function(e,n){var i=null;e||(i={},Object.keys(n).forEach((function(e){i[e]=n[e]}))),t(e,i)}))}),t)}},{key:"deleteMetaCounter",value:function(e,t){var n=this,i=null,r=ae.parse(arguments,[new ae({type:"string"}),new ae({type:"callback"})]),s=U(r,3);return i=s[0],e=s[1],t=s[2],_e(this._iid,(function(t){i?t(i,null):L.get(n._iid).container.apiClient.deleteMetaCounter({channelUrl:n.url,isOpenChannel:n.isOpenChannel(),key:e},(function(e,n){return t(e,n)}))}),t)}},{key:"deleteAllMetaCounters",value:function(e){var t=this;return _e(this._iid,(function(e){L.get(t._iid).container.apiClient.deleteAllMetaCounters({channelUrl:t.url,isOpenChannel:t.isOpenChannel()},(function(t,n){return e(t,n)}))}),e)}},{key:"getCachedMetaData",value:function(){var e=Ae.get(this),t={};return Object.keys(e).forEach((function(n){var i=e[n];i.isRemoved||(t[n]=i.value)})),t}},{key:"getMetaData",value:function(e,t){var n=this,i=null,r=ae.parse(arguments,[new ae({type:"array",constraint:function(e){return Object.keys(e).map((function(t){return e[t]})).every((function(e){return"string"==typeof e}))}}),new ae({type:"callback"})]),s=U(r,3);return i=s[0],e=s[1],t=s[2],_e(this._iid,(function(t){i?t(i,null):L.get(n._iid).container.apiClient.getMetaData({channelUrl:n.url,isOpenChannel:n.isOpenChannel(),keys:e},(function(e,n){t(e,n&&n.ts?n.metadata:n)}))}),t)}},{key:"getAllMetaData",value:function(e){var t=this;return _e(this._iid,(function(e){L.get(t._iid).container.apiClient.getMetaData({channelUrl:t.url,isOpenChannel:t.isOpenChannel(),keys:[]},(function(t,n){e(t,n&&n.ts?n.metadata:n)}))}),e)}},{key:"createMetaData",value:function(e,t){var n=this,i=null,r=ae.parse(arguments,[new ae({type:"object",constraint:function(e){return e&&!Array.isArray(e)&&Object.keys(e).length>0}}),new ae({type:"callback"})]),s=U(r,3);return i=s[0],e=s[1],t=s[2],_e(this._iid,(function(t){i?t(i,null):L.get(n._iid).container.apiClient.createMetaData({channelUrl:n.url,isOpenChannel:n.isOpenChannel(),metaData:e},(function(e,n){t(e,n&&n.ts?n.metadata:n)}))}),t)}},{key:"updateMetaData",value:function(e,t,n){var i=this,r=null,s=ae.parse(arguments,[new ae({type:"object",constraint:function(e){return e&&!Array.isArray(e)&&Object.keys(e).length>0}}),new ae({type:"boolean",optional:!0,defaultValue:!1}),new ae({type:"callback"})]),a=U(s,4);return r=a[0],e=a[1],t=a[2],n=a[3],_e(this._iid,(function(n){r?n(r,null):L.get(i._iid).container.apiClient.updateMetaData({channelUrl:i.url,isOpenChannel:i.isOpenChannel(),metaData:e,upsert:t},(function(e,t){n(e,t&&t.ts?t.metadata:t)}))}),n)}},{key:"deleteMetaData",value:function(e,t){var n=this,i=null,r=ae.parse(arguments,[new ae({type:"string"}),new ae({type:"callback"})]),s=U(r,3);return i=s[0],e=s[1],t=s[2],_e(this._iid,(function(t){i?t(i,null):L.get(n._iid).container.apiClient.deleteMetaData({channelUrl:n.url,isOpenChannel:n.isOpenChannel(),key:e},(function(e,n){t(e,n&&n.ts?{}:n)}))}),t)}},{key:"deleteAllMetaData",value:function(e){var t=this;return _e(this._iid,(function(e){L.get(t._iid).container.apiClient.deleteAllMetaData({channelUrl:t.url,isOpenChannel:t.isOpenChannel()},(function(t,n){return e(t,n&&n.ts?{}:n)}))}),e)}},{key:"_updateMessageMetaArray",value:function(e,t,n,i){var r=this;return _e(this._iid,(function(i){var s=G.get(r._iid),a=s.Command,o=s.UserMessage,l=s.FileMessage,u=s.AdminMessage,c=null;if(t.isUserMessage()?c=a.bUpdateUserMessage({channelUrl:e,messageId:t.messageId,metaArrayParams:n}):t.isFileMessage()&&(c=a.bUpdateFileMessage({channelUrl:e,messageId:t.messageId,metaArrayParams:n})),c){var d=fn.getInstance(r._iid);d.sendCommand(c,(function(e,n){if(d.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}var s=null;n||(t.isUserMessage()?s=new o(e.getJsonElement()):t.isFileMessage()?s=new l(e.getJsonElement()):t.isAdminMessage()&&(s=new u(e.getJsonElement()))),i(n,s)}))}else i(ae.error,null)}),i)}},{key:"createMessageMetaArrayKeys",value:function(e,t,n){var i=G.get(this._iid),r=i.MessageMetaArray,s=null,a=ae.parse(arguments,[new ae({type:Ce}),new ae({type:"array",constraint:function(e){return e.every((function(e){return"string"==typeof e&&""!==e}))}}),new ae({type:"callback"})]),o=U(a,4);if(s=o[0],e=o[1],t=o[2],n=o[3],s)return _e(this._iid,(function(e){e(s,null)}),n);var l=[];if(Array.isArray(t))for(var u=0;u<t.length;u++){var c=t[u];l.push(new r(c,[]))}return this._updateMessageMetaArray(this.url,e,{array:l.map((function(e){return e.encode()})),mode:"add",upsert:!0},n)}},{key:"deleteMessageMetaArrayKeys",value:function(e,t,n){var i=G.get(this._iid),r=i.MessageMetaArray,s=null,a=ae.parse(arguments,[new ae({type:Ce}),new ae({type:"array",constraint:function(e){return e.every((function(e){return"string"==typeof e&&""!==e}))}}),new ae({type:"callback"})]),o=U(a,4);if(s=o[0],e=o[1],t=o[2],n=o[3],s)return _e(this._iid,(function(e){e(s,null)}),n);var l=[];if(Array.isArray(t))for(var u=0;u<t.length;u++){var c=t[u];l.push(new r(c,[]))}return this._updateMessageMetaArray(this.url,e,{array:l.map((function(e){return e.encode()})),mode:"remove",upsert:!0},n)}},{key:"addMessageMetaArrayValues",value:function(e,t,n){var i=G.get(this._iid),r=i.MessageMetaArray,s=null,a=ae.parse(arguments,[new ae({type:Ce}),new ae({type:"object",constraint:function(e){return e&&(Array.isArray(e)&&e.length>0&&e.every((function(e){return e instanceof r}))||Object.keys(e).length>0&&Object.keys(e).every((function(t){return Array.isArray(e[t])&&e[t].length>0&&e[t].every((function(e){return"string"==typeof e&&e.length>0}))})))}}),new ae({type:"callback"})]),o=U(a,4);if(s=o[0],e=o[1],t=o[2],n=o[3],s)return _e(this._iid,(function(e){e(s,null)}),n);var l=Array.isArray(t)?t.map((function(e){return e.encode()})):Object.keys(t).map((function(e){return{key:e,value:t[e]}}));return this._updateMessageMetaArray(this.url,e,{array:l,mode:"add",upsert:!0},n)}},{key:"removeMessageMetaArrayValues",value:function(e,t,n){var i=G.get(this._iid),r=i.MessageMetaArray,s=null,a=ae.parse(arguments,[new ae({type:Ce}),new ae({type:"object",constraint:function(e){return e&&(Array.isArray(e)&&e.length>0&&e.every((function(e){return e instanceof r}))||Object.keys(e).length>0&&Object.keys(e).every((function(t){return Array.isArray(e[t])&&e[t].length>0&&e[t].every((function(e){return"string"==typeof e&&e.length>0}))})))}}),new ae({type:"callback"})]),o=U(a,4);if(s=o[0],e=o[1],t=o[2],n=o[3],s)return _e(this._iid,(function(e){e(s,null)}),n);var l=Array.isArray(t)?t.map((function(e){return e.encode()})):Object.keys(t).map((function(e){return{key:e,value:t[e]}}));return this._updateMessageMetaArray(this.url,e,{array:l,mode:"remove",upsert:!0},n)}},{key:"report",value:function(e,t,n){var i=this,r=G.get(this._iid),s=r.BaseChannel,a=null,o=ae.parse(arguments,[new ae({type:s.ReportCategory}),new ae({type:"string"}),new ae({type:"callback"})]),l=U(o,4);return a=l[0],e=l[1],t=l[2],n=l[3],_e(this._iid,(function(n){if(a)n(a,null);else{var r=fn.getInstance(i._iid);L.get(i._iid).container.apiClient.report({channelUrl:i.url,isOpenChannel:i.isOpenChannel(),reportCategory:e,reportingUserId:r.currentUser?r.currentUser.userId:null,reportDescription:t},(function(e,t){n(e,null)}))}}),n)}},{key:"reportUser",value:function(e,t,n,i){var r=this,s=G.get(this._iid),a=s.BaseChannel,o=null,l=ae.parse(arguments,[new ae({type:be}),new ae({type:a.ReportCategory}),new ae({type:"string"}),new ae({type:"callback"})]),u=U(l,5);return o=u[0],e=u[1],t=u[2],n=u[3],i=u[4],_e(this._iid,(function(i){if(o)i(o,null);else{var s=fn.getInstance(r._iid);L.get(r._iid).container.apiClient.reportUser({channelUrl:r.url,isOpenChannel:r.isOpenChannel(),reportCategory:t,offendingUserId:e.userId,reportingUserId:s.currentUser?s.currentUser.userId:null,reportDescription:n},(function(e,t){i(e,null)}))}}),i)}},{key:"reportMessage",value:function(e,t,n,i){var r=this,s=G.get(this._iid),a=s.BaseChannel,o=null,l=ae.parse(arguments,[new ae({type:Ce}),new ae({type:a.ReportCategory}),new ae({type:"string"}),new ae({type:"callback"})]),u=U(l,5);return o=u[0],e=u[1],t=u[2],n=u[3],i=u[4],_e(this._iid,(function(i){if(o)i(o,null);else{var s=fn.getInstance(r._iid);L.get(r._iid).container.apiClient.reportMessage({messageId:e.messageId,channelUrl:r.url,isOpenChannel:r.isOpenChannel(),reportCategory:t,offendingUserId:e.sender.userId,reportingUserId:s.currentUser?s.currentUser.userId:null,reportDescription:n},(function(e,t){i(e,null)}))}}),i)}}],[{key:"CHANNEL_TYPE_OPEN",get:function(){return"open"}},{key:"CHANNEL_TYPE_GROUP",get:function(){return"group"}},{key:"CHANNEL_TYPE_BASE",get:function(){return"base"}},{key:"MessageTypeFilter",get:function(){return{ALL:"",USER:"MESG",FILE:"FILE",ADMIN:"ADMM"}}},{key:"ReportCategory",get:function(){return{SPAM:"spam",HARASSING:"harassing",SUSPICIOUS:"suspicious",INAPPROPRIATE:"inappropriate"}}},{key:"buildMessage",value:function(e,t){var n=G.get(this._iid),i=n.UserMessage,r=n.FileMessage,s=n.AdminMessage;if(e)switch(e.hasOwnProperty("channel_type")||(e.channel_type=t.channelType),e.type){case"MESG":return new i(e);case"FILE":var a=e.file;return new r(d(d({},e),{},{url:String(a.url),name:String(a.name),type:String(a.type),size:parseInt(a.size),data:String(a.data)}));case"BRDM":case"ADMM":return new s(e)}return null}}]),e}(),Ie=function(){function e(t){p(this,e),t&&(this.category=t.hasOwnProperty("cat")?parseInt(t.cat):0,this.data=t.hasOwnProperty("data")?t.data:null,this.channelUrl=t.hasOwnProperty("channel_url")?String(t.channel_url):"",this.channelType=t.hasOwnProperty("channel_type")?String(t.channel_type):ke.CHANNEL_TYPE_GROUP)}return g(e,[{key:"isGroupChannel",value:function(){return this.channelType===ke.CHANNEL_TYPE_GROUP}},{key:"isOpenChannel",value:function(){return this.channelType===ke.CHANNEL_TYPE_OPEN}}]),e}();Ie.CATEGORY_NONE=0,Ie.CATEGORY_CHANNEL_ENTER=10102,Ie.CATEGORY_CHANNEL_EXIT=10103,Ie.CATEGORY_USER_CHANNEL_MUTE=10201,Ie.CATEGORY_USER_CHANNEL_UNMUTE=10200,Ie.CATEGORY_USER_CHANNEL_BAN=10601,Ie.CATEGORY_USER_CHANNEL_UNBAN=10600,Ie.CATEGORY_CHANNEL_FREEZE=10701,Ie.CATEGORY_CHANNEL_UNFREEZE=10700,Ie.CATEGORY_TYPING_START=10900,Ie.CATEGORY_TYPING_END=10901,Ie.CATEGORY_CHANNEL_JOIN=1e4,Ie.CATEGORY_CHANNEL_LEAVE=10001,Ie.CATEGORY_CHANNEL_OPERATOR_UPDATE=10002,Ie.CATEGORY_CHANNEL_INVITE=10020,Ie.CATEGORY_CHANNEL_DECLINE_INVITE=10022,Ie.CATEGORY_CHANNEL_PROP_CHANGED=11e3,Ie.CATEGORY_CHANNEL_DELETED=12e3,Ie.CATEGORY_CHANNEL_META_DATA_CHANGED=11100,Ie.CATEGORY_CHANNEL_META_COUNTERS_CHANGED=11200,Ie.CATEGORY_CHANNEL_HIDE=13e3,Ie.CATEGORY_CHANNEL_UNHIDE=13001;var Ue=function e(t){p(this,e),t&&(this.category=t.hasOwnProperty("cat")?parseInt(t.cat):0)};Ue.CATEGORY_USER_BLOCK=20001,Ue.CATEGORY_USER_UNBLOCK=2e4,Ue.CATEGORY_FRIEND_DISCOVERED=20900;var Oe=function(){function e(t){p(this,e),this.sb=t,this.cls=G.get(this.sb._iid)}return g(e,[{key:"onRawCommandReceived",value:function(e){var t=this,n=this.cls,i=n.Command,r=n.User,s=n.Member,a=n.RestrictedUser,o=n.BaseChannel,l=n.GroupChannel,u=n.OpenChannel,c=n.UserMessage,p=n.FileMessage,f=n.AdminMessage,g=n.BaseMessageParams,y=n.ReactionEvent,m=n.ReadStatus,_=n.ThreadInfoUpdateEvent,v=n.PollUpdateEvent,E=n.PollVoteEvent,C=n.RestrictionInfo,b=L.get(this.sb._iid),S=b.container,A=S.pinger,k=S.auth,I=S.subscribedUnreadMessageCount,U=S.sessionManager,O=S.ackStateMap,T=new i(e),R=T.getJsonElement();if(R.hasOwnProperty("unread_cnt")&&"object"===h(R.unread_cnt)){var M=!1,P=R.unread_cnt.ts;"number"==typeof P&&P>I.ts&&(I.all!==R.unread_cnt.all&&(M=!0),I.all=R.unread_cnt.all>=0?R.unread_cnt.all:0,R.unread_cnt.custom_types&&Object.keys(R.unread_cnt.custom_types).forEach((function(e){I.custom_types[e]!==R.unread_cnt.custom_types[e]&&(M=!0),I.custom_types[e]=R.unread_cnt.custom_types[e]})),M=M&&I.ts>0,I.ts=P),M&&Object.keys(this.sb.userEventHandlers).forEach((function(e){t.sb.userEventHandlers[e].onTotalUnreadMessageCountUpdated(I.all,I.custom_types)}))}var H=T.requestId;if(H){var F=O[H];if(F){clearTimeout(F.timer);var G=F.handler;G&&("EROR"===T.command?G(new D(R.message,R.code),null):G(null,T)),O.hasOwnProperty(H)&&delete O[H]}}else switch(A&&"LOGI"!==T.command&&A.refreshTimer(),T.command){case"LOGI":this.sb.loginTimer&&(clearTimeout(this.sb.loginTimer),this.sb.loginTimer=null,this.sb.onLoginTimerCancel=null,R.hasOwnProperty("error")?(this.sb.isSessionOpened=!1,this.sb.loginHandler(new D(R.message,R.code),null)):(this.sb.isSessionOpened=!0,R.hasOwnProperty("key")&&(k.sessionKey=R.key),R.hasOwnProperty("ekey")&&(k.eKey=R.ekey),R.hasOwnProperty("user_id")&&(this.sb.currentUser=new r(R)),"number"==typeof R.ping_interval&&R.ping_interval>0&&b.set("pingInterval",1e3*R.ping_interval),"number"==typeof R.pong_timeout&&R.pong_timeout>0&&b.set("pongTimeout",1e3*R.pong_timeout),"number"==typeof R.login_ts&&b.set("connectedAt",1e3*R.login_ts),"number"==typeof R.max_unread_cnt_on_super_group?b.set("maxUnreadCountOfSuperGroupChannel",R.max_unread_cnt_on_super_group):b.set("maxUnreadCountOfSuperGroupChannel",w.DEFAULT_MAX_UNREAD_COUNT_OF_SUPER_GROUP_CHANNEL),R.profile_image_encryption&&b.set("profileImageEncryption",!0),A&&A.start(),R.hasOwnProperty("file_upload_size_limit")&&R.hasOwnProperty("premium_feature_list")&&R.hasOwnProperty("emoji_hash")&&b.set("appInfo",new fe(R)),this.sb.loginHandler(null,this.sb.currentUser)),this.sb.connecting=!1,this.sb.reconnecting=!1);break;case"EXPR":R.hasOwnProperty("expires_in")&&"number"==typeof R.expires_in&&R.expires_in>0&&U.refresh((function(){}));break;case"MESG":case"FILE":case"BRDM":case"ADMM":var x=null;if("MESG"===T.command?x=new c(R):"FILE"===T.command?x=new p(R):"BRDM"!==T.command&&"ADMM"!==T.command||(x=new f(R)),x){var j=this.sb.currentUser?this.sb.currentUser.userId:null,B=x.silent,q=!!R.force_update_last_message,z=x._sender&&x._sender.userId===j;if(x.isGroupChannel()){var Y=l.cachedChannels.hasOwnProperty(x.channelUrl);l.getChannel(x.channelUrl,w.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}if(!n){if(!b.container.appInfo.isSupergroupMackDisabled||!e.isSuper||e.isBroadcast){var s=i.bMessageAck({channelUrl:x.channelUrl,messageId:x.messageId});t.sb.sendCommand(s)}if(e.isHidden=!1,e.hiddenState=l.HiddenState.UNHIDDEN,l.cachedChannels[e.url]=e,x._sender&&e.memberMap.hasOwnProperty(x._sender.userId)){var a=e.memberMap[x._sender.userId];a.nickname!==x._sender.nickname&&(a.nickname=x._sender.nickname),a.plainProfileUrl!==x._sender.plainProfileUrl&&(a.plainProfileUrl=x._sender.plainProfileUrl),ee.deepEqual(a.metaData,x._sender.metaData)||(a.metaData=x._sender.metaData),a.isBlockedByMe!==x._sender.isBlockedByMe&&(a.isBlockedByMe=x._sender.isBlockedByMe)}var o=t.sb.currentUser;o&&z&&(o.nickname!==x._sender.nickname&&(o.nickname=x._sender.nickname),o.plainProfileUrl!==x._sender.plainProfileUrl&&(o.plainProfileUrl=x._sender.plainProfileUrl),ee.deepEqual(o.metaData,x._sender.metaData)||(o.metaData=x._sender.metaData));var u=!1;if(x.mentionType===g.MentionType.CHANNEL)z||(u=!0);else if(x.mentionType===g.MentionType.USERS)for(var c=0;c<x.mentionedUsers.length;c++)if(!z&&x.mentionedUsers[c].userId===j){u=!0;break}B&&!z||(e.isEphemeral||Y)&&((!e.lastMessage||e.lastMessage.createdAt<x.createdAt)&&(e.lastMessage=x),z||e._setGroupChannelUnreadCount(e.unreadMessageCount+1,e.unreadMentionCount+(u?1:0))),q&&(!e.lastMessage||e.lastMessage.createdAt<x.createdAt)&&(e.lastMessage=x),B&&!z||Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onChannelChanged(e)})),Object.keys(t.sb.channelHandlers).forEach((function(n){var i=t.sb.channelHandlers[n];i.onMessageReceived(e,x),u&&i.onMentionReceived(e,x)}))}}))}else x.isOpenChannel()&&u.getChannel(x.channelUrl,w.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var i=[e,n];n=i[0],e=i[1]}if(!n){var r=!1;if(x.mentionType===g.MentionType.CHANNEL)r=!0;else if(x.mentionType===g.MentionType.USERS)for(var s=0;s<x.mentionedUsers.length;s++)if(x.mentionedUsers[s].userId===j){r=!0;break}Object.keys(t.sb.channelHandlers).forEach((function(n){var i=t.sb.channelHandlers[n];u.enteredChannels[e.url]&&i.onMessageReceived(e,x),r&&i.onMentionReceived(e,x)}))}}))}break;case"MEDI":case"FEDI":case"AEDI":var V=null;if("MEDI"===T.command?V=new c(R):"FEDI"===T.command?V=new p(R):"AEDI"===T.command&&(V=new f(R)),V){var K=this.sb.currentUser?this.sb.currentUser.userId:null,Q=V.silent,J=V.sender&&V.sender.userId===K;if(V.isGroupChannel()){var $=l.cachedChannels.hasOwnProperty(V.channelUrl);l.getChannel(V.channelUrl,w.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var i=[e,n];n=i[0],e=i[1]}if(!n){var r=e.cachedReadReceiptStatus[K],s=r&&r>=V.createAt,a=t.sb.currentUser;a&&J&&(a.nickname!==V._sender.nickname&&(a.nickname=V._sender.nickname),a.plainProfileUrl!==V._sender.plainProfileUrl&&(a.plainProfileUrl=V._sender.plainProfileUrl),ee.deepEqual(a.metaData,V._sender.metaData)||(a.metaData=V._sender.metaData));var o=!1,l=!1;if(!J&&!s&&R&&R.hasOwnProperty("old_values")){var u=R.old_values.mention_type||V.mentionType,c=R.old_values.mentioned_user_ids||V.mentionedUsers.map((function(e){return e.userId}));if(u===g.MentionType.USERS&&V.mentionType===g.MentionType.USERS){for(var d=!1,h=!1,p=0;p<c.length;p++)if(c[p]===K){d=!0;break}for(var f=0;f<V.mentionedUsers.length;f++)if(V.mentionedUsers[f].userId===K){h=!0;break}!d&&h&&(l=!0,!Q&&$&&(e._setGroupChannelUnreadCount(e.unreadMessageCount,e.unreadMentionCount+1),o=!0))}else if(u===g.MentionType.USERS&&V.mentionType===g.MentionType.CHANNEL){for(var y=!1,m=0;m<c.length;m++)if(c[m]===K){y=!0;break}y||(l=!0,!Q&&$&&(e._setGroupChannelUnreadCount(e.unreadMessageCount,e.unreadMentionCount+1),o=!0))}}e.lastMessage?e.lastMessage.createdAt<V.createdAt?(e.lastMessage=V,o=!0):e.lastMessage.createdAt===V.createdAt&&e.lastMessage.messageId===V.messageId&&($?e.lastMessage.updatedAt<V.updatedAt&&(e.lastMessage=V,o=!0):o=!0):(e.lastMessage=V,o=!0),Q&&!J||!o||Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onChannelChanged(e)})),Object.keys(t.sb.channelHandlers).forEach((function(n){var i=t.sb.channelHandlers[n];i.onMessageUpdated(e,V),l&&i.onMentionReceived(e,V)}))}}))}else V.isOpenChannel()&&u.getChannel(V.channelUrl,w.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var i=[e,n];n=i[0],e=i[1]}n||Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onMessageUpdated(e,V)}))}))}break;case"DELM":var X=String(R.channel_type),Z=String(R.channel_url),te=parseInt(R.msg_id);switch(X){case o.CHANNEL_TYPE_GROUP:l.getChannel(Z,w.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var i=[e,n];n=i[0],e=i[1]}n?W.debug("Discard command:","`".concat(T.command,"`")):Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onMessageDeleted(e,te)}))}));break;case o.CHANNEL_TYPE_OPEN:u.getChannel(Z,w.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var i=[e,n];n=i[0],e=i[1]}n?W.debug("Discard command:","`".concat(T.command,"`")):Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onMessageDeleted(e,te)}))}))}break;case"READ":var ne=new m(R),ie=l.cachedChannels.hasOwnProperty(ne.channelUrl);l.getChannel(ne.channelUrl,w.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var i=[e,n];n=i[0],e=i[1]}n||(ie&&e.updateReadReceipt(ne.reader.userId,ne.timestamp),t.sb.currentUser&&(ne.reader.userId===t.sb.currentUser.userId?ie?(e.unreadMessageCount>0||e.unreadMentionCount>0)&&(e._setGroupChannelUnreadCount(0,0),Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onChannelChanged(e)}))):0!==e.unreadMessageCount&&0!==e.unreadMentionCount||Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onChannelChanged(e)})):Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onReadReceiptUpdated(e)}))))}));break;case"MRCT":var re=String(R.channel_type),se=String(R.channel_url),ae=y.createFromJson(R);switch(re){case o.CHANNEL_TYPE_GROUP:l.getChannel(se,w.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var i=[e,n];n=i[0],e=i[1]}n?W.debug("Discard command:","`".concat(T.command,"`")):Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onReactionUpdated(e,ae)}))}));break;case o.CHANNEL_TYPE_OPEN:u.getChannel(se,w.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var i=[e,n];n=i[0],e=i[1]}n?W.debug("Discard command:","`".concat(T.command,"`")):Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onReactionUpdated(e,ae)}))}))}break;case"DLVR":var oe=String(R.channel_url),le=R.hasOwnProperty("updated")?R.updated:null,ue=l.cachedChannels.hasOwnProperty(oe);l.getChannel(oe,w.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var i=[e,n];n=i[0],e=i[1]}if(!n){var r=!1;Object.keys(le).forEach((function(n){t.sb.currentUser&&n===t.sb.currentUser.userId&&(r=!0),ue&&e.updateDeliveryReceipt(n,parseInt(le[n]))})),l.cachedChannels[e.url]=e,r&&1===Object.keys(le).length||Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onDeliveryReceiptUpdated(e)}))}}));break;case"MTHD":var ce=String(R.channel_url),de=String(R.channel_type),he=_.createFromJson(R);switch(de){case o.CHANNEL_TYPE_GROUP:l.getChannel(ce,w.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var i=[e,n];n=i[0],e=i[1]}n||Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onThreadInfoUpdated(e,he)}))}));break;case o.CHANNEL_TYPE_OPEN:u.getChannel(ce,w.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var i=[e,n];n=i[0],e=i[1]}n||Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onThreadInfoUpdated(e,he)}))}))}break;case"MCNT":if(R.hasOwnProperty("group_channels")&&Array.isArray(R.group_channels)){var pe,ge=[],ye=N(R.group_channels);try{for(ye.s();!(pe=ye.n()).done;){var me=pe.value;if(me){me.hasOwnProperty("joined_member_count")&&me.joined_member_count,me.hasOwnProperty("member_count")&&me.member_count;var _e=l.cachedChannels[me.channel_url];_e&&_e.isBroadcast&&_e.setLatestMemberCount(me.member_count,me.joined_member_count,me.ts)&&ge.push(_e)}}}catch(e){ye.e(e)}finally{ye.f()}ge.length>0&&Object.keys(this.sb.channelHandlers).forEach((function(e){t.sb.channelHandlers[e].onChannelMemberCountChanged(ge)}))}if(R.hasOwnProperty("open_channels")&&Array.isArray(R.open_channels)){var ve,Ee=[],Ce=N(R.open_channels);try{for(Ce.s();!(ve=Ce.n()).done;){var be=ve.value;if(be){be.hasOwnProperty("participant_count")&&be.participant_count;var Se=u.cachedChannels[be.channel_url];Se&&Se.setLatestParticipantCount(be.participant_count,be.ts)&&Ee.push(Se)}}}catch(e){Ce.e(e)}finally{Ce.f()}Ee.length>0&&Object.keys(this.sb.channelHandlers).forEach((function(e){t.sb.channelHandlers[e].onChannelParticipantCountChanged(Ee)}))}break;case"PEDI":var Ae=v.createFromJson(R);Object.keys(this.sb.channelHandlers).forEach((function(e){t.sb.channelHandlers[e].onPollUpdated(Ae)}));break;case"VOTE":var ke=E.createFromJson(R);Object.keys(this.sb.channelHandlers).forEach((function(e){t.sb.channelHandlers[e].onPollVoted(ke)}));break;case"SYEV":var Oe=new Ie(R),Te=R.ts;switch(Oe.category){case Ie.CATEGORY_CHANNEL_JOIN:case Ie.CATEGORY_CHANNEL_LEAVE:l.getChannel(Oe.channelUrl,w.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var i=[e,n];n=i[0],e=i[1]}if(n)W.debug("Discard command:","`".concat(T.command,"`"),Oe.category);else{var a=Oe.data.hasOwnProperty("member_count")?Oe.data.member_count:null,o=Oe.data.hasOwnProperty("joined_member_count")?Oe.data.joined_member_count:null,u=!1;if(Oe.category===Ie.CATEGORY_CHANNEL_JOIN)(Oe.data.hasOwnProperty("users")?Oe.data.users:[Oe.data]).forEach((function(n){e.isSuper||e.isBroadcast?u=e.setLatestMemberCount(a,o,R.ts):(n.state=s.JOINED,e.addMember(new s(n),Te),e.updateJoinedMemberCount());var i=new r(n);t.sb.currentUser&&i.userId===t.sb.currentUser.userId&&(e.myMemberState="joined",l.cachedChannels[e.url]=e),Object.keys(t.sb.channelHandlers).forEach((function(n){var r=t.sb.channelHandlers[n];r.onUserJoined(e,i),e.isBroadcast&&u&&r.onChannelMemberCountChanged([e])}))}));else{var c=new r(Oe.data);t.sb.currentUser&&c.userId===t.sb.currentUser.userId?(e.isPublic||l.removeCachedChannel(Oe.channelUrl),e.myMemberState="none",e.invitedAt=0,e.joinedAt=0,e._setGroupChannelUnreadCount(0,0)):l.cachedChannels[e.url]=e,e.isSuper||e.isBroadcast?u=e.setLatestMemberCount(a,o,R.ts):(e.removeMember(c),e.updateJoinedMemberCount()),Object.keys(t.sb.channelHandlers).forEach((function(n){var i=t.sb.channelHandlers[n];i.onUserLeft(e,c),e.isBroadcast&&u&&i.onChannelMemberCountChanged([e])}))}}}));break;case Ie.CATEGORY_CHANNEL_OPERATOR_UPDATE:Oe.isGroupChannel()?l.getChannel(Oe.channelUrl,w.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var i=[e,n];n=i[0],e=i[1]}if(n)W.debug("Discard command:","`".concat(T.command,"`"),Oe.category);else{for(var s=Oe.data.operators.map((function(e){return new r(e)})),a=s.map((function(e){return e.userId})),o=0;o<e.members.length;o++)e.members[o].role=a.indexOf(e.members[o].userId)>=0?l.Role.OPERATOR:l.Role.NONE;e.myRole=t.sb.currentUser&&a.indexOf(t.sb.currentUser.userId)>=0?l.Role.OPERATOR:l.Role.NONE,Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onOperatorUpdated(e,s)}))}})):Oe.isOpenChannel()&&u.getChannel(Oe.channelUrl,w.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var i=[e,n];n=i[0],e=i[1]}n?W.debug("Discard command:","`".concat(T.command,"`"),Oe.category):(e.operators=Oe.data.operators.map((function(e){return new r(e)})),Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onOperatorUpdated(e,e.operators)})))}));break;case Ie.CATEGORY_CHANNEL_INVITE:l.getChannel(Oe.channelUrl,w.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var i=[e,n];n=i[0],e=i[1]}if(n)W.debug("Discard command:","`".concat(T.command,"`"),Oe.category);else{var a=null;Oe.data&&Oe.data.inviter&&Object.keys(Oe.data.inviter).length>0&&(a=new r(Oe.data.inviter));for(var o=[],u=0;u<Oe.data.invitees.length;u++){var c=new r(Oe.data.invitees[u]);o.push(c),Oe.data.invitees[u].state=s.INVITED;var d=new s(Oe.data.invitees[u]);if(e.isSuper||e.isBroadcast){var h=Oe.data.hasOwnProperty("member_count")?Oe.data.member_count:null,p=Oe.data.hasOwnProperty("joined_member_count")?Oe.data.joined_member_count:null;e.setLatestMemberCount(h,p,R.ts)}else e.addMember(d,Te);t.sb.currentUser&&d.userId===t.sb.currentUser.userId&&(e.isHidden=!1,"joined"!==e.myMemberState&&(e.myMemberState="invited"),e.invitedAt=R.ts,l.cachedChannels[e.url]=e)}Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onUserReceivedInvitation(e,a,o)}))}}));break;case Ie.CATEGORY_CHANNEL_DECLINE_INVITE:l.getChannel(Oe.channelUrl,w.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var i=[e,n];n=i[0],e=i[1]}if(n)W.debug("Discard command:","`".concat(T.command,"`"),Oe.category);else{var s=null;Oe.data&&Oe.data.inviter&&Object.keys(Oe.data.inviter).length>0&&(s=new r(Oe.data.inviter));var a=new r(Oe.data.invitee);if(t.sb.currentUser&&a.userId===t.sb.currentUser.userId&&(e.invitedAt=0,e.myMemberState="none",e.isPublic||l.removeCachedChannel(Oe.channelUrl)),e.isSuper||e.isBroadcast){var o=Oe.data.hasOwnProperty("member_count")?Oe.data.member_count:null,u=Oe.data.hasOwnProperty("joined_member_count")?Oe.data.joined_member_count:null;e.setLatestMemberCount(o,u,R.ts)}else e.removeMember(a);t.sb.currentUser&&a.userId!==t.sb.currentUser.userId&&(l.cachedChannels[e.url]=e),Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onUserDeclinedInvitation(e,s,a)}))}}));break;case Ie.CATEGORY_TYPING_START:case Ie.CATEGORY_TYPING_END:l.getChannel(Oe.channelUrl,w.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var i=[e,n];n=i[0],e=i[1]}if(n)W.debug("Discard command:","`".concat(T.command,"`"),Oe.category);else{var s=new r(Oe.data);Oe.category===Ie.CATEGORY_TYPING_START?e.updateTypingStatus(s,!0):e.updateTypingStatus(s,!1),Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onTypingStatusUpdated(e)}))}}));break;case Ie.CATEGORY_CHANNEL_ENTER:case Ie.CATEGORY_CHANNEL_EXIT:u.getChannel(Oe.channelUrl,w.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var i=[e,n];n=i[0],e=i[1]}if(n)W.debug("Discard command:","`".concat(T.command,"`"),Oe.category);else{var s=Oe.data.hasOwnProperty("participant_count")?Oe.data.participant_count:null,a=e.setLatestParticipantCount(s,R.ts),o=new r(Oe.data);Oe.category===Ie.CATEGORY_CHANNEL_ENTER?Object.keys(t.sb.channelHandlers).forEach((function(n){var i=t.sb.channelHandlers[n];i.onUserEntered(e,o),a&&i.onChannelParticipantCountChanged([e])})):Object.keys(t.sb.channelHandlers).forEach((function(n){var i=t.sb.channelHandlers[n];i.onUserExited(e,o),a&&i.onChannelParticipantCountChanged([e])}))}}));break;case Ie.CATEGORY_USER_CHANNEL_MUTE:case Ie.CATEGORY_USER_CHANNEL_UNMUTE:var Re=Oe.category===Ie.CATEGORY_USER_CHANNEL_MUTE,Ne=d({},Oe.data);Re&&(Ne.restriction_type=a.RestrictionType.MUTED);var we=Re?new a(Ne):new r(Oe.data),Me=Re?"muted":"unmuted";Oe.isOpenChannel()?u.getChannel(Oe.channelUrl,w.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var i=[e,n];n=i[0],e=i[1]}n?W.debug("Discard command:","`".concat(T.command,"`"),Oe.category):Re?Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onUserMuted(e,we)})):Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onUserUnmuted(e,we)}))})):l.getChannel(Oe.channelUrl,w.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var i=[e,n];n=i[0],e=i[1]}n?W.debug("Discard command:","`".concat(T.command,"`"),Oe.category):(t.sb.currentUser&&we.userId===t.sb.currentUser.userId&&(e.myMutedState=Me),Array.isArray(e.members)&&e.members.filter((function(e){return e&&e.userId===we.userId})).forEach((function(e){e.isMuted=Re,e.restrictionInfo=new C(Ne)})),Re?Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onUserMuted(e,we)})):Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onUserUnmuted(e,we)})))}));break;case Ie.CATEGORY_USER_CHANNEL_BAN:case Ie.CATEGORY_USER_CHANNEL_UNBAN:var Pe=Oe.category===Ie.CATEGORY_USER_CHANNEL_BAN,Le=d({},Oe.data);Pe&&(Le.restriction_type=a.RestrictionType.BANNED);var De=Pe?new a(Le):new r(Oe.data);Oe.isOpenChannel()?u.getChannel(Oe.channelUrl,w.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var i=[e,n];n=i[0],e=i[1]}n?W.debug("Discard command:","`".concat(T.command,"`"),Oe.category):Pe?(t.sb.currentUser&&De.userId===t.sb.currentUser.userId&&(delete u.enteredChannels[Oe.channelUrl],t.cls.FileMessageQueue.delete(Oe.channelUrl)),Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onUserBanned(e,De)}))):Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onUserUnbanned(e,De)}))})):l.getChannel(Oe.channelUrl,w.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var i=[e,n];n=i[0],e=i[1]}if(n)W.debug("Discard command:","`".concat(T.command,"`"),Oe.category);else if(Pe){if(t.sb.currentUser&&De.userId===t.sb.currentUser.userId&&(e.isPublic||l.removeCachedChannel(Oe.channelUrl),e.myMemberState="none",e.invitedAt=0,e.joinedAt=0,e._setGroupChannelUnreadCount(0,0)),e.isSuper||e.isBroadcast){var r=Oe.data.hasOwnProperty("member_count")?Oe.data.member_count:null,s=Oe.data.hasOwnProperty("joined_member_count")?Oe.data.joined_member_count:null;e.setLatestMemberCount(r,s,R.ts)}else e.removeMember(De),e.updateJoinedMemberCount();Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onUserBanned(e,De)}))}else Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onUserUnbanned(e,De)}))}));break;case Ie.CATEGORY_CHANNEL_FREEZE:case Ie.CATEGORY_CHANNEL_UNFREEZE:Oe.isOpenChannel()?u.getChannel(Oe.channelUrl,w.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var i=[e,n];n=i[0],e=i[1]}n?W.debug("Discard command:","`".concat(T.command,"`"),Oe.category):(e.isFrozen=Oe.data.freeze,u.cachedChannels[e.url]=e,Oe.category===Ie.CATEGORY_CHANNEL_FREEZE?Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onChannelFrozen(e)})):Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onChannelUnfrozen(e)})))})):l.getChannel(Oe.channelUrl,w.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var i=[e,n];n=i[0],e=i[1]}n?W.debug("Discard command:","`".concat(T.command,"`"),Oe.category):(e.isFrozen=Oe.data.freeze,l.cachedChannels[e.url]=e,Oe.category===Ie.CATEGORY_CHANNEL_FREEZE?Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onChannelFrozen(e)})):Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onChannelUnfrozen(e)})))}));break;case Ie.CATEGORY_CHANNEL_DELETED:Oe.isGroupChannel()?l.removeCachedChannel(Oe.channelUrl):u.removeCachedChannel(Oe.channelUrl),Object.keys(this.sb.channelHandlers).forEach((function(e){t.sb.channelHandlers[e].onChannelDeleted(Oe.channelUrl,Oe.isGroupChannel()?"group":"open")}));break;case Ie.CATEGORY_CHANNEL_PROP_CHANGED:Oe.isOpenChannel()?u.getChannelWithoutCache(Oe.channelUrl,(function(e,n){if(t.sb.getErrorFirstCallback()){var i=[e,n];n=i[0],e=i[1]}n?W.debug("Discard command:","`".concat(T.command,"`"),Oe.category):Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onChannelChanged(e)}))})):l.getChannelWithoutCache(Oe.channelUrl,(function(e,n){if(t.sb.getErrorFirstCallback()){var i=[e,n];n=i[0],e=i[1]}if(n)W.debug("Discard command:","`".concat(T.command,"`"),Oe.category);else{var r=e.unreadMessageCount,s=e.unreadMentionCount;e.myCountPreference!==l.CountPreference.ALL&&(e.myCountPreference===l.CountPreference.UNREAD_MESSAGE_COUNT_ONLY?s=0:e.myCountPreference===l.CountPreference.UNREAD_MENTION_COUNT_ONLY?r=0:(r=0,s=0)),e._setGroupChannelUnreadCount(r,s),Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onChannelChanged(e)}))}}));break;case Ie.CATEGORY_CHANNEL_META_DATA_CHANGED:case Ie.CATEGORY_CHANNEL_META_COUNTERS_CHANGED:var He=Oe.data.hasOwnProperty("created"),Fe=Oe.data.hasOwnProperty("updated"),Ge=Oe.data.hasOwnProperty("deleted");(Oe.isOpenChannel()?u.getChannel(Oe.channelUrl,w.INTERNAL_CALL):l.getChannel(Oe.channelUrl,w.INTERNAL_CALL)).then((function(e){var n=Oe.data.created,i=Oe.data.updated,r=Oe.data.deleted,s=R.ts;He&&e._addOrUpdateCachedMetaData(n,s),Fe&&e._addOrUpdateCachedMetaData(i,s),Ge&&e._markAsDeletedCachedMetaData(r,s),Object.keys(t.sb.channelHandlers).forEach((function(s){var a=t.sb.channelHandlers[s];Oe.category===Ie.CATEGORY_CHANNEL_META_DATA_CHANGED?(He&&a.onMetaDataCreated(e,n),Fe&&a.onMetaDataUpdated(e,i),Ge&&a.onMetaDataDeleted(e,r)):(He&&a.onMetaCountersCreated(e,n),Fe&&a.onMetaCountersUpdated(e,i),Ge&&a.onMetaCountersDeleted(e,r))}))})).catch((function(e){return W.debug("Discard command:","`".concat(T.command,"`"),Oe.category)}));break;case Ie.CATEGORY_CHANNEL_HIDE:case Ie.CATEGORY_CHANNEL_UNHIDE:l.getChannel(Oe.channelUrl,w.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var i=[e,n];n=i[0],e=i[1]}n?W.debug("Discard command:","`".concat(T.command,"`"),Oe.category):Oe.category===Ie.CATEGORY_CHANNEL_HIDE?(e.isHidden=!0,Oe.data&&(Oe.data.hasOwnProperty("allow_auto_unhide")&&(e.hiddenState=Oe.data.allow_auto_unhide?l.HiddenState.HIDDEN_ALLOW_AUTO_UNHIDE:l.HiddenState.HIDDEN_PREVENT_AUTO_UNHIDE),Oe.data.hasOwnProperty("hide_previous_messages")&&Oe.data.hide_previous_messages&&e._setGroupChannelUnreadCount(0,0)),R.hasOwnProperty("ts_message_offset")&&(e._messageOffsetTimestamp=R.ts_message_offset),l.cachedChannels[e.url]=e,Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onChannelHidden(e)}))):(e.isHidden=!1,e.hiddenState=l.HiddenState.UNHIDDEN,l.cachedChannels[e.url]=e,Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onChannelChanged(e)})))}))}break;case"USEV":var xe=new Ie(R);switch(xe.category){case Ue.CATEGORY_USER_BLOCK:case Ue.CATEGORY_USER_UNBLOCK:var je=xe.data.blocker.user_id,Be=xe.data.blockee.user_id;Object.keys(l.cachedChannels).forEach((function(e){var n=l.cachedChannels[e];try{t.sb.currentUser&&(t.sb.currentUser.userId===je?n.memberMap[Be].isBlockedByMe=xe.category===Ue.CATEGORY_USER_BLOCK:t.sb.currentUser.userId===Be&&(n.memberMap[je].isBlockingMe=xe.category===Ue.CATEGORY_USER_BLOCK))}catch(e){}}));break;case Ue.CATEGORY_FRIEND_DISCOVERED:var qe=xe.data.friend_discoveries.map((function(e){return new r(e)}));Object.keys(this.sb.userEventHandlers).forEach((function(e){t.sb.userEventHandlers[e].onFriendsDiscovered(qe)}))}break;case"LEAV":case"JOIN":case"PONG":case"MTIO":case"TPST":case"TPEN":break;default:W.debug("Discard command:","`".concat(T.command,"`"))}}}]),e}(),Te={},Re={},Ne=function(){function e(t){p(this,e),this.channel=t,this.uploadQueue=[],this.messageQueue=[],this.latestTimestampToSendMessage=0,G.get(this._iid).FileMessageQueue.queueMap[t.url]=this}return g(e,[{key:"_handleMessageQueueUpdated",value:function(e){var t=this;switch(W.debug("`fileMessageQueue` message queue updated:",this.messageQueue),e){case"add":this.uploadQueue.length<6&&this._moveFirstPendingMessageToUploadQueue();break;case"update":case"remove":if(this.messageQueue.length>0){var n=G.get(this._iid).FileMessageQueue,i=this.messageQueue[0];if(i)if(i.state===n.State.UPLOADED){if(i&&i.state===n.State.UPLOADED){for(i.state=n.State.SENDING,0===this.latestTimestampToSendMessage&&(this.latestTimestampToSendMessage=(new Date).getTime()-200);(new Date).getTime()-this.latestTimestampToSendMessage<200;);this.latestTimestampToSendMessage=(new Date).getTime(),this._sendUploadedMessage(i,(function(e,r){i.state=n.State.SENT,i.error=e||null,i.response=r||null,t._handleMessageQueueUpdated("update")}))}}else i.state===n.State.SENT&&this._finalizeMessage()}}}},{key:"_handleUploadQueueUpdated",value:function(e,t){var n=this;switch(W.debug("`fileMessageQueue` upload queue updated:",this.uploadQueue),e){case"add":var i=G.get(this._iid).FileMessageQueue;t.state=i.State.UPLOADING,t.error?(this.messageQueue.map((function(e){return e.requestId})).indexOf(t.requestId)>-1&&(t.state=i.State.SENT,this._handleMessageQueueUpdated("update")),this._finalizeUpload(t.requestId)):this._uploadFile(t,(function(e){t.error&&t.state===i.State.SENT||(t.state=i.State.UPLOADED),t.fileInfo=e,n._handleMessageQueueUpdated("update"),n._finalizeUpload(t.requestId)}));break;case"update":break;case"remove":this.uploadQueue.length<6&&this._moveFirstPendingMessageToUploadQueue()}}},{key:"_moveFirstPendingMessageToUploadQueue",value:function(){var e=G.get(this._iid).FileMessageQueue,t=this.messageQueue.filter((function(t){return t.state===e.State.PENDING}));if(t.length>0){var n=t[0];this.uploadQueue.push(n),this._handleUploadQueueUpdated("add",n)}}},{key:"_sendUploadedMessage",value:function(e,t){var n=G.get(this._iid),i=n.Command,r=n.FileMessage,s=e.fileInfo,a=i.bFile(d(d({},s),{},{requestId:e.requestId,channelUrl:this.channel.url,url:s.file,metaArrays:s.metaArrays})),o=fn.getInstance(this._iid),l=L.get(this._iid);o.getConnectionState()===o.ConnectionState.OPEN||!o.currentUser||o.connecting||o.reconnecting?o.sendCommand(a,(function(e,n){if(o.getErrorFirstCallback()){var i=[e,n];n=i[0],e=i[1]}if(n){var l=new r(a.getJsonElement());l.requestedMentionUserIds=s.mentionedUserIds,t(n,l)}else{var u=new r(e.getJsonElement());t(null,u)}})):l.container.apiClient.sendFileMessage(d(d({channelUrl:this.channel.url,isOpenChannel:this.channel.isOpenChannel()},s),{},{fileUrl:s.file,fileName:s.name,fileSize:s.size,fileType:s.type,metaArrays:s.metaArrays}),(function(e,n){var i=new r(e?a.getJsonElement():n);e&&(i.requestedMentionUserIds=s.mentionedUserIds),t(e,i)}))}},{key:"_uploadFile",value:function(e,t){var n=e.fileInfo,i=e.pendingMessage;if("string"!=typeof n.file&&n.file){var r=G.get(this._iid).FileMessageQueue;L.get(this._iid).container.apiClient.uploadFile(d(d({},n),{},{fileType:n.type,channelUrl:this.channel.url,reqId:i?i.reqId:null}),(function(i,s){if(i)e.state=r.State.SENT,e.error=i,e.response=null,t(n);else{var a="object"===h(s)?s:JSON.parse(s);n.file=a.url,n.thumbnailSizes=a.hasOwnProperty("thumbnails")?a.thumbnails:[],n.requireAuth=!!a.hasOwnProperty("require_auth")&&a.require_auth,n.size=a.hasOwnProperty("file_size")?a.file_size:n.size,t(n)}}))}else n.thumbnailSizes=[],n.requireAuth=!1,t(n)}},{key:"_finalizeUpload",value:function(e){var t=this.uploadQueue.map((function(e){return e.requestId})).indexOf(e);if(t>-1){var n=this.uploadQueue.splice(t,1);n.length>0&&this._handleUploadQueueUpdated("remove",n[0])}}},{key:"_finalizeMessage",value:function(){var e=this,t=L.get(this._iid).container.isErrorFirstInCallback,n=fn.getInstance(this._iid),i=G.get(this._iid).FileMessageQueue,r=this.messageQueue[0];if(r&&r.state===i.State.SENT){r.state=i.State.DONE;var s=r.response,a=r.error,o=r.fileInfo.callback;if(s&&!a){var l=n.currentUser;return l&&s._sender&&l.userId===s._sender.userId&&(l.nickname!==s._sender.nickname&&(l.nickname=s._sender.nickname),l.plainProfileUrl!==s._sender.plainProfileUrl&&(l.plainProfileUrl=s._sender.plainProfileUrl)),this.channel.isGroupChannel()&&(this.channel.lastMessage=s,Object.keys(n.channelHandlers).forEach((function(t){n.channelHandlers[t].onChannelChanged(e.channel)}))),t?o(null,s):o(s,null),this.messageQueue.shift(),void this._handleMessageQueueUpdated("remove")}a&&(s=r.pendingMessage)&&(a.code!==D.INVALID_PARAMETER?(s.requestState=n.MessageRequestState.FAILED,s.sendingStatus=n.MessageSendingStatus.FAILED,a.code!==D.FILE_UPLOAD_CANCEL_FAILED&&a.code!==D.REQUEST_CANCELED||(s.sendingStatus=n.MessageSendingStatus.CANCELED),s.requestedMentionUserIds=r.fileInfo.mentionedUserIds,s.errorCode=a.code):s=null),t?o(a,s):o(s,a),this.messageQueue.shift(),this._handleMessageQueueUpdated("remove")}}},{key:"addJob",value:function(e){this.messageQueue.push(e),this._handleMessageQueueUpdated("add")}},{key:"cancelUploadItemByRequestId",value:function(e,t){this._finalizeUpload(e);var n=this.messageQueue.map((function(e){return e.requestId})).indexOf(e);if(n>-1){var i=G.get(this._iid).FileMessageQueue,r=this.messageQueue[n];!r||r.state!==i.State.UPLOADING&&r.state!==i.State.PENDING||(r.state=i.State.SENT,r.response=null,r.error=new D("Uploading has been completed or canceled.",D.FILE_UPLOAD_CANCEL_FAILED),this._handleMessageQueueUpdated("update"));var s=i.uploadRequest[e];if(s)return"function"==typeof s.abort?s.abort():"function"==typeof s.cancel&&s.cancel("Upload has been canceled."),t(null,!0),!0;t(new D("Uploading has been completed or canceled.",D.FILE_UPLOAD_CANCEL_FAILED),!1)}else t(new D("Uploading has been completed or canceled.",D.FILE_UPLOAD_CANCEL_FAILED),!1);return!1}}],[{key:"State",get:function(){return{PENDING:"pending",UPLOADING:"uploading",UPLOADED:"uploaded",SENDING:"sending",SENT:"sent",DONE:"done"}}},{key:"getByChannelUrl",value:function(e){return G.get(this._iid).FileMessageQueue.queueMap[e]}},{key:"create",value:function(e){var t=G.get(this._iid).FileMessageQueue;return t.queueMap.hasOwnProperty(e.url)||(t.queueMap[e.url]=new t(e)),t.queueMap[e.url]}},{key:"delete",value:function(e){var t=G.get(this._iid).FileMessageQueue;t.queueMap.hasOwnProperty(e)&&delete t.queueMap[e]}},{key:"clear",value:function(){Re[this._iid]={}}},{key:"queueMap",get:function(){return Re[this._iid]||(Re[this._iid]={}),Re[this._iid]}},{key:"uploadRequest",get:function(){return Te[this._iid]||(Te[this._iid]={}),Te[this._iid]}}]),e}();Ne.Job=function e(t){var n=t.fileInfo,i=t.requestId,r=t.pendingMessage,s=t.state,a=t.error,o=void 0===a?null:a,l=t.response,u=void 0===l?null:l;p(this,e),this.fileInfo=n,this.requestId=i,this.pendingMessage=r,this.state=s||Ne.State.PENDING,this.error=o,this.response=u};var we=function(){function e(){p(this,e)}return g(e,null,[{key:"create",value:function(){return"".concat(parseInt(1e5*Math.random()),"-").concat((new Date).getTime())}}]),e}(),Me={},Pe={},Le=new WeakMap,De=new WeakMap,He=new WeakMap,Fe=function(e){m(n,e);var t=k(n);function n(e){var i;return p(this,n),(i=t.call(this,e)).channelType=ke.CHANNEL_TYPE_GROUP,i.isDistinct=!1,i.isSuper=!1,i.isBroadcast=!1,i.isPublic=!1,i.unreadMessageCount=0,i.inviter=null,i.members=[],i.memberMap={},i.lastMessage=null,i.memberCount=0,i.joinedMemberCount=0,i.cachedReadReceiptStatus={},i.cachedDeliveryReceiptStatus=null,i.myPushTriggerOption=n.PushTriggerOption.DEFAULT,i.isPushEnabled,i.isHidden=!1,i.hiddenState=n.HiddenState.UNHIDDEN,i.isDiscoverable=!0,i.myLastRead=0,i.messageSurvivalSeconds=-1,i.invitedAt=0,i.joinedAt=0,i._messageOffsetTimestamp=0,i._cachedLastDeliveredReceipt={sentAt:0,timeout:null},Le.set(S(i),{}),De.set(S(i),{start:0,end:0}),He.set(S(i),0),e&&i._update(e),i}return g(n,[{key:"messageOffsetTimestamp",get:function(){return this._messageOffsetTimestamp}},{key:"_setGroupChannelUnreadCount",value:function(e,t){try{if("number"==typeof e&&e>=0)if("all"===this.myCountPreference||"unread_message_count_only"===this.myCountPreference)if(this.isSuper||this.isBroadcast){var n=L.get(this._iid).container.maxUnreadCountOfSuperGroupChannel;this.unreadMessageCount=e>=n?n:e}else this.unreadMessageCount=e;else this.unreadMessageCount=0;"number"==typeof t&&t>=0&&("all"===this.myCountPreference||"unread_mention_count_only"===this.myCountPreference?this.unreadMentionCount=t:this.unreadMentionCount=0)}catch(e){}}},{key:"_update",value:function(e){var t=this,n=G.get(this._iid),i=n.BaseChannel,r=n.GroupChannel,s=n.User,a=n.Member;if(this.isAccessCodeRequired=!!e.is_access_code_required&&e.is_access_code_required,this.isDistinct=!!e.is_distinct&&e.is_distinct,this.isPushEnabled=!!e.is_push_enabled&&e.is_push_enabled,this.isHidden=!!e.hasOwnProperty("is_hidden")&&e.is_hidden,this.myPushTriggerOption=e.push_trigger_option?e.push_trigger_option:r.PushTriggerOption.DEFAULT,this.myCountPreference=e.hasOwnProperty("count_preference")?e.count_preference:r.CountPreference.ALL,this.unreadMessageCount=0,this.unreadMentionCount=0,this._setGroupChannelUnreadCount(parseInt(e.unread_message_count),parseInt(e.unread_mention_count)),e.hasOwnProperty("read_receipt")&&(this.cachedReadReceiptStatus={},Object.keys(e.read_receipt).forEach((function(n){var i=e.read_receipt[n];t.updateReadReceipt(n,parseInt(i))}))),e.hasOwnProperty("delivery_receipt")&&"object"===h(e.delivery_receipt)&&null!==e.delivery_receipt&&(this.cachedDeliveryReceiptStatus||(this.cachedDeliveryReceiptStatus={}),Object.keys(e.delivery_receipt).forEach((function(n){var i=e.delivery_receipt[n];t.updateDeliveryReceipt(n,parseInt(i))}))),e.hasOwnProperty("user_last_read")&&"number"==typeof e.user_last_read?this.myLastRead=e.user_last_read:this.myLastRead=0,e.hasOwnProperty("members")){this.members=[],this.memberMap={};for(var o=0;o<e.members.length;o++){var l=new a(e.members[o]);this.members.push(l),this.memberMap[l.userId]=l}}this.myMemberState=e.member_state||"none",this.myRole=e.my_role||r.Role.NONE,e.hasOwnProperty("is_muted")?"string"==typeof e.is_muted?this.myMutedState=e.is_muted:"boolean"==typeof e.is_muted?this.myMutedState=e.is_muted?"muted":"unmuted":this.myMutedState="unmuted":this.myMutedState="unmuted",e.hasOwnProperty("member_count")&&(this.memberCount=parseInt(e.member_count)),e.hasOwnProperty("joined_member_count")&&(this.joinedMemberCount=parseInt(e.joined_member_count)),e.hasOwnProperty("last_message")&&"object"===h(e.last_message)&&e.last_message?e.last_message instanceof Ce?this.lastMessage=e.last_message:this.lastMessage=i.buildMessage(e.last_message,this):this.lastMessage=null,e.hasOwnProperty("inviter")&&null!==e.inviter&&"object"===h(e.inviter)&&Object.keys(e.inviter).length>0?this.inviter=new s(e.inviter):this.inviter=null,this.invitedAt=e.invited_at||0,this.joinedAt=e.joined_ts||0,e.hasOwnProperty("is_super")&&"boolean"==typeof e.is_super?this.isSuper=e.is_super:this.isSuper=!1,e.hasOwnProperty("is_broadcast")&&"boolean"==typeof e.is_broadcast?this.isBroadcast=e.is_broadcast:this.isBroadcast=!1,e.hasOwnProperty("is_public")&&"boolean"==typeof e.is_public?this.isPublic=e.is_public:this.isPublic=!1,e.hasOwnProperty("hidden_state")?this.hiddenState=e.hidden_state:this.hiddenState=r.HiddenState.UNHIDDEN,e.hasOwnProperty("is_discoverable")&&"boolean"==typeof e.is_discoverable?this.isDiscoverable=e.is_discoverable:this.isDiscoverable=this.isPublic,e.hasOwnProperty("ts_message_offset")&&(this._messageOffsetTimestamp=e.ts_message_offset),e.hasOwnProperty("message_survival_seconds")&&"number"==typeof e.message_survival_seconds&&(this.messageSurvivalSeconds=e.message_survival_seconds)}},{key:"addMember",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!this.isSuper&&!this.isBroadcast){var n=G.get(this._iid),i=n.Member,r=this.removeMember(e);r&&r.state===i.JOINED&&(e.state=i.JOINED),this.memberMap[e.userId]=e,this.members.push(e),this.memberCount++,this.updateReadReceipt(e.userId,t),this.updateDeliveryReceipt(e.userId,t)}}},{key:"removeMember",value:function(e){var t=null;if(!this.isSuper&&!this.isBroadcast&&this.memberMap.hasOwnProperty(e.userId)){delete this.memberMap[e.userId];for(var n=0;n<this.members.length;n++){var i=this.members[n];if(i.userId===e.userId){t=i,this.members.splice(n,1);break}}this.memberCount--}return t}},{key:"parse",value:function(e){this._update(e)}},{key:"update",value:function(e){this.__update(e),this._update(e)}},{key:"isIdentical",value:function(e){return e&&this.url===e.url}},{key:"isEqual",value:function(e){return ee.deepEqual(this,e)}},{key:"createMemberListQuery",value:function(){return new(0,G.get(this._iid).MemberListQuery)(this.url)}},{key:"createBannedUserListQuery",value:function(){return new(0,G.get(this._iid).BannedUserListQuery)({channelUrl:this.url,isOpenChannel:this.isOpenChannel()})}},{key:"refresh",value:function(e){return G.get(this._iid).GroupChannel.getChannelWithoutCache(this.url,e)}},{key:"updateChannel",value:function(){var e=this,t=ae.toArray(arguments),n=void 0;"function"==typeof t[t.length-1]&&(n=t.pop());var i=G.get(this._iid),r=i.GroupChannel,s=i.GroupChannelParams;if(t[0]instanceof s&&1===t.length)return _e(this._iid,(function(n){var i=t[0];i.channelUrl=e.url,i._validate()?L.get(e._iid).container.apiClient.updateGroupChannel(d(d({},i),{},{operatorUserIds:i.operatorUserIds}),(function(e,t){var i=null;e||(i=r.upsert(t)),n(e,i)})):n(ae.error,null)}),n);if(3===t.length){var a=new s;return a.channelUrl=this.url,a.name=t[0],"string"==typeof t[1]?a.coverUrl=t[1]:a.coverImage=t[1],a.data=t[2],this.updateChannel(a,n)}if(4===t.length){var o=new s;return o.channelUrl=this.url,o.isDistinct=t[0],o.name=t[1],"string"==typeof t[1]?o.coverUrl=t[2]:o.coverImage=t[2],o.data=t[3],this.updateChannel(o,n)}if(5===t.length){var l=new s;return l.channelUrl=this.url,l.isDistinct=t[0],l.name=t[1],"string"==typeof t[2]?l.coverUrl=t[2]:l.coverImage=t[2],l.data=t[3],l.customType=t[4],this.updateChannel(l,n)}return _e(this._iid,(function(e){return e(ae.error,null)}),n)}},{key:"invite",value:function(e,t){var n=null,i=ae.parse(arguments,[new ae({type:"array",constraint:function(e){return e.length>0&&e.every((function(e){return!!e.userId&&"string"==typeof e.userId}))}}),new ae({type:"callback"})]),r=U(i,3);return n=r[0],e=r[1],t=r[2],n?_e(this._iid,(function(e){return e(ae.error,null)}),t):this.inviteWithUserIds(e.map((function(e){return e.userId})),t)}},{key:"inviteWithUserIds",value:function(e,t){var n=this,i=null,r=ae.parse(arguments,[new ae({type:"array",constraint:function(e){return e.every((function(e){return"string"==typeof e}))}}),new ae({type:"callback"})]),s=U(r,3);return i=s[0],e=s[1],t=s[2],_e(this._iid,(function(t){i?t(i,null):L.get(n._iid).container.apiClient.inviteToGroupChannel({channelUrl:n.url,userIds:e},(function(e,i){var r=null;e||(r=G.get(n._iid).GroupChannel.upsert(i)),t(e,r)}))}),t)}},{key:"acceptInvitation",value:function(e,t){var n=this,i=null,r=ae.parse(arguments,[new ae({type:"string",optional:!0,defaultValue:null}),new ae({type:"callback"})]),s=U(r,3);return i=s[0],e=s[1],t=s[2],_e(this._iid,(function(t){i?t(i,null):L.get(n._iid).container.apiClient.acceptInvitation({channelUrl:n.url,accessCode:e},(function(e,i){var r=null;e||((r=G.get(n._iid).GroupChannel.upsert(i)).myMemberState="joined"),t(e,r)}))}),t)}},{key:"declineInvitation",value:function(e){var t=this;return _e(this._iid,(function(e){L.get(t._iid).container.apiClient.declineInvitation({channelUrl:t.url},(function(n,i){var r=null;if(!n){var s=G.get(t._iid).GroupChannel;(r=s.upsert(i)).myMemberState="none",t.isPublic||s.removeCachedChannel(t.url)}e(n,r)}))}),e)}},{key:"join",value:function(e,t){var n=this,i=null,r=ae.parse(arguments,[new ae({type:"string",optional:!0,defaultValue:null}),new ae({type:"callback"})]),s=U(r,3);return i=s[0],e=s[1],t=s[2],_e(this._iid,(function(t){i?t(i,null):L.get(n._iid).container.apiClient.joinGroupChannel({channelUrl:n.url,accessCode:e},(function(e,i){var r=null;e||((r=G.get(n._iid).GroupChannel.upsert(i)).myMemberState="joined"),t(e,r)}))}),t)}},{key:"leave",value:function(e){var t=this;return _e(this._iid,(function(e){L.get(t._iid).container.apiClient.leaveGroupChannel({channelUrl:t.url},(function(t,n){return e(t,null)}))}),e)}},{key:"muteUser",value:function(e,t,n,i){return this.muteUserWithUserId(e?e.userId:null,t,n,i)}},{key:"muteUserWithUserId",value:function(e,t,n,i){var r=this,s=null,a=ae.parse(arguments,[new ae({type:"string"}),new ae({type:"number",optional:!0,defaultValue:-1,constraint:function(e){return e>=-1}}),new ae({type:"string",optional:!0,defaultValue:""}),new ae({type:"callback"})]),o=U(a,5);return s=o[0],e=o[1],t=o[2],n=o[3],i=o[4],_e(this._iid,(function(i){s?i(s,null):L.get(r._iid).container.apiClient.muteUser({channelUrl:r.url,userId:e,description:n,seconds:t,isGroupChannel:!0},(function(e,t){i(e,null)}))}),i)}},{key:"unmuteUser",value:function(e,t){return this.unmuteUserWithUserId(e?e.userId:null,t)}},{key:"unmuteUserWithUserId",value:function(e,t){var n=this,i=null,r=ae.parse(arguments,[new ae({type:"string"}),new ae({type:"callback"})]),s=U(r,3);return i=s[0],e=s[1],t=s[2],_e(this._iid,(function(t){i?t(i,null):L.get(n._iid).container.apiClient.unmuteUser({channelUrl:n.url,userId:e,isGroupChannel:!0},(function(e,n){t(e,null)}))}),t)}},{key:"banUser",value:function(e,t,n,i){return this.banUserWithUserId(e?e.userId:null,t,n,i)}},{key:"banUserWithUserId",value:function(e,t,n,i){var r=this,s=null,a=ae.parse(arguments,[new ae({type:"string"}),new ae({type:"number",optional:!0,defaultValue:-1,constraint:function(e){return e>=-1}}),new ae({type:"string"}),new ae({type:"callback"})]),o=U(a,5);return s=o[0],e=o[1],t=o[2],n=o[3],i=o[4],_e(this._iid,(function(i){s?i(s,null):L.get(r._iid).container.apiClient.banUser({channelUrl:r.url,userId:e,description:n,seconds:t,isGroupChannel:!0},(function(e,t){i(e,null)}))}),i)}},{key:"unbanUser",value:function(e,t){return this.unbanUserWithUserId(e?e.userId:null,t)}},{key:"unbanUserWithUserId",value:function(e,t){var n=this,i=null,r=ae.parse(arguments,[new ae({type:"string"}),new ae({type:"callback"})]),s=U(r,3);return i=s[0],e=s[1],t=s[2],_e(this._iid,(function(t){i?t(i,null):L.get(n._iid).container.apiClient.unbanUser({channelUrl:n.url,userId:e,isGroupChannel:!0},(function(e,n){t(e,null)}))}),t)}},{key:"updateJoinedMemberCount",value:function(){if(!this.isSuper&&!this.isBroadcast){var e=G.get(this._iid).Member;this.joinedMemberCount=this.members.filter((function(t){return t.state===e.JOINED})).length}}},{key:"setLatestMemberCount",value:function(e,t,n){var i=!1;return"number"==typeof e&&"number"==typeof t&&"number"==typeof n&&n>=He.get(this)&&(He.set(this,n),i=t!==this.joinedMemberCount||e!==this.memberCount,this.memberCount=e,this.joinedMemberCount=t),i}},{key:"hide",value:function(e,t,n){var i=this,r=null,s=ae.parse(arguments,[new ae({type:"boolean",optional:!0,defaultValue:!1}),new ae({type:"boolean",optional:!0,defaultValue:!0}),new ae({type:"callback"})]),a=U(s,4);return r=a[0],e=a[1],t=a[2],n=a[3],_e(this._iid,(function(n){r?n(r,null):L.get(i._iid).container.apiClient.hideGroupChannel({channelUrl:i.url,hidePreviousMessages:e,allowAutoUnhide:t},(function(r,s){if(!r){var a=G.get(i._iid).GroupChannel;i.isHidden=!0,i.hiddenState=t?a.HiddenState.HIDDEN_ALLOW_AUTO_UNHIDE:a.HiddenState.HIDDEN_PREVENT_AUTO_UNHIDE,e&&i._setGroupChannelUnreadCount(0,0),s.hasOwnProperty("ts_message_offset")&&(i._messageOffsetTimestamp=s.ts_message_offset),a.cachedChannels[i.url]=i}n(r,s)}))}),n)}},{key:"unhide",value:function(e){var t=this;return _e(this._iid,(function(e){L.get(t._iid).container.apiClient.unhideGroupChannel({channelUrl:t.url},(function(n,i){if(!n){var r=G.get(t._iid).GroupChannel;t.isHidden=!1,t.hiddenState=r.HiddenState.UNHIDDEN,r.cachedChannels[t.url]=t}e(n,i)}))}),e)}},{key:"freeze",value:function(e){var t=this;return _e(this._iid,(function(e){L.get(t._iid).container.apiClient.freeze({channelUrl:t.url,isGroupChannel:!0,freezing:!0},(function(n,i){if(!n){var r=G.get(t._iid).GroupChannel;t.isFrozen=!0,r.cachedChannels[t.url]=t}e(n,null)}))}),e)}},{key:"unfreeze",value:function(e){var t=this;return _e(this._iid,(function(e){L.get(t._iid).container.apiClient.freeze({channelUrl:t.url,isGroupChannel:!0,freezing:!1},(function(n,i){if(!n){var r=G.get(t._iid).GroupChannel;t.isFrozen=!1,r.cachedChannels[t.url]=t}e(n,null)}))}),e)}},{key:"delete",value:function(e){var t=this;return _e(this._iid,(function(e){L.get(t._iid).container.apiClient.deleteGroupChannel({channelUrl:t.url},(function(n,i){n||G.get(t._iid).GroupChannel.removeCachedChannel(t.url),e(n,i)}))}),e)}},{key:"markAsRead",value:function(e){var t=this;return _e(this._iid,(function(e){var n=G.get(t._iid).Command,i=fn.getInstance(t._iid),r=n.bRead({channelUrl:t.url});i.sendCommand(r,(function(n,r){if(i.getErrorFirstCallback()){var s=[n,r];r=s[0],n=s[1]}if(r)e(r,null);else if(i.currentUser)t.updateReadReceipt(i.currentUser.userId,n.getJsonElement().ts),(t.unreadMessageCount>0||t.unreadMentionCount>0)&&(t._setGroupChannelUnreadCount(0,0),Object.keys(i.channelHandlers).forEach((function(e){i.channelHandlers[e].onChannelChanged(t)}))),e(null,null);else{var a=new SendBirdException("Connection should be made first.",SendBirdException.CONNECTION_REQUIRED);e(a,null)}}))}),e)}},{key:"getUnreadMemberCount",value:function(e){var t=fn.getInstance(this._iid),n=G.get(this._iid).Member;if(e instanceof Ce&&!e.isAdminMessage()&&t.currentUser&&!this.isSuper&&!this.isBroadcast){for(var i=0,r=e.createdAt,s=this.members,a=0;a<s.length;a++){var o=s[a];t.currentUser.userId===o.userId||o.state!==n.JOINED||e.sender&&e.sender.userId===o.userId||(this.cachedReadReceiptStatus[o.userId]||0)<r&&i++}return i}return 0}},{key:"getReadReceipt",value:function(e){return this.getUnreadMemberCount(e)}},{key:"markAsDelivered",value:function(){var e=this,t=fn.getInstance(this._iid),n=t.currentUser?t.currentUser.userId:null;L.get(this._iid).container.apiClient.markAsDelivered({channelUrl:this.url,userId:n},(function(t,i){if(t)W.debug(t);else{var r=i.hasOwnProperty("ts")?i.ts:0;e.updateDeliveryReceipt(n,r)}}))}},{key:"getUndeliveredMemberCount",value:function(e){var t=fn.getInstance(this._iid),n=G.get(this._iid).Member;if(this.cachedDeliveryReceiptStatus&&e instanceof Ce&&!e.isAdminMessage()&&t.currentUser&&!this.isSuper&&!this.isBroadcast){var i,r=e.createdAt,s=0,a=N(this.members);try{for(a.s();!(i=a.n()).done;){var o=i.value;t.currentUser.userId===o.userId||o.state!==n.JOINED||e.sender&&e.sender.userId===o.userId||this.cachedDeliveryReceiptStatus[o.userId]<r&&s++}}catch(e){a.e(e)}finally{a.f()}return s}return 0}},{key:"getDeliveryReceipt",value:function(e){return this.getUndeliveredMemberCount(e)}},{key:"getReadMembers",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=fn.getInstance(this._iid);if(n.currentUser&&!this.isSuper&&!this.isBroadcast&&e instanceof Ce&&!e.isAdminMessage()){for(var i=[],r=0;r<this.members.length;r++){var s=this.members[r];if(t||s.userId!==n.currentUser.userId&&s.userId!==e.sender.userId){var a=this.cachedReadReceiptStatus[s.userId]||0;a>=e.createdAt&&i.push(s)}}return i}return[]}},{key:"getUnreadMembers",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=fn.getInstance(this._iid);if(n.currentUser&&!this.isSuper&&!this.isBroadcast&&e instanceof Ce&&!e.isAdminMessage()){for(var i=[],r=0;r<this.members.length;r++){var s=this.members[r];if(t||s.userId!==n.currentUser.userId&&s.userId!==e.sender.userId){var a=this.cachedReadReceiptStatus[s.userId]||0;a<e.createdAt&&i.push(s)}}return i}return[]}},{key:"getReadStatus",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=fn.getInstance(this._iid);if(n.currentUser&&!this.isSuper&&!this.isBroadcast){for(var i={},r=Object.keys(this.cachedReadReceiptStatus),s=function(s){var a=r[s];if(!t&&a===n.currentUser.userId)return"continue";var o=e.cachedReadReceiptStatus[a],l=e.members.filter((function(e){return e.userId===a}));i[a]={user:l.length>0?l[0]:null,last_seen_at:parseInt(o)}},a=0;a<r.length;a++)s(a);return i}return{}}},{key:"updateReadReceipt",value:function(e,t){var n=this.cachedReadReceiptStatus[e];if(!n||n<t){this.cachedReadReceiptStatus[e]=t;var i=fn.getInstance(this._iid);i.currentUser&&e===i.currentUser.userId&&(this.myLastRead=t)}}},{key:"updateDeliveryReceipt",value:function(e,t){if(this.cachedDeliveryReceiptStatus)if(this.cachedDeliveryReceiptStatus.hasOwnProperty(e)){var n=this.cachedDeliveryReceiptStatus[e];(!n||n<t)&&(this.cachedDeliveryReceiptStatus[e]=t)}else this.cachedDeliveryReceiptStatus[e]=t}},{key:"startTyping",value:function(){var e=fn.getInstance(this._iid),t=(new Date).getTime(),n=e.Options.typingIndicatorThrottle;("number"!=typeof n||n<1e3||n>9e3)&&(n=1e3);var i=De.get(this);if(t-i.start>=n){i.end=0,i.start=t;var r=G.get(this._iid).Command.bTypeStart({channelUrl:this.url,time:i.start});e.sendCommand(r,null)}}},{key:"endTyping",value:function(){var e=fn.getInstance(this._iid),t=(new Date).getTime(),n=e.Options.typingIndicatorThrottle;("number"!=typeof n||n<1e3||n>9e3)&&(n=1e3);var i=De.get(this);if(t-i.end>=n){i.start=0,i.end=t;var r=G.get(this._iid).Command.bTypeEnd({channelUrl:this.url,time:i.end});e.sendCommand(r,null)}}},{key:"invalidateTypingStatus",value:function(){var e=Le.get(this),t=(new Date).getTime(),n=!1;return Object.keys(e).forEach((function(i){var r=e[i].ts;t-r>=1e4&&(delete e[i],n=!0)})),n}},{key:"getTypingMembers",value:function(){var e=this,t=Le.get(this),n=[];return Object.keys(t).forEach((function(t){var i=e.memberMap[t];i&&n.push(i)})),n}},{key:"getTypingUsers",value:function(){var e=Le.get(this),t=[];return Object.keys(e).forEach((function(n){var i=e[n].user;t.push(i)})),t}},{key:"updateTypingStatus",value:function(e,t){var n=Le.get(this);t?n[e.userId]={user:e,ts:(new Date).getTime()}:delete n[e.userId]}},{key:"isTyping",value:function(){var e=Le.get(this);return 0!==Object.keys(e).length}},{key:"registerScheduledUserMessage",value:function(e,t){var n=this,i=G.get(this._iid),r=i.ScheduledUserMessage,s=i.ScheduledUserMessageParams,a=null,o=ae.parse(arguments,[new ae({type:s,constraint:function(e){return"string"==typeof e.message&&"string"==typeof e._getScheduleString()}}),new ae({type:"callback"})]),l=U(o,3);return a=l[0],e=l[1],t=l[2],_e(this._iid,(function(t){a?t(a,null):L.get(n._iid).container.apiClient.registerScheduledUserMessage({groupChannelParams:e,channelUrl:n.url,isOpenChannel:!1},(function(e,i){var s=null;if(!e){s=new r(i);var a=fn.getInstance(n._iid).currentUser;a&&s._sender&&a.userId===s._sender.userId&&(a.nickname=s._sender.nickname,a.plainProfileUrl=s._sender.plainProfileUrl,a.metaData=s._sender.metaData)}t(e,s)}))}),t)}},{key:"getPushPreference",value:function(e){var t=this;return _e(this._iid,(function(e){L.get(t._iid).container.apiClient.getMyPushTriggerOption({channelUrl:t.url},(function(n,i){var r=null;if(!n){try{r=i.enable}catch(e){r=!1}t.isPushEnabled=r}e&&e(n,r)}))}),e)}},{key:"setPushPreference",value:function(e,t){var n=this;return _e(this._iid,(function(t){var i=G.get(n._iid).GroupChannel;L.get(n._iid).container.apiClient.setMyPushTriggerOption({channelUrl:n.url,enable:e},(function(e,r){e||(n.isPushEnabled=r.enable,n.isPushEnabled||(n.myPushTriggerOption=i.PushTriggerOption.OFF)),t(e,r)}))}),t)}},{key:"getMyPushTriggerOption",value:function(e){var t=this;return _e(this._iid,(function(e){L.get(t._iid).container.apiClient.getMyPushTriggerOption({channelUrl:t.url},(function(i,r){var s=null;if(!i){try{s=r.push_trigger_option||n.PushTriggerOption.DEFAULT}catch(e){W.debug(e)}t.myPushTriggerOption=s}e(i,s)}))}),e)}},{key:"setMyPushTriggerOption",value:function(e,t){var n=this,i=G.get(this._iid),r=i.GroupChannel,s=null,a=ae.parse(arguments,[new ae({type:r.PushTriggerOption}),new ae({type:"callback"})]),o=U(a,3);return s=o[0],e=o[1],t=o[2],_e(this._iid,(function(t){s?t(s,null):L.get(n._iid).container.apiClient.setMyPushTriggerOption({channelUrl:n.url,pushTriggerOption:e},(function(e,i){var r=null;if(!e){try{r=i.push_trigger_option}catch(e){W.debug(e)}n.myPushTriggerOption=r}t(e,r)}))}),t)}},{key:"setMyCountPreference",value:function(e,t){var n=this,i=G.get(this._iid),r=i.GroupChannel,s=null,a=ae.parse(arguments,[new ae({type:r.CountPreference}),new ae({type:"callback"})]),o=U(a,3);return s=o[0],e=o[1],t=o[2],_e(this._iid,(function(t){s?t(s,null):L.get(n._iid).container.apiClient.setMyCountPreference({channelUrl:n.url,countPreference:e},(function(e,i){var s=null;e||(s=n.myCountPreference=i.count_preference,n._setGroupChannelUnreadCount(n.unreadMessageCount,n.unreadMentionCount),r.cachedChannels[n.url]=n),t(e,s)}))}),t)}},{key:"resetMyHistory",value:function(e){var t=this;return _e(this._iid,(function(e){L.get(t._iid).container.apiClient.resetMyHistory({channelUrl:t.url},(function(n,i){if(!n&&i.hasOwnProperty("ts_message_offset")){var r=G.get(t._iid).GroupChannel;t._messageOffsetTimestamp=i.ts_message_offset,r.cachedChannels[t.url]=t}e(n,i)}))}),e)}}],[{key:"MemberStateFilter",get:function(){return{ALL:"all",JOINED:"joined_only",INVITED:"invited_only",INVITED_BY_FRIEND:"invited_by_friend",INVITED_BY_NON_FRIEND:"invited_by_non_friend"}}},{key:"PushTriggerOption",get:function(){return{DEFAULT:"default",ALL:"all",MENTION_ONLY:"mention_only",OFF:"off"}}},{key:"CountPreference",get:function(){return{ALL:"all",UNREAD_MESSAGE_COUNT_ONLY:"unread_message_count_only",UNREAD_MENTION_COUNT_ONLY:"unread_mention_count_only",OFF:"off"}}},{key:"HiddenState",get:function(){return{UNHIDDEN:"unhidden",HIDDEN_ALLOW_AUTO_UNHIDE:"hidden_allow_auto_unhide",HIDDEN_PREVENT_AUTO_UNHIDE:"hidden_prevent_auto_unhide"}}},{key:"PublicChannelFilter",get:function(){return{ALL:"all",PUBLIC:"public",PRIVATE:"private"}}},{key:"SuperChannelFilter",get:function(){return{ALL:"all",SUPER:"super",NON_SUPER:"nonsuper",BROADCAST_ONLY:"broadcast_only"}}},{key:"UnreadChannelFilter",get:function(){return{ALL:"all",UNREAD_MESSAGE:"unread_message"}}},{key:"HiddenChannelFilter",get:function(){return{UNHIDDEN:"unhidden_only",HIDDEN:"hidden_only",HIDDEN_ALLOW_AUTO_UNHIDE:"hidden_allow_auto_unhide",HIDDEN_PREVENT_AUTO_UNHIDE:"hidden_prevent_auto_unhide"}}},{key:"Role",get:function(){return{OPERATOR:"operator",NONE:"none"}}},{key:"UnreadItemKey",get:function(){return{GROUP_CHANNEL_UNREAD_MENTION_COUNT:"group_channel_unread_mention_count",NONSUPER_UNREAD_MENTION_COUNT:"non_super_group_channel_unread_mention_count",SUPER_UNREAD_MENTION_COUNT:"super_group_channel_unread_mention_count",GROUP_CHANNEL_UNREAD_MESSAGE_COUNT:"group_channel_unread_message_count",NONSUPER_UNREAD_MESSAGE_COUNT:"non_super_group_channel_unread_message_count",SUPER_UNREAD_MESSAGE_COUNT:"super_group_channel_unread_message_count",GROUP_CHANNEL_INVITATION_COUNT:"group_channel_invitation_count",NONSUPER_INVITATION_COUNT:"non_super_group_channel_invitation_count",SUPER_INVITATION_COUNT:"super_group_channel_invitation_count"}}},{key:"cachedChannels",get:function(){return Me[this._iid]||(Me[this._iid]={}),Me[this._iid]}},{key:"buildFromSerializedData",value:function(e){var t=G.get(this._iid),n=t.User,i=t.Member,r=t.GroupChannel,s=t.BaseMessage,a=t.UserMessage,o=t.FileMessage,l=t.AdminMessage,u=me.deserialize(e),c=function(e){return null!=e&&"object"===h(e)?e.messageType===s.MESSAGE_TYPE_USER?new a(a.objectify(d(d({},e),{},{channel:{url:e.channelUrl,channelType:e.channelType},user:e.sender,mentionedUsers:e.mentionedUsers}))):e.messageType===s.MESSAGE_TYPE_FILE?new o(o.objectify(d(d({},e),{},{channel:{url:e.channelUrl,channelType:e.channelType},user:e.sender,mentionedUsers:e.mentionedUsers}))):new l(l.objectify(d(d({},e),{},{channel:{url:e.channelUrl,channelType:e.channelType},mentionedUsers:e.mentionedUsers}))):null}(u.lastMessage);return new r({channel_url:u.url,name:u.name,cover_url:u.coverUrl,data:u.data,custom_type:u.customType,invited_at:u.invitedAt,created_at:u.createdAt/1e3,joined_ts:u.joinedAt,is_access_code_required:u.isAccessCodeRequired,is_distinct:u.isDistinct,is_super:u.isSuper,is_broadcast:u.isBroadcast,is_public:u.isPublic,is_discoverable:u.isDiscoverable,is_hidden:u.isHidden,is_ephemeral:u.isEphemeral,is_muted:u.myMutedState,is_push_enabled:u.isPushEnabled,freeze:u.isFrozen,unread_message_count:u.unreadMessageCount,unread_mention_count:u.unreadMentionCount,push_trigger_option:u.myPushTriggerOption,count_preference:u.myCountPreference,hidden_state:u.hiddenState,member_count:u.memberCount,joined_member_count:u.joinedMemberCount,member_state:u.myMemberState,my_role:u.myRole,user_last_read:u.myLastRead,ts_message_offset:u.messageOffsetTimestamp,message_survival_seconds:u.messageSurvivalSeconds,read_receipt:u.cachedReadReceiptStatus,delivery_receipt:u.cachedDeliveryReceiptStatus,members:u.members.map((function(e){return i.objectify(d({user:e},e))})),last_message:c,created_by:null!==u.creator&&void 0!==u.creator&&"object"===h(u.creator)?n.objectify(u.creator):null,inviter:null!==u.inviter&&void 0!==u.inviter&&"object"===h(u.inviter)?n.objectify(u.inviter):null})}},{key:"upsert",value:function(e){var t=G.get(this._iid).GroupChannel,n=new t(e);if(t.cachedChannels.hasOwnProperty(n.url)){if(n.isEphemeral){var i=t.cachedChannels[n.url];e.last_message=i.lastMessage,e.unread_message_count=i.unreadMessageCount}t.cachedChannels[n.url].update(e)}else t.cachedChannels[n.url]=n;return t.cachedChannels[n.url]}},{key:"removeCachedChannel",value:function(e){var t=G.get(this._iid),n=t.GroupChannel,i=t.FileMessageQueue;n.cachedChannels[e]&&delete n.cachedChannels[e],i.delete(e)}},{key:"clearCache",value:function(){Me[this._iid]={},G.get(this._iid).FileMessageQueue.clear()}},{key:"getChannel",value:function(e,t){var n=null,i=null,r=ae.parse(arguments,[new ae({type:"string",constraint:function(e){return e.length>0}}),new ae({type:"string",optional:!0,nullable:!0,defaultValue:null}),new ae({type:"callback"})]),s=U(r,4);if(n=s[0],e=s[1],i=s[2],t=s[3],n)return _e(this._iid,(function(e){e(n,null)}),t);var a=G.get(this._iid),o=a.GroupChannel;return o.cachedChannels[e]?_e(this._iid,(function(t){t(null,o.cachedChannels[e])}),t):o.getChannelWithoutCache(e,i,t)}},{key:"getChannelWithoutCache",value:function(e,t){var n=this,i=null,r=null,s=ae.parse(arguments,[new ae({type:"string",constraint:function(e){return e.length>0}}),new ae({type:"string",optional:!0,nullable:!0,defaultValue:null}),new ae({type:"callback"})]),a=U(s,4);return i=a[0],e=a[1],r=a[2],t=a[3],_e(this._iid,(function(t){i?t(i,null):L.get(n._iid).container.apiClient.getGroupChannel({channelUrl:e,internalCall:r,showMember:!0},(function(e,i){var r=null;e||(r=n.upsert(i)),t(e,r)}))}),t)}},{key:"createDistinctChannelIfNotExist",value:function(e,t){var n=this,i=G.get(this._iid),r=i.GroupChannelParams,s=null,a=ae.parse(arguments,[new ae({type:r,constraint:function(e){return e._validate()}}),new ae({type:"callback"})]),o=U(a,3);return s=o[0],e=o[1],t=o[2],_e(this._iid,(function(t){s?t(s,null):(e.isPublic||(e.accessCode=null),L.get(n._iid).container.apiClient.createGroupChannel(d(d({},e),{},{isDistinct:!0}),(function(e,i){var r=null;if(!e){var s=G.get(n._iid).GroupChannel;r={channel:new s(i),isCreated:i.is_created},s.cachedChannels[r.channel.url]=r.channel}t(e,r)})))}),t)}},{key:"createChannel",value:function(){var e=this,t=ae.toArray(arguments),n=void 0;"function"==typeof t[t.length-1]&&(n=t.pop());var i=G.get(this._iid),r=i.GroupChannel,s=i.GroupChannelParams;if(t[0]instanceof s&&1===t.length)return _e(this._iid,(function(n){var i=t[0];i.isPublic||(i.accessCode=null),i._validate()?L.get(e._iid).container.apiClient.createGroupChannel(i,(function(e,t){var i=null;e||(i=new r(t),r.cachedChannels[i.url]=i),n(e,i)})):n(ae.error,null)}),n);if(Array.isArray(t[0])){var a=new s;switch(t.length){case 1:a.addUsers(t[0]);break;case 2:a.addUsers(t[0]),a.isDistinct=t[1];break;case 3:a.addUsers(t[0]),a.isDistinct=t[1],a.customType=t[2];break;case 5:a.addUsers(t[0]),a.isDistinct=t[1],a.name=t[2],"string"==typeof t[3]?a.coverUrl=t[3]:a.coverImage=t[3],a.data=t[4];break;case 6:a.addUsers(t[0]),a.isDistinct=t[1],a.name=t[2],"string"==typeof t[3]?a.coverUrl=t[3]:a.coverImage=t[3],a.data=t[4],a.customType=t[5];break;default:return _e(this._iid,(function(e){return e(ae.error,null)}),n)}return n?r.createChannel(a,n):r.createChannel(a)}return _e(this._iid,(function(e){return e(ae.error,null)}),n)}},{key:"createChannelWithUserIds",value:function(){var e=ae.toArray(arguments),t=void 0;"function"==typeof e[e.length-1]&&(t=e.pop());var n=G.get(this._iid),i=n.GroupChannel,r=n.GroupChannelParams,s=new r;switch(e.length){case 1:s.addUserIds(e[0]);break;case 2:s.addUserIds(e[0]),s.isDistinct=e[1];break;case 3:s.addUserIds(e[0]),s.isDistinct=e[1],s.customType=e[2];break;case 5:s.addUserIds(e[0]),s.isDistinct=e[1],s.name=e[2],"string"==typeof e[3]?s.coverUrl=e[3]:s.coverImage=e[3],s.data=e[4];break;case 6:s.addUserIds(e[0]),s.isDistinct=e[1],s.name=e[2],"string"==typeof e[3]?s.coverUrl=e[3]:s.coverImage=e[3],s.data=e[4],s.customType=e[5];break;default:return _e(this._iid,(function(e){return e(ae.error,null)}),t)}return i.createChannel(s,t)}},{key:"createMyGroupChannelListQuery",value:function(){return new(0,G.get(this._iid).GroupChannelListQuery)}},{key:"createPublicGroupChannelListQuery",value:function(){return new(0,G.get(this._iid).PublicGroupChannelListQuery)}},{key:"markAsReadAllLastSentAt",get:function(){return Pe[this._iid]||0},set:function(e){Pe[this._iid]=e}},{key:"getChannelCount",value:function(e,t){return fn.getInstance(this._iid).getGroupChannelCount(e,t)}},{key:"getUnreadItemCount",value:function(e,t){return fn.getInstance(this._iid).getUnreadItemCount(e,t)}},{key:"getTotalUnreadMessageCount",value:function(){var e=ae.toArray(arguments),t="function"==typeof e[e.length-1]?e.pop():null,n=fn.getInstance(this._iid);return n.getTotalUnreadMessageCount.apply(n,O(e).concat([t]))}},{key:"getTotalUnreadChannelCount",value:function(e){return fn.getInstance(this._iid).getTotalUnreadChannelCount(e)}}]),n}(ke),Ge=function(e){m(n,e);var t=k(n);function n(e){var i;return p(this,n),(i=t.call(this,e)).state="",i.role="",i.isMuted=!1,i.isBlockedByMe=!1,i.isBlockingMe=!1,i.restrictionInfo=null,e&&i._update(e),i}return g(n,[{key:"_update",value:function(e){var t=G.get(this._iid),n=t.RestrictedUser,i=t.RestrictionInfo;this.state=e.state,this.role=e.role||Fe.Role.NONE,e.hasOwnProperty("is_muted")&&(this.isMuted=e.is_muted),e.hasOwnProperty("is_blocked_by_me")&&(this.isBlockedByMe=e.is_blocked_by_me),e.hasOwnProperty("is_blocking_me")&&(this.isBlockingMe=e.is_blocking_me),this.isMuted&&(this.restrictionInfo=new i(e),this.restrictionInfo.restrictionType=n.RestrictionType.MUTED)}},{key:"parse",value:function(e){this._update(e)}}],[{key:"objectify",value:function(e){var t=G.get(this._iid),n=t.User,i=t.RestrictedUser,r=t.RestrictionInfo,s=e.user,a=e.state,o=e.role,l=void 0===o?"":o,u=e.isMuted,c=void 0!==u&&u,d=e.isBlockedByMe,h=void 0!==d&&d,p=e.isBlockingMe,f=void 0!==p&&p,g=e.restrictionInfo,y=void 0===g?null:g,m=c?i.objectify(s):n.objectify(s);if(m.state=a,m.role=l,m.is_muted=c,m.is_blocked_by_me=h,m.is_blocking_me=f,y){var _=r.objectify(y);m.restriction_type=_.restriction_type,m.muted_description=_.description,m.muted_end_at=_.end_at}return m}},{key:"build",value:function(e,t,n,i,r,s){var a=G.get(this._iid).User;return this.objectify({user:new a(e),state:t,role:n,isMuted:i,isBlockedByMe:r,isBlockingMe:s})}},{key:"buildFromSerializedData",value:function(e){var t=G.get(this._iid).Member,n=me.deserialize(e);return new t(t.objectify(d({user:n},n)))}},{key:"JOINED",get:function(){return"joined"}},{key:"INVITED",get:function(){return"invited"}}]),n}(be),xe=function(e){m(n,e);var t=k(n);function n(e){var i;return p(this,n),(i=t.call(this,e)).role="",i.isBlockedByMe=!1,e&&i._update(e),i}return g(n,[{key:"parse",value:function(e){this._update(e)}},{key:"_update",value:function(e){this.role=e.role||Fe.Role.NONE,e.hasOwnProperty("is_blocked_by_me")&&(this.isBlockedByMe=e.is_blocked_by_me)}}],[{key:"objectify",value:function(e){var t=G.get(this._iid).User,n=e.user,i=e.role,r=void 0===i?"":i,s=e.isBlockedByMe,a=void 0!==s&&s,o=t.objectify(n);return o.role=r,o.is_blocked_by_me=a,o}},{key:"build",value:function(e,t){var n=G.get(this._iid).User;return this.objectify({user:new n(e),isBlockedByMe:t})}},{key:"buildFromSerializedData",value:function(e){var t=G.get(this._iid).Sender,n=me.deserialize(e);return new t(t.objectify(d({user:n},n)))}}]),n}(be),je=function(e){m(n,e);var t=k(n);function n(e){var i;return p(this,n),(i=t.call(this,e)).restrictionInfo=null,e&&i._update(e),i}return g(n,[{key:"_update",value:function(e){var t=G.get(this._iid).RestrictionInfo;this.restrictionInfo=new t(e)}}],[{key:"RestrictionType",get:function(){return{MUTED:"muted",BANNED:"banned"}}},{key:"objectify",value:function(e){var t=G.get(this._iid),n=t.User,i=t.RestrictionInfo,r=e.restrictionInfo,s=void 0===r?{}:r;return d(d({},n.objectify(e)),i.objectify(s))}}]),n}(be),Be=function(){function e(t){p(this,e),this.emojiHash=null,this.emojiCategories=null,t&&this._update(t)}return g(e,[{key:"_update",value:function(e){var t=G.get(this._iid).EmojiCategory;this.emojiHash=e.emoji_hash||"",this.emojiCategories=e.emoji_categories?e.emoji_categories.map((function(e){return new t(e)})):[]}}]),e}(),qe=function(){function e(t){p(this,e),this.id=null,this.name=null,this.url=null,this.emojis=null,t&&this._update(t)}return g(e,[{key:"_update",value:function(e){var t=G.get(this._iid).Emoji;this.id=e.id||0,this.name=e.name||"",this.url=e.url||"",this.emojis=e.emojis?e.emojis.map((function(e){return new t(e)})):[]}}]),e}(),ze=function(){function e(t){p(this,e),this.key=null,this.url=null,t&&this._update(t)}return g(e,[{key:"_update",value:function(e){this.key=e.key,this.url=e.url}}]),e}(),Ye={},Ve={},Ke=new WeakMap,Qe=function(e){m(n,e);var t=k(n);function n(e){var i;return p(this,n),(i=t.call(this,e)).channelType=ke.CHANNEL_TYPE_OPEN,i.participantCount=0,Ke.set(S(i),0),i.operators=[],e&&i._update(e),i}return g(n,[{key:"_update",value:function(e){var t=G.get(this._iid).User;e.hasOwnProperty("participant_count")&&(this.participantCount=parseInt(e.participant_count)),e.hasOwnProperty("operators")&&Array.isArray(e.operators)&&(this.operators=e.operators.map((function(e){return new t(e)})))}},{key:"parse",value:function(e){this._update(e)}},{key:"update",value:function(e){this.__update(e),this._update(e)}},{key:"createParticipantListQuery",value:function(){return new(0,G.get(this._iid).ParticipantListQuery)({channelUrl:this.url})}},{key:"createMutedUserListQuery",value:function(){return new(0,G.get(this._iid).MutedUserListQuery)({channelUrl:this.url,isOpenChannel:!0})}},{key:"createBannedUserListQuery",value:function(){return new(0,G.get(this._iid).BannedUserListQuery)({channelUrl:this.url,isOpenChannel:!0})}},{key:"isOperator",value:function(e){return!!e&&this.isOperatorWithUserId(e.userId)}},{key:"isOperatorWithUserId",value:function(e){return this.operators.map((function(e){return e.userId})).indexOf(e)>-1}},{key:"refresh",value:function(e){return G.get(this._iid).OpenChannel.getChannelWithoutCache(this.url,e)}},{key:"enter",value:function(e){var t=this;return _e(this._iid,(function(e){var n=G.get(t._iid).Command.bEnter({channelUrl:t.url}),i=fn.getInstance(t._iid);i.sendCommand(n,(function(n,r){if(i.getErrorFirstCallback()){var s=[n,r];r=s[0],n=s[1]}r?(r=r?new D(r.message,r.code):null,e(r,null)):(G.get(t._iid).OpenChannel.enteredChannels[t.url]=t,t.refresh((function(){return e(null,null)})))}))}),e)}},{key:"exit",value:function(e){var t=this;return _e(this._iid,(function(e){var n=G.get(t._iid),i=n.Command,r=n.FileMessageQueue,s=i.bExit({channelUrl:t.url}),a=fn.getInstance(t._iid);a.sendCommand(s,(function(n,i){if(a.getErrorFirstCallback()){var s=[n,i];i=s[0],n=s[1]}i?(i=i?new D(i.message,i.code):null,e(i,null)):(delete G.get(t._iid).OpenChannel.enteredChannels[t.url],r.delete(t.url),e(null,null))}))}),e)}},{key:"updateChannel",value:function(){var e=this,t=ae.toArray(arguments),n=null;"function"==typeof t[t.length-1]&&(n=t.pop());var i=G.get(this._iid),r=i.OpenChannel,s=i.OpenChannelParams;if(t[0]instanceof s&&1===t.length)return _e(this._iid,(function(n){var i=t[0];i.channelUrl=e.url,i._validate()?L.get(e._iid).container.apiClient.updateOpenChannel(i,(function(e,t){var i=null;e||(i=r.upsert(t)),n(e,i)})):n(ae.error,null)}),n);if(3===t.length){var a=new s;return a.channelUrl=this.url,a.name=t[0],a.coverUrlOrImage=t[1],a.data=t[2],a.operatorUserIds=this.operators.map((function(e){return e.userId})),this.updateChannel(a,n)}if(4===t.length){var o=new s;return o.channelUrl=this.url,o.name=t[0],o.coverUrlOrImage=t[1],o.data=t[2],Array.isArray(t[3])&&(o.operatorUserIds=t[3]),this.updateChannel(o,n)}if(5===t.length){var l=new s;return l.channelUrl=this.url,l.name=t[0],l.coverUrlOrImage=t[1],l.data=t[2],Array.isArray(t[3])&&(l.operatorUserIds=t[3]),l.customType=t[4],this.updateChannel(l,n)}return _e(this._iid,(function(e){return e(ae.error,null)}),n)}},{key:"updateChannelWithOperatorUserIds",value:function(){var e=ae.toArray(arguments),t=void 0;switch("function"==typeof e[e.length-1]&&(t=e.pop()),e.length){case 4:case 5:return this.updateChannel.apply(this,O(e).concat([t]));default:return _e(this._iid,(function(e){return e(ae.error,null)}),t)}}},{key:"muteUser",value:function(e,t,n,i){return this.muteUserWithUserId(e?e.userId:null,t,n,i)}},{key:"muteUserWithUserId",value:function(e,t,n,i){var r=this,s=null,a=ae.parse(arguments,[new ae({type:"string"}),new ae({type:"number",optional:!0,defaultValue:-1,constraint:function(e){return e>=-1}}),new ae({type:"string",optional:!0,defaultValue:""}),new ae({type:"callback"})]),o=U(a,5);return s=o[0],e=o[1],t=o[2],n=o[3],i=o[4],_e(this._iid,(function(i){s?i(s,null):L.get(r._iid).container.apiClient.muteUser({channelUrl:r.url,userId:e,description:n,seconds:t,isGroupChannel:!1},(function(e,t){i(e,null)}))}),i)}},{key:"unmuteUser",value:function(e,t){return this.unmuteUserWithUserId(e?e.userId:null,t)}},{key:"unmuteUserWithUserId",value:function(e,t){var n=this,i=null,r=ae.parse(arguments,[new ae({type:"string"}),new ae({type:"callback"})]),s=U(r,3);return i=s[0],e=s[1],t=s[2],_e(this._iid,(function(t){i?t(i,null):L.get(n._iid).container.apiClient.unmuteUser({channelUrl:n.url,userId:e,isGroupChannel:!1},(function(e,n){t(e,null)}))}),t)}},{key:"banUser",value:function(e,t,n){return this.banUserWithUserId(e?e.userId:null,t,n)}},{key:"banUserWithUserId",value:function(e,t,n){var i=this,r=null,s=ae.parse(arguments,[new ae({type:"string"}),new ae({type:"number",optional:!0,defaultValue:-1,constraint:function(e){return e>=-1}}),new ae({type:"callback"})]),a=U(s,4);return r=a[0],e=a[1],t=a[2],n=a[3],_e(this._iid,(function(n){r?n(r,null):L.get(i._iid).container.apiClient.banUser({channelUrl:i.url,userId:e,description:null,seconds:t,isGroupChannel:!1},(function(e,t){n(e,null)}))}),n)}},{key:"unbanUser",value:function(e,t){return this.unbanUserWithUserId(e?e.userId:null,t)}},{key:"unbanUserWithUserId",value:function(e,t){var n=this,i=null,r=ae.parse(arguments,[new ae({type:"string"}),new ae({type:"callback"})]),s=U(r,3);return i=s[0],e=s[1],t=s[2],_e(this._iid,(function(t){i?t(i,null):L.get(n._iid).container.apiClient.unbanUser({channelUrl:n.url,userId:e,isGroupChannel:!1},(function(e,n){t(e,null)}))}),t)}},{key:"setLatestParticipantCount",value:function(e,t){var n=!1;return"number"==typeof e&&"number"==typeof t&&t>=Ke.get(this)&&(Ke.set(this,t),n=e!==this.participantCount,this.participantCount=e),n}},{key:"delete",value:function(e){var t=this;return _e(this._iid,(function(e){L.get(t._iid).container.apiClient.deleteOpenChannel({channelUrl:t.url},(function(n,i){n||(delete G.get(t._iid).OpenChannel.cachedChannels[t.url],G.get(t._iid).FileMessageQueue.delete(t.url)),e(n,i)}))}),e)}}],[{key:"cachedChannels",get:function(){return Ye[this._iid]||(Ye[this._iid]={}),Ye[this._iid]}},{key:"enteredChannels",get:function(){return Ve[this._iid]||(Ve[this._iid]={}),Ve[this._iid]}},{key:"buildFromSerializedData",value:function(e){var t=G.get(this._iid),n=t.User,i=t.OpenChannel,r=me.deserialize(e);return new i({channel_url:r.url,name:r.name,cover_url:r.coverUrl,data:r.data,custom_type:r.customType,created_at:r.createdAt/1e3,freeze:r.isFrozen,is_ephemeral:r.isEphemeral,participant_count:r.participantCount,operators:r.operators.map((function(e){return n.objectify(e)}))})}},{key:"getChannel",value:function(e,t){var n=null,i=null,r=ae.parse(arguments,[new ae({type:"string",constraint:function(e){return e.length>0}}),new ae({type:"string",optional:!0,nullable:!0,defaultValue:null}),new ae({type:"callback"})]),s=U(r,4);if(n=s[0],e=s[1],i=s[2],t=s[3],n)return _e(this._iid,(function(e){e(n,null)}),t);var a=G.get(this._iid),o=a.OpenChannel;return o.cachedChannels[e]?_e(this._iid,(function(t){t(null,o.cachedChannels[e])}),t):o.getChannelWithoutCache(e,i,t)}},{key:"getChannelWithoutCache",value:function(e,t){var n=this,i=null,r=null,s=ae.parse(arguments,[new ae({type:"string",constraint:function(e){return e.length>0}}),new ae({type:"string",optional:!0,nullable:!0,defaultValue:null}),new ae({type:"callback"})]),a=U(s,4);return i=a[0],e=a[1],r=a[2],t=a[3],_e(this._iid,(function(t){i?t(i,null):L.get(n._iid).container.apiClient.getOpenChannel({channelUrl:e,internalCall:r},(function(e,i){var r=null;e||(r=G.get(n._iid).OpenChannel.upsert(i)),t(e,r)}))}),t)}},{key:"createChannel",value:function(){var e=this,t=ae.toArray(arguments),n=null;"function"==typeof t[t.length-1]&&(n=t.pop());var i=G.get(this._iid),r=i.OpenChannel,s=i.OpenChannelParams;if(t[0]instanceof s&&1===t.length)return _e(this._iid,(function(n){var i=t[0];i._validate()?L.get(e._iid).container.apiClient.createOpenChannel(i,(function(t,i){var r=null;t||(r=G.get(e._iid).OpenChannel.upsert(i)),n(t,r)})):n(ae.error,null)}),n);var a=new s;switch(t.length){case 0:break;case 1:a.name=t[0];break;case 2:a.name=t[0],a.coverUrlOrImage=t[1];break;case 3:a.name=t[0],a.coverUrlOrImage=t[1],a.data=t[2];break;case 4:a.name=t[0],a.coverUrlOrImage=t[1],a.data=t[2],a.operatorUserIds=t[3];break;case 5:a.name=t[0],a.coverUrlOrImage=t[1],a.data=t[2],a.operatorUserIds=t[3],a.customType=t[4];break;default:return _e(this._iid,(function(e){return e(ae.error,null)}),n)}return n?r.createChannel(a,n):r.createChannel(a)}},{key:"createChannelWithOperatorUserIds",value:function(){var e=ae.toArray(arguments),t=void 0;switch("function"==typeof e[e.length-1]&&(t=e.pop()),e.length){case 4:case 5:return this.createChannel.apply(this,O(e).concat([t]));default:return _e(this._iid,(function(e){return e(ae.error,null)}),t)}}},{key:"upsert",value:function(e){var t=new(0,G.get(this._iid).OpenChannel)(e);return this.cachedChannels.hasOwnProperty(t.url)?this.cachedChannels[t.url].update(e):this.cachedChannels[t.url]=t,this.cachedChannels[t.url]}},{key:"removeCachedChannel",value:function(e){this.cachedChannels[e]&&delete this.cachedChannels[e],G.get(this._iid).FileMessageQueue.delete(e)}},{key:"clearCache",value:function(){Ye[this._iid]={},G.get(this._iid).FileMessageQueue.clear()}},{key:"clearEnteredChannels",value:function(){Ve[this._iid]={}}},{key:"createOpenChannelListQuery",value:function(){return new(0,G.get(this._iid).OpenChannelListQuery)}}]),n}(ke),We=function(e){m(n,e);var t=k(n);function n(e){var i;return p(this,n),(i=t.call(this,e)).messageType=Ce.MESSAGE_TYPE_USER,i.message=null,i._sender=null,i.reqId="",i.translations={},i.requestState=null,i.requestedMentionUserIds=[],i.errorCode=0,i.messageSurvivalSeconds=-1,i.plugins=[],i.poll=null,e&&i._update(e),i}return g(n,[{key:"applyPollUpdateEvent",value:function(e){var t=G.get(this._iid),n=t.Poll,i=t.PollUpdateEvent,r=null,s=ae.parse(arguments,[new ae({type:i,constraint:function(e){return Object.values(n.Status).includes(e.status)}})]),a=U(s,2);if(r=a[0],e=a[1],!r&&this.poll&&this.poll.id===e.poll.id){if(e.status===n.Status.REMOVED)return this.poll=new n(n.objectify(this.poll)),this.poll.details.status=e.status,!0;if(this.poll.details.updatedAt<e.poll.details.updatedAt)return this.poll=e.poll,!0}return!1}},{key:"applyPollVoteEvent",value:function(e){var t=G.get(this._iid),n=t.PollVoteEvent,i=null,r=ae.parse(arguments,[new ae({type:n})]),s=U(r,2);if(i=s[0],e=s[1],!i&&this.poll&&this.poll.id===e.pollId){var a,o=N(this.poll.details.options);try{for(o.s();!(a=o.n()).done;){var l=a.value;if(l._applyEvent(e))return!0}}catch(i){o.e(i)}finally{o.f()}}return!1}},{key:"_update",value:function(e){var t=fn.getInstance(this._iid),n=G.get(this._iid),i=n.Sender,r=n.Plugin,s=n.Poll;this.message=String(e.message),this._sender=new i(e.user),this.reqId=e.hasOwnProperty("req_id")?String(e.req_id):"",this.translations=e.hasOwnProperty("translations")?e.translations:{},this.requestState=this.messageId>0?t.MessageRequestState.SUCCEEDED:t.MessageRequestState.FAILED,e.hasOwnProperty("sending_status")&&(this.requestState=e.sending_status,this.requestState===t.MessageSendingStatus.CANCELED&&(this.requestState=t.MessageRequestState.FAILED)),this.requestedMentionUserIds=[],e.hasOwnProperty("requested_mention_user_ids")&&(this.requestedMentionUserIds=e.requested_mention_user_ids),this.errorCode=0,e.hasOwnProperty("error_code")&&(this.errorCode=e.error_code),this.messageSurvivalSeconds=-1,e.hasOwnProperty("message_survival_seconds")&&(this.messageSurvivalSeconds=e.message_survival_seconds),this.plugins=[],e.hasOwnProperty("plugins")&&Array.isArray(e.plugins)&&(this.plugins=e.plugins.map((function(e){return new r(e)}))),this.poll=null,e.hasOwnProperty("poll")&&(this.poll=new s(e.poll))}},{key:"sender",get:function(){var e=fn.getInstance(this._iid),t=G.get(this._iid).GroupChannel;if(e.Options.useMemberAsMessageSender&&this.isGroupChannel()){var n=t.cachedChannels[this.channelUrl];if(n){var i=n.memberMap[this._sender.userId];i&&(this._sender.nickname!==i.nickname&&(this._sender.nickname=i.nickname),this._sender.plainProfileUrl!==i.plainProfileUrl&&(this._sender.plainProfileUrl=i.plainProfileUrl),ee.deepEqual(this._sender.metaData,i.metaData)||(this._sender.metaData=i.metaData))}}return this._sender},set:function(e){this._sender=e}},{key:"isResendable",value:function(){var e=fn.getInstance(this._iid);return this.sendingStatus===e.MessageSendingStatus.FAILED&&ee.isResendableError(this.errorCode)}}],[{key:"objectify",value:function(e){var t=fn.getInstance(this._iid),n=G.get(this._iid),i=n.BaseChannel,r=n.BaseMessageParams,s=n.Sender,a=n.User,o=n.UserMessage,l=n.FileMessage,u=n.AdminMessage,c=n.ThreadInfo,d=n.OGMetaData,h=n.Plugin,p=n.AppleCriticalAlertOptions,f=n.Poll,g=e.messageId,y=e.reqId,m=void 0===y?"":y,_=e.user,v=e.channel,E=e.message,C=e.data,b=void 0===C?"":C,S=e.customType,A=void 0===S?"":S,k=e.mentionType,I=void 0===k?r.MentionType.USERS:k,U=e.mentionedUsers,O=void 0===U?[]:U,T=e.mentionedUserIds,R=void 0===T?[]:T,N=e.requestedMentionUserIds,w=void 0===N?[]:N,M=e.reactions,P=void 0===M?[]:M,L=e.metaArrays,D=void 0===L?[]:L,H=e.rootMessageId,F=void 0===H?0:H,x=e.parentMessageId,j=void 0===x?0:x,B=e.parentMessageText,q=void 0===B?"":B,z=e.threadInfo,Y=void 0===z?null:z,V=e.isReplyToChannel,K=void 0!==V&&V,Q=e.parentMessage,W=void 0===Q?null:Q,J=e.translations,$=void 0===J?{}:J,X=e.sendingStatus,Z=e.errorCode,ee=void 0===Z?0:Z,te=e.silent,ne=void 0!==te&&te,ie=e.isGlobalBlocked,re=void 0!==ie&&ie,se=e.messageSurvivalSeconds,ae=void 0===se?-1:se,oe=e.ogMetaData,le=void 0===oe?null:oe,ue=e.isOperatorMessage,ce=void 0!==ue&&ue,de=e.plugins,he=void 0===de?[]:de,pe=e.appleCriticalAlertOptions,fe=e.poll,ge=void 0===fe?null:fe,ye=e.createdAt,me=e.updatedAt,_e=void 0===me?0:me,ve={};if(ve.req_id=m,ve.msg_id=g,ve.user=s.objectify({user:_,role:t.currentUser&&t.currentUser.userId===_.userId?v.myRole:_.role,isBlockedByMe:_.isBlockedByMe}),ve.channel_url=v.url,ve.channel_type=v.channelType===i.CHANNEL_TYPE_OPEN?i.CHANNEL_TYPE_OPEN:i.CHANNEL_TYPE_GROUP,ve.message=E,ve.data=b,ve.custom_type=A,ve.translations=$,ve.is_global_block=!!re,ve.ts=ye,ve.updated_at=_e,ve.mention_type=I,ve.mentioned_users=O.map((function(e){return a.objectify(e)})),ve.mentioned_user_ids=R,ve.requested_mention_user_ids=w,ve.reactions=P.map((function(e){return e.serialize()})),ve.metaarray={},D.forEach((function(e){var t=e.key;ve.metaarray[t]=e.value})),ve.metaarray_key_order=D.map((function(e){return e.key})),ve.root_message_id=F,ve.parent_message_id=j,ve.parent_message_text=q,Y&&(ve.thread_info=c.objectify(Y)),ve.is_reply_to_channel=K,W)switch(W.messageType){case i.MESSAGE_TYPE_USER:ve.parent_message_info=o.objectify(W);break;case i.MESSAGE_TYPE_FILE:ve.parent_message_info=l.objectify(W);break;case i.MESSAGE_TYPE_ADMIN:ve.parent_message_info=u.objectify(W)}return ve.sending_status=g>0?t.MessageSendingStatus.SUCCEEDED:t.MessageSendingStatus.FAILED,X&&(ve.sending_status=X),ve.silent=!!ne,ve.error_code=ee,ve.message_survival_seconds=ae,le&&(ve.og_tag=d.objectify(le)),ve.is_op_msg=!!ce,ve.plugins=he.map((function(e){return h.objectify(e)})),ge&&(ve.poll=f.objectify(ge)),pe&&(ve.apple_critical_alert_options=p.objectify(pe)),ve}},{key:"build",value:function(e,t,n,i,r,s,a,o,l,u,c,d,h,p,f,g,y,m,_,v,E,C,b,S,A,k,I,U,O){return this.objectify({messageId:t,reqId:e,user:n,channel:i,message:r,data:s,customType:a,mentionType:p,mentionedUsers:f,mentionedUserIds:v,requestedMentionUserIds:C,reactions:h,metaArrays:d,rootMessageId:g,parentMessageId:y,parentMessageText:m,threadInfo:_,translations:o,sendingStatus:E,errorCode:b,isGlobalBlocked:l,messageSurvivalSeconds:S,ogMetaData:A,isOperatorMessage:k,plugins:I,appleCriticalAlertOptions:U,poll:O,createdAt:u,updatedAt:c})}},{key:"buildFromSerializedData",value:function(e){var t=G.get(this._iid).UserMessage,n=me.deserialize(e);return new t(t.objectify(d(d({},n),{},{channel:{url:n.channelUrl,channelType:n.channelType},user:n.sender})))}}]),n}(Ce),Je=function(e){m(n,e);var t=k(n);function n(e){var i;return p(this,n),(i=t.call(this,e)).messageType=Ce.MESSAGE_TYPE_FILE,i.plainUrl=null,i.name="File",i.size=0,i.type=null,i.thumbnails=[],i._sender=null,i.reqId="",i.requireAuth=null,i.requestState=null,i.requestedMentionUserIds=[],i.errorCode=0,i.messageSurvivalSeconds=-1,e&&i._update(e),i}return g(n,[{key:"_update",value:function(e){var t=fn.getInstance(this._iid),n=L.get(this._iid).container.auth,i=G.get(this._iid).Sender;if(this._sender=new i(e.user),this.requireAuth=!!e.hasOwnProperty("require_auth")&&e.require_auth,this.plainUrl=String(e.url).split("?auth=")[0],Object.defineProperty(this,"url",{value:this.requireAuth?"".concat(this.plainUrl,"?auth=").concat(n.eKey):this.plainUrl,configurable:!0,writable:!1}),this.name=e.hasOwnProperty("name")?e.name:"File",this.size=parseInt(e.size)||0,this.type=String(e.type),e.hasOwnProperty("custom")&&(this.data=String(e.custom)),this.reqId=e.hasOwnProperty("req_id")?String(e.req_id):"",this.thumbnails=e.hasOwnProperty("thumbnails")?e.thumbnails:[],this.requireAuth)for(var r=0;r<this.thumbnails.length;r++)this.thumbnails[r].plainUrl=String(this.thumbnails[r].url).split("?auth=")[0],this.thumbnails[r].url=this.requireAuth?"".concat(this.thumbnails[r].plainUrl,"?auth=").concat(n.eKey):this.thumbnails[r].plainUrl;this.requestState=this.messageId>0?t.MessageRequestState.SUCCEEDED:t.MessageRequestState.FAILED,e.hasOwnProperty("sending_status")&&(this.requestState=e.sending_status,this.requestState===t.MessageSendingStatus.CANCELED&&(this.requestState=t.MessageRequestState.FAILED)),this.requestedMentionUserIds=[],e.hasOwnProperty("requested_mention_user_ids")&&(this.requestedMentionUserIds=e.requested_mention_user_ids),this.errorCode=0,e.hasOwnProperty("error_code")&&(this.errorCode=e.error_code),this.messageSurvivalSeconds=-1,e.hasOwnProperty("message_survival_seconds")&&(this.messageSurvivalSeconds=e.message_survival_seconds)}},{key:"sender",get:function(){var e=fn.getInstance(this._iid),t=G.get(this._iid).GroupChannel;if(e.Options.useMemberAsMessageSender&&this.isGroupChannel()){var n=t.cachedChannels[this.channelUrl];if(n){var i=n.memberMap[this._sender.userId];i&&(this._sender.nickname!==i.nickname&&(this._sender.nickname=i.nickname),this._sender.plainProfileUrl!==i.plainProfileUrl&&(this._sender.plainProfileUrl=i.plainProfileUrl),ee.deepEqual(this._sender.metaData,i.metaData)||(this._sender.metaData=i.metaData))}}return this._sender},set:function(e){this._sender=e}},{key:"isResendable",value:function(){var e=fn.getInstance(this._iid);return this.sendingStatus===e.MessageSendingStatus.FAILED&&ee.isResendableError(this.errorCode)}}],[{key:"objectify",value:function(e){var t=fn.getInstance(this._iid),n=G.get(this._iid),i=n.BaseChannel,r=n.BaseMessageParams,s=n.Sender,a=n.User,o=n.UserMessage,l=n.FileMessage,u=n.AdminMessage,c=n.ThreadInfo,d=n.OGMetaData,h=n.AppleCriticalAlertOptions,p=e.messageId,f=e.reqId,g=void 0===f?"":f,y=e.user,m=void 0===y?{}:y,_=e.channel,v=e.plainUrl,E=e.name,C=e.type,b=e.size,S=void 0===b?0:b,A=e.data,k=void 0===A?"":A,I=e.customType,U=void 0===I?"":I,O=e.mentionType,T=void 0===O?r.MentionType.USERS:O,R=e.mentionedUsers,N=void 0===R?[]:R,w=e.mentionedUserIds,M=void 0===w?[]:w,P=e.requestedMentionUserIds,L=void 0===P?[]:P,D=e.reactions,H=void 0===D?[]:D,F=e.metaArrays,x=void 0===F?[]:F,j=e.rootMessageId,B=void 0===j?0:j,q=e.parentMessageId,z=void 0===q?0:q,Y=e.parentMessageText,V=void 0===Y?"":Y,K=e.threadInfo,Q=void 0===K?null:K,W=e.isReplyToChannel,J=void 0!==W&&W,$=e.parentMessage,X=void 0===$?null:$,Z=e.thumbnails,ee=void 0===Z?[]:Z,te=e.requireAuth,ne=void 0!==te&&te,ie=e.sendingStatus,re=e.errorCode,se=void 0===re?0:re,ae=e.silent,oe=void 0!==ae&&ae,le=e.isGlobalBlocked,ue=void 0!==le&&le,ce=e.messageSurvivalSeconds,de=void 0===ce?-1:ce,he=e.ogMetaData,pe=void 0===he?null:he,fe=e.isOperatorMessage,ge=void 0!==fe&&fe,ye=e.appleCriticalAlertOptions,me=e.createdAt,_e=e.updatedAt,ve=void 0===_e?0:_e,Ee={};Ee.req_id=g,Ee.msg_id=p,Ee.user=s.objectify({user:m,role:t.currentUser&&t.currentUser.userId===m.userId?_.myRole:m.role,isBlockedByMe:m.isBlockedByMe}),Ee.channel_url=_.url,Ee.channel_type=_.channelType===i.CHANNEL_TYPE_OPEN?i.CHANNEL_TYPE_OPEN:i.CHANNEL_TYPE_GROUP,Ee.url=v,Ee.name=E,Ee.type=C,Ee.size=S,Ee.custom=k,Ee.custom_type=U,Ee.thumbnails=ee,Ee.require_auth=ne,Ee.is_global_block=!!ue,Ee.ts=me,Ee.updated_at=ve,Ee.mention_type=T,Ee.mentioned_users=N.map((function(e){return a.objectify(e)})),Ee.mentioned_user_ids=M,Ee.requested_mention_user_ids=L,Ee.reactions=H.map((function(e){return e.serialize()})),Ee.metaarray={};for(var Ce=0;Ce<x.length;Ce++){var be=x[Ce].key;Ee.metaarray[be]=x[Ce].value}if(Ee.metaarray_key_order=x.map((function(e){return e.key})),Ee.root_message_id=B,Ee.parent_message_id=z,Ee.parent_message_text=V,Q&&(Ee.thread_info=c.objectify(Q)),Ee.is_reply_to_channel=J,X)switch(X.messageType){case i.MESSAGE_TYPE_USER:Ee.parent_message_info=o.objectify(X);break;case i.MESSAGE_TYPE_FILE:Ee.parent_message_info=l.objectify(X);break;case i.MESSAGE_TYPE_ADMIN:Ee.parent_message_info=u.objectify(X)}return Ee.sending_status=p>0?t.MessageSendingStatus.SUCCEEDED:t.MessageSendingStatus.FAILED,ie&&(Ee.sending_status=ie),Ee.silent=!!oe,Ee.error_code=se,Ee.message_survival_seconds=de,pe&&(Ee.og_tag=d.objectify(pe)),Ee.is_op_msg=!!ge,ye&&(Ee.apple_critical_alert_options=h.objectify(ye)),Ee}},{key:"build",value:function(e,t,n,i,r,s,a,o,l,u,c,d,h,p,f,g,y,m,_,v,E,C,b,S,A,k,I,U,O,T,R){return this.objectify({messageId:t,reqId:e,user:n,channel:i,plainUrl:r,name:s,type:a,size:o,data:l,customType:u,mentionType:m,mentionedUsers:_,mentionedUserIds:S,requestedMentionUserIds:k,reactions:y,metaArrays:g,rootMessageId:v,parentMessageId:E,parentMessageText:C,threadInfo:b,thumbnails:h,requireAuth:p,sendingStatus:A,errorCode:I,isGlobalBlocked:c,messageSurvivalSeconds:U,ogMetaData:O,isOperatorMessage:T,appleCriticalAlertOptions:R,createdAt:d,updatedAt:f})}},{key:"buildFromSerializedData",value:function(e){var t=G.get(this._iid).FileMessage,n=me.deserialize(e);return new t(t.objectify(d(d({},n),{},{channel:{url:n.channelUrl,channelType:n.channelType},user:n.sender})))}}]),n}(Ce),$e=function(e){m(n,e);var t=k(n);function n(e){var i;return p(this,n),(i=t.call(this,e)).messageType=Ce.MESSAGE_TYPE_ADMIN,i.message="",i.translations={},e&&i._update(e),i}return g(n,[{key:"_update",value:function(e){this.message=String(e.message),this.translations=e.hasOwnProperty("translations")?e.translations:{}}}],[{key:"objectify",value:function(e){var t=G.get(this._iid),n=t.BaseChannel,i=t.BaseMessageParams,r=t.UserMessage,s=t.FileMessage,a=t.AdminMessage,o=t.User,l=t.ThreadInfo,u=t.OGMetaData,c=e.messageId,d=e.channel,h=e.message,p=e.data,f=void 0===p?"":p,g=e.customType,y=void 0===g?"":g,m=e.mentionType,_=void 0===m?i.MentionType.USERS:m,v=e.mentionedUsers,E=void 0===v?[]:v,C=e.reactions,b=void 0===C?[]:C,S=e.metaArrays,A=void 0===S?[]:S,k=e.rootMessageId,I=void 0===k?0:k,U=e.parentMessageId,O=void 0===U?0:U,T=e.parentMessageText,R=void 0===T?"":T,N=e.threadInfo,w=void 0===N?null:N,M=e.isReplyToChannel,P=void 0!==M&&M,L=e.parentMessage,D=void 0===L?null:L,H=e.translations,F=void 0===H?{}:H,x=e.silent,j=void 0!==x&&x,B=e.ogMetaData,q=void 0===B?null:B,z=e.createdAt,Y=e.updatedAt,V=void 0===Y?0:Y,K={msg_id:c,channel_url:d.url,channel_type:d.channelType===n.CHANNEL_TYPE_OPEN?n.CHANNEL_TYPE_OPEN:n.CHANNEL_TYPE_GROUP,message:h,data:f,custom_type:y,silent:j,ts:z,updated_at:V};K.translations=F,K.mention_type=_,K.mentioned_users=E.map((function(e){return o.objectify(e)})),K.reactions=b.map((function(e){return e.serialize()})),K.metaarray={};for(var Q=0;Q<A.length;Q++){var W=A[Q].key;K.metaarray[W]=A[Q].value}if(K.metaarray_key_order=A.map((function(e){return e.key})),K.root_message_id=I,K.parent_message_id=O,K.parent_message_text=R,w&&(K.thread_info=l.objectify(w)),K.is_reply_to_channel=P,D)switch(D.messageType){case n.MESSAGE_TYPE_USER:K.parent_message_info=r.objectify(D);break;case n.MESSAGE_TYPE_FILE:K.parent_message_info=s.objectify(D);break;case n.MESSAGE_TYPE_ADMIN:K.parent_message_info=a.objectify(D)}return q&&(K.og_tag=u.objectify(q)),K}},{key:"build",value:function(e,t,n,i,r,s,a,o,l,u,c,d,h,p,f,g,y){return this.objectify({messageId:e,channel:t,message:n,data:i,customType:r,mentionType:c,mentionedUsers:d,reactions:u,metaArrays:l,rootMessageId:h,parentMessageId:p,parentMessageText:f,threadInfo:g,translations:s,ogMetaData:y,createdAt:a,updatedAt:o})}},{key:"buildFromSerializedData",value:function(e){var t=G.get(this._iid).AdminMessage,n=me.deserialize(e);return new t(t.objectify(d(d({},n),{},{channel:{url:n.channelUrl,channelType:n.channelType}})))}}]),n}(Ce),Xe=function(){function e(t){p(this,e);var n=G.get(this._iid),i=n.BaseMessage,r=n.BaseMessageParams;this.scheduledId=0,this.scheduledDateTimeString="",this.scheduledTimezone="",this.status=e.Status.SCHEDULED,this.createdAt=0,this.updatedAt=0,this._messageType=i.MESSAGE_TYPE_BASE,this._sender=null,this._channelType="",this.channelUrl="",this.message="",this.customType="",this.data="",this.metaArrays=[],this.mentionType=r.MentionType.USERS,this.mentionedUsers=[],this.pushNotificationDeliveryOption=r.PushNotificationDeliveryOption.DEFAULT,this.translationTargetLanguages=[],this.errorMessage="",this.errorCode=0,this.appleCriticalAlertOptions=null,t&&this._update(t)}return g(e,[{key:"sender",get:function(){var e=fn.getInstance(this._iid),t=G.get(this._iid).GroupChannel;if(e.Options.useMemberAsMessageSender&&this.isGroupChannel()){var n=t.cachedChannels[this.channelUrl];if(n){var i=n.memberMap[this._sender.userId];i&&(this._sender.nickname!==i.nickname&&(this._sender.nickname=i.nickname),this._sender.plainProfileUrl!==i.plainProfileUrl&&(this._sender.plainProfileUrl=i.plainProfileUrl),ee.deepEqual(this._sender.metaData,i.metaData)||(this._sender.metaData=i.metaData))}}return this._sender},set:function(e){this._sender=e}},{key:"_update",value:function(t){var n=this,i=G.get(this._iid),r=i.User,s=i.Sender,a=i.BaseMessageParams,o=i.MessageMetaArray,l=i.AppleCriticalAlertOptions;this.scheduledId=t.hasOwnProperty("scheduled_id")?parseInt(t.scheduled_id):0,this.scheduledDateTimeString=t.hasOwnProperty("scheduled_dt")?String(t.scheduled_dt):"",this.scheduledTimezone=t.hasOwnProperty("scheduled_timezone")?String(t.scheduled_timezone):"",this.status=t.hasOwnProperty("status")?String(t.status):"",this.createdAt=t.hasOwnProperty("created_at")?parseInt(t.created_at):0,this.updatedAt=t.hasOwnProperty("updated_at")?parseInt(t.updated_at):0,this.channelUrl=t.hasOwnProperty("channel_url")?String(t.channel_url):"",this._channelType=t.hasOwnProperty("channel_type")?String(t.channel_type):"",this._messageType=t.hasOwnProperty("type")?String(t.type):"",this._sender=t.hasOwnProperty("user")?new s(t.user):null,this.message=t.hasOwnProperty("message")?String(t.message):"",this.customType=t.hasOwnProperty("custom_type")?String(t.custom_type):"",this.data=t.hasOwnProperty("data")?String(t.data):"";var u=t.hasOwnProperty("metaarray")?t.metaarray:{},c=t.hasOwnProperty("metaarray_key_order")?t.metaarray_key_order:Object.keys(u).sort((function(e,t){return e.localeCompare(t)}));this.metaArrays=[];for(var d=0;d<c.length;d++){var h=c[d];this.metaArrays.push(new o(h,u[h]||[]))}this.mentionType=t.hasOwnProperty("mention_type")?t.mention_type:a.MentionType.USERS,this.mentionedUsers=[],t.hasOwnProperty("mentioned_users")&&t.mentioned_users.forEach((function(e){var t=new r(e);n.mentionedUsers.push(t)})),this.pushNotificationDeliveryOption=t.hasOwnProperty("push_option")?t.push_option:a.PushNotificationDeliveryOption.DEFAULT,this.translationTargetLanguages=t.hasOwnProperty("translation_target_langs")?t.translation_target_langs:[],this.status===e.Status.FAILED&&(t.hasOwnProperty("error")&&t.error.hasOwnProperty("message")&&(this.errorMessage=String(t.error.message)),t.hasOwnProperty("error")&&t.error.hasOwnProperty("code")&&(this.errorCode=parseInt(t.error.code))),t.hasOwnProperty("apple_critical_alert_options")&&(this.appleCriticalAlertOptions=new l(t.apple_critical_alert_options))}},{key:"isOpenChannel",value:function(){var e=G.get(this._iid).BaseChannel;return this._channelType===e.CHANNEL_TYPE_OPEN}},{key:"isGroupChannel",value:function(){var e=G.get(this._iid).BaseChannel;return this._channelType===e.CHANNEL_TYPE_GROUP}},{key:"metaArray",get:function(){var e={};return this.metaArrays.forEach((function(t){e[t.key]=t.value})),e},set:function(e){if("object"===h(e)&&e){var t=G.get(this._iid).MessageMetaArray,n=[];Object.keys(e).forEach((function(i){n.push(new t(i,e[i]))})),this.metaArrays=n}}}],[{key:"Status",get:function(){return{SCHEDULED:"scheduled",SENT:"sent",CANCELED:"canceled",FAILED:"failed"}}}]),e}(),Ze=function(){function e(){p(this,e),this.threadInfo=null,this.targetMessageId=0,this.channelUrl=null,this.channelType=null}return g(e,null,[{key:"createFromJson",value:function(e){var t=G.get(this._iid),n=t.BaseChannel,i=t.ThreadInfo,r=e.thread_info,s=e.root_message_id,a=e.channel_url,o=e.channel_type;if(r&&"object"===h(r)&&("string"==typeof s||"number"==typeof s)&&"string"==typeof a&&"string"==typeof o&&[n.CHANNEL_TYPE_GROUP,n.CHANNEL_TYPE_OPEN].includes(o)){var l=new this;return l.threadInfo=new i(r),l.targetMessageId=parseInt(s),l.channelUrl=a,l.channelType=o,l}return null}}]),e}(),et=function(){function e(){p(this,e),this.poll=null,this.status=null}return g(e,null,[{key:"createFromJson",value:function(e){var t=G.get(this._iid).Poll,n=e.poll;if("object"===h(n)){var i=new this;return i.poll=new t(n),i.status=n.status,i}return null}}]),e}(),tt=function(){function e(){p(this,e),this.pollId=null,this.updatedVoteCounts=null,this.votedAt=null}return g(e,null,[{key:"createFromJson",value:function(e){var t=e.poll_id,n=e.updated_vote_counts,i=e.ts;if("number"==typeof t&&Array.isArray(e.updated_vote_counts)&&"number"==typeof i){var r=new this;return r.pollId=t,r.updatedVoteCounts=n.map((function(e){return{optionId:e.option_id,voteCount:e.vote_count}})),r.votedAt=i,r}return null}}]),e}(),nt=function(){function e(){p(this,e),this.isLoading=!1,this.hasNext=!0,this.limit=20,this.userIdsFilter=[],this.metaDataKeyFilter="",this.metaDataValuesFilter=[],this.nicknameStartsWithFilter=null,this._token=""}return g(e,[{key:"next",value:function(e){var t=this;return _e(this._iid,(function(e){"number"==typeof t.limit&&t.limit>0&&Array.isArray(t.userIdsFilter)&&"string"==typeof t.metaDataKeyFilter&&Array.isArray(t.metaDataValuesFilter)&&!!t.metaDataKeyFilter==t.metaDataValuesFilter.length>0&&("string"==typeof t.nicknameStartsWithFilter||null===t.nicknameStartsWithFilter)?t.isLoading?e(new D("Query in progress.",D.QUERY_IN_PROGRESS),null):t.hasNext?(t.isLoading=!0,L.get(t._iid).container.apiClient.loadUserList(d(d({},t),{},{token:t._token}),(function(n,i){var r=null;if(!n){var s=G.get(t._iid).User,a=String(i.next);t._token=a,t.hasNext=!!a,r=i.users.map((function(e){return new s(e)}))}t.isLoading=!1,e(n,r)}))):e(null,[]):e(ae.error,null)}),e)}}]),e}(),it=function(){function e(t){p(this,e),this.isLoading=!1,this.hasNext=!0,this.limit=20,this._isOpenChannel=!1,this._channelUrl=null,this._token="",t.channelUrl&&(this._channelUrl=t.channelUrl),t.isOpenChannel&&(this._isOpenChannel=t.isOpenChannel)}return g(e,[{key:"next",value:function(e){var t=this;return _e(this._iid,(function(e){"number"==typeof t.limit&&t.limit>0?t.isLoading?e(new D("Query in progress.",D.QUERY_IN_PROGRESS),null):t.hasNext?(t.isLoading=!0,L.get(t._iid).container.apiClient.loadBannedUserList(d(d({},t),{},{channelUrl:t._channelUrl,isOpenChannel:t._isOpenChannel,token:t._token}),(function(n,i){var r=null;if(!n){var s=G.get(t._iid).RestrictedUser,a=String(i.next);t._token=a,t.hasNext=!!a,r=i.banned_list.map((function(e){var t=new s(e);return t.restrictionInfo.restrictionType=s.RestrictionType.BANNED,t}))}t.isLoading=!1,e(n,r)}))):e(null,[]):e(ae.error,null)}),e)}}]),e}(),rt=function(){function e(){p(this,e),this.isLoading=!1,this.hasNext=!0,this.limit=20,this.userIdsFilter=[],this._token=""}return g(e,[{key:"next",value:function(e){var t=this;return _e(this._iid,(function(e){"number"==typeof t.limit&&t.limit>0&&Array.isArray(t.userIdsFilter)?t.isLoading?e(new D("Query in progress.",D.QUERY_IN_PROGRESS),null):t.hasNext?(t.isLoading=!0,L.get(t._iid).container.apiClient.loadBlockedUserList(d(d({},t),{},{token:t._token}),(function(n,i){var r=null;if(!n){var s=G.get(t._iid).User,a=String(i.next);t._token=a,t.hasNext=!!a,r=i.users.map((function(e){return new s(e)}))}t.isLoading=!1,e(n,r)}))):e(null,[]):e(ae.error,null)}),e)}}]),e}(),st=function(){function e(){p(this,e),this.isLoading=!1,this.hasMore=!0,this.limit=20,this._token=""}return g(e,[{key:"next",value:function(e){var t=this;return _e(this._iid,(function(e){"number"==typeof t.limit&&t.limit>0?t.isLoading?e(new D("Query in progress.",D.QUERY_IN_PROGRESS),null):t.hasMore?(t.isLoading=!0,L.get(t._iid).container.apiClient.loadFriendList(d(d({},t),{},{token:t._token}),(function(n,i){var r=null;if(!n){var s=G.get(t._iid).User,a=String(i.next);t._token=a,t.hasMore=!!a,r=i.users.map((function(e){return new s(e)}))}t.isLoading=!1,e(n,r)}))):e(null,[]):e(ae.error,null)}),e)}}]),e}(),at=function(){function e(){p(this,e),this.isLoading=!1,this.hasNext=!0,this.limit=20,this.includeEmpty=!1,this.order=e.ORDER_LATEST_LAST_MESSAGE,this._token="",this._searchFilter={},this._userIdsFilter={userIds:[],includeMode:!0,queryType:e.QueryType.AND},this._userIdsExactFilter=[],this._userIdsIncludeFilter=[],this._userIdsIncludeFilterQueryType=e.QueryType.AND,this.nicknameContainsFilter="",this.channelNameContainsFilter="",this.memberStateFilter=Fe.MemberStateFilter.ALL,this.customTypesFilter=[],this.channelUrlsFilter=[],this.superChannelFilter=Fe.SuperChannelFilter.ALL,this.publicChannelFilter=Fe.PublicChannelFilter.ALL,this.customTypeStartsWithFilter=null,this.unreadChannelFilter=Fe.UnreadChannelFilter.ALL,this.metadataOrderKeyFilter=null,this.metadataKey=null,this.metadataValues=[],this.metadataValueStartsWith=null,this.hiddenChannelFilter=Fe.HiddenChannelFilter.UNHIDDEN,this.includeFrozen=!0,this.includeMetaData=!0}return g(e,[{key:"userIdsExactFilter",get:function(){return this._userIdsExactFilter},set:function(e){Array.isArray(e)&&(this._userIdsExactFilter=e,this._userIdsIncludeFilter=[],this._userIdsFilter.userIds=this._userIdsExactFilter,this._userIdsFilter.includeMode=!1)}},{key:"userIdsIncludeFilter",get:function(){return this._userIdsIncludeFilter},set:function(e){Array.isArray(e)&&(this._userIdsIncludeFilter=e,this._userIdsExactFilter=[],this._userIdsFilter.userIds=this._userIdsIncludeFilter,this._userIdsFilter.includeMode=!0)}},{key:"userIdsIncludeFilterQueryType",get:function(){return this._userIdsIncludeFilterQueryType},set:function(t){Object.keys(e.QueryType).map((function(t){return e.QueryType[t]})).indexOf(t)>-1&&(this._userIdsIncludeFilterQueryType=t.toUpperCase(),this._userIdsFilter.queryType=this._userIdsIncludeFilterQueryType)}},{key:"setSearchFilter",value:function(e,t){Array.isArray(e)&&0!==e.length&&"string"==typeof t&&t&&(this._searchFilter={search_query:t,search_fields:e.join(",").toLocaleLowerCase()})}},{key:"serialize",value:function(){return me.serialize(this,(function(e){e.isLoading=!1}))}},{key:"next",value:function(e){var t=this;return _e(this._iid,(function(e){var n=G.get(t._iid),i=n.GroupChannel,r=n.GroupChannelListQuery;!("number"==typeof t.limit&&t.limit>0&&"boolean"==typeof t.includeEmpty&&"string"==typeof t.order&&[r.ORDER_CHRONOLOGICAL,r.ORDER_LATEST_LAST_MESSAGE,r.CHANNEL_NAME_ALPHABETICAL,r.METADATA_VALUE_ALPHABETICAL].indexOf(t.order.toLowerCase())>-1&&Array.isArray(t._userIdsExactFilter)&&Array.isArray(t._userIdsIncludeFilter)&&Array.isArray(t.customTypesFilter)&&Array.isArray(t.channelUrlsFilter)&&Object.keys(r.QueryType).map((function(e){return r.QueryType[e]})).indexOf(t._userIdsIncludeFilterQueryType.toUpperCase())>-1&&Object.keys(i.MemberStateFilter).map((function(e){return i.MemberStateFilter[e]})).indexOf(t.memberStateFilter)>-1&&Object.keys(i.SuperChannelFilter).map((function(e){return i.SuperChannelFilter[e]})).indexOf(t.superChannelFilter)>-1&&Object.keys(i.PublicChannelFilter).map((function(e){return i.PublicChannelFilter[e]})).indexOf(t.publicChannelFilter)>-1&&Object.keys(i.UnreadChannelFilter).map((function(e){return i.UnreadChannelFilter[e]})).indexOf(t.unreadChannelFilter)>-1&&Object.keys(i.HiddenChannelFilter).map((function(e){return i.HiddenChannelFilter[e]})).indexOf(t.hiddenChannelFilter)>-1)||"string"!=typeof t.customTypeStartsWithFilter&&null!==t.customTypeStartsWithFilter||"string"!=typeof t.nicknameContainsFilter||"string"!=typeof t.channelNameContainsFilter||"string"!=typeof t.metadataOrderKeyFilter&&null!==t.metadataOrderKeyFilter||"string"!=typeof t.metadataKey&&null!==t.metadataKey||!Array.isArray(t.metadataValues)||!t.metadataValues.every((function(e){return"string"==typeof e}))||"string"!=typeof t.metadataValueStartsWith&&null!==t.metadataValueStartsWith||"boolean"!=typeof t.includeFrozen||"boolean"!=typeof t.includeMetaData?e(ae.error,null):t.isLoading?e(new D("Query in progress.",D.QUERY_IN_PROGRESS),null):t.hasNext?(t.isLoading=!0,L.get(t._iid).container.apiClient.loadGroupChannelList(d(d({},t),{},{token:t._token,userIdsFilter:t._userIdsFilter,searchFilter:t._searchFilter}),(function(n,i){var r=null;if(!n){var s=G.get(t._iid).GroupChannel,a=String(i.next);t._token=a,t.hasNext=!!a;var o=i.channels;o&&Array.isArray(o)?r=o.map((function(e){return"number"==typeof i.ts&&(e.ts=i.ts),s.upsert(e)})):n=new D("Failed at loading group channels.",D.MALFORMED_DATA)}t.isLoading=!1,e(n,r)}))):e(null,[])}),e)}}],[{key:"ORDER_LATEST_LAST_MESSAGE",get:function(){return"latest_last_message"}},{key:"ORDER_CHRONOLOGICAL",get:function(){return"chronological"}},{key:"CHANNEL_NAME_ALPHABETICAL",get:function(){return"channel_name_alphabetical"}},{key:"METADATA_VALUE_ALPHABETICAL",get:function(){return"metadata_value_alphabetical"}},{key:"QueryType",get:function(){return{AND:"AND",OR:"OR"}}},{key:"SearchField",get:function(){return{MEMBER_NICKNAME:"member_nickname",CHANNEL_NAME:"channel_name"}}},{key:"buildFromSerializedData",value:function(e){var t=G.get(this._iid).GroupChannel,n=me.deserialize(e),i=t.createMyGroupChannelListQuery();return Object.keys(n).forEach((function(e){i.hasOwnProperty(e)&&(i[e]=n[e])})),i}}]),e}(),ot=function(){function e(t){p(this,e),this.isLoading=!1,this.hasNext=!0,this.limit=20,this.mutedMemberFilter=e.MutedMemberFilter.ALL,this.memberStateFilter=Fe.MemberStateFilter.ALL,this.nicknameStartsWithFilter=null,this.order=e.Order.MEMBER_NICKNAME_ALPHABETICAL,this._token="",this._channelUrl=t}return g(e,[{key:"next",value:function(e){var t=this;return _e(this._iid,(function(e){var n=G.get(t._iid),i=n.GroupChannel,r=n.Member,s=n.MemberListQuery;"number"==typeof t.limit&&t.limit>0&&Object.keys(s.MutedMemberFilter).map((function(e){return s.MutedMemberFilter[e]})).indexOf(t.mutedMemberFilter)>-1&&Object.keys(i.MemberStateFilter).map((function(e){return i.MemberStateFilter[e]})).indexOf(t.memberStateFilter)>-1&&Object.keys(s.Order).map((function(e){return s.Order[e]})).indexOf(t.order)>-1&&("string"==typeof t.nicknameStartsWithFilter||null===t.nicknameStartsWithFilter)?t.isLoading?e(new D("Query in progress.",D.QUERY_IN_PROGRESS),null):t.hasNext?(t.isLoading=!0,L.get(t._iid).container.apiClient.loadMemberList(d(d({},t),{},{channelUrl:t._channelUrl,token:t._token}),(function(n,i){var s=null;if(!n){var a=String(i.next);t._token=a,t.hasNext=!!a,s=i.members.map((function(e){return new r(e)}))}t.isLoading=!1,e(n,s)}))):e(null,[]):e(ae.error,null)}),e)}}],[{key:"MutedMemberFilter",get:function(){return{ALL:"all",MUTED:"muted",UNMUTED:"unmuted"}}},{key:"Order",get:function(){return{MEMBER_NICKNAME_ALPHABETICAL:"member_nickname_alphabetical",OPERATOR_THEN_MEMBER_ALPHABETICAL:"operator_then_member_alphabetical"}}}]),e}(),lt=function(){function e(t){p(this,e),this.isLoading=!1,this.hasNext=!0,this.limit=20,this._token="",t.channelUrl&&(this._channelUrl=t.channelUrl),t.isOpenChannel&&(this._isOpenChannel=t.isOpenChannel)}return g(e,[{key:"next",value:function(e){var t=this;return _e(this._iid,(function(e){"number"==typeof t.limit&&t.limit>0?t.isLoading?e(new D("Query in progress.",D.QUERY_IN_PROGRESS),null):t.hasNext?(t.isLoading=!0,L.get(t._iid).container.apiClient.loadMutedUserList(d(d({},t),{},{channelUrl:t._channelUrl,isOpenChannel:t._isOpenChannel,token:t._token}),(function(n,i){var r=null;if(!n){var s=G.get(t._iid).RestrictedUser,a=String(i.next);t._token=a,t.hasNext=!!a,r=i.muted_list.map((function(e){var t=new s(e);return t.restrictionInfo.restrictionType=s.RestrictionType.MUTED,t}))}t.isLoading=!1,e(n,r)}))):e(null,[]):e(ae.error,null)}),e)}}]),e}(),ut=function(){function e(){p(this,e),this.limit=20,this.isLoading=!1,this.hasNext=!0,this.nameKeyword=null,this.urlKeyword=null,this.customTypes=[],this.includeFrozen=!0,this.includeMetaData=!0}return g(e,[{key:"next",value:function(e){var t=this;return _e(this._iid,(function(e){!("number"==typeof t.limit&&t.limit>0&&Array.isArray(t.customTypes))||"string"!=typeof t.nameKeyword&&null!==t.nameKeyword||"string"!=typeof t.urlKeyword&&null!==t.urlKeyword||"boolean"!=typeof t.includeFrozen||"boolean"!=typeof t.includeMetaData?e(ae.error,null):t.isLoading?e(new D("Query in progress.",D.QUERY_IN_PROGRESS),null):t.hasNext?(t.isLoading=!0,L.get(t._iid).container.apiClient.loadOpenChannelList(d(d({},t),{},{token:t._token}),(function(n,i){var r=null;if(!n){var s=G.get(t._iid).OpenChannel,a=String(i.next);t._token=a,t.hasNext=!!a;var o=i.channels;o&&Array.isArray(o)?r=o.map((function(e){return"number"==typeof i.ts&&(e.ts=i.ts),s.upsert(e)})):n=new D("Failed at loading open channels.",D.MALFORMED_DATA)}t.isLoading=!1,e(n,r)}))):e(null,[])}),e)}}]),e}(),ct=new WeakMap,dt=function(){function e(t){p(this,e),this.isLoading=!1,this.hasNext=!0,this.limit=20,this._token="",ct.set(this,t)}return g(e,[{key:"next",value:function(e){var t=this;return _e(this._iid,(function(e){if("number"==typeof t.limit&&t.limit>0)if(t.isLoading)e(new D("Query in progress.",D.QUERY_IN_PROGRESS),null);else if(t.hasNext){t.isLoading=!0;var n=ct.get(t);L.get(t._iid).container.apiClient.loadOperatorList(d(d({},t),{},{token:t._token,channelUrl:n.url,isOpenChannel:n.isOpenChannel()}),(function(n,i){var r=null;if(!n){var s=G.get(t._iid).User,a=String(i.next);t._token=a,t.hasNext=!!a,r=i.operators.map((function(e){return new s(e)}))}t.isLoading=!1,e(n,r)}))}else e(null,[]);else e(ae.error,null)}),e)}}]),e}(),ht=new WeakMap,pt=function(){function e(t){p(this,e),this.isLoading=!1,this.hasNext=!0,this.limit=20,this._token="",t&&ht.set(this,t.channelUrl)}return g(e,[{key:"next",value:function(e){var t=this;return _e(this._iid,(function(e){"number"==typeof t.limit&&t.limit>0?t.isLoading?e(new D("Query in progress.",D.QUERY_IN_PROGRESS),null):t.hasNext?(t.isLoading=!0,L.get(t._iid).container.apiClient.loadParticipantList(d(d({},t),{},{channelUrl:ht.get(t),token:t._token}),(function(n,i){var r=null;if(!n){var s=G.get(t._iid).User,a=String(i.next);t._token=a,t.hasNext=!!a,r=i.participants.map((function(e){return new s(e)}))}t.isLoading=!1,e(n,r)}))):e(null,[]):e(ae.error,null)}),e)}}]),e}(),ft=new WeakMap,gt=function(){function e(t,n){var i=n.limit,r=void 0===i?20:i,s=n.reverse,a=void 0!==s&&s,o=n.exactMatch,l=void 0!==o&&o,u=n.channelUrl,c=void 0===u?"":u,d=n.channelCustomType,h=void 0===d?"":d,f=n.messageTimestampFrom,g=void 0===f?null:f,y=n.messageTimestampTo,m=void 0===y?null:y,_=n.order,v=void 0===_?"score":_,E=n.advancedQuery,C=void 0!==E&&E,b=n.targetFields,S=void 0===b?null:b;p(this,e),this.isLoading=!1,this.hasNext=!0,ft.set(this,{keyword:t,limit:r,reverse:a,exactMatch:l,channelUrl:c,channelCustomType:h,messageTimestampFrom:g,messageTimestampTo:m,order:v,advancedQuery:C,targetFields:S,previousToken:"",nextToken:""})}return g(e,[{key:"key",get:function(){return ft.get(this).keyword}},{key:"limit",get:function(){return ft.get(this).limit}},{key:"reverse",get:function(){return ft.get(this).reverse}},{key:"exactMatch",get:function(){return ft.get(this).exactMatch}},{key:"channelUrl",get:function(){return ft.get(this).channelUrl}},{key:"channelCustomType",get:function(){return ft.get(this).channelCustomType}},{key:"messageTimestampFrom",get:function(){return ft.get(this).messageTimestampFrom}},{key:"messageTimestampTo",get:function(){return ft.get(this).messageTimestampTo}},{key:"order",get:function(){return ft.get(this).order}},{key:"next",value:function(e){var t=this,n=G.get(this._iid),i=n.BaseChannel,r=n.GroupChannel,s=n.OpenChannel;return _e(this._iid,(function(e){var n=ft.get(t),a=n.keyword,o=n.limit,l=n.reverse,u=n.exactMatch,c=n.channelUrl,d=n.channelCustomType,h=n.messageTimestampFrom,p=n.messageTimestampTo,f=n.order,g=n.advancedQuery,y=n.targetFields,m=n.nextToken;!("number"==typeof o&&o>0&&o<=1e3&&"boolean"==typeof l&&"boolean"==typeof u)||"string"!=typeof c&&null!==c||"string"!=typeof d&&null!==d||"number"!=typeof h&&null!==h||"number"!=typeof p&&null!==p||!(["score","ts"].indexOf(f)>=0)||"boolean"!=typeof g&&null!==g||!Array.isArray(y)&&null!==y?e(ae.error,null):t.isLoading?e(new D("Query in progress.",D.QUERY_IN_PROGRESS),null):t.hasNext?(t.isLoading=!0,L.get(t._iid).container.apiClient.searchMessages({keyword:a,limit:o,reverse:l,exactMatch:u,channelUrl:c,channelCustomType:d,messageTimestampFrom:h,messageTimestampTo:p,order:f,advancedQuery:g,targetFields:y,nextToken:m},(function(n,a){var o=null;n||(o=[],a.results.forEach((function(e){if(e.channel.hasOwnProperty("members")){var t=new r(e.channel);r.cachedChannels[t.url]=t,o.push(i.buildMessage(e,t))}else{var n=new s(e.channel);s.cachedChannels[n.url]=n,o.push(i.buildMessage(e,n))}})),t.hasNext=a.has_next,ft.get(t).nextToken=a.end_cursor),t.isLoading=!1,e(n,o)}))):e(null,[])}),e)}}]),e}(),yt=new WeakMap,mt=new WeakMap,_t=function(){function e(t){p(this,e),this.isLoading=!1,this.hasMore=!0,this.limit=20,mt.set(this,Number.MAX_SAFE_INTEGER),yt.set(this,t),this.reverse=!1,this.messageTypeFilter=null,this.customTypeFilter=null,this.customTypesFilter=[],this.senderUserIdsFilter=[],this.includeMetaArray=!1,this.includeReaction=null,this.includeReactions=null,this.includeReplies=null,this.includeParentMessageText=null,this.includeThreadInfo=!1,this.replyType=null,this.includeParentMessageInfo=null,this.showSubchannelMessagesOnly=!1,this.includePollDetails=!1}return g(e,[{key:"load",value:function(e,t,n,i){var r=this,s=G.get(this._iid),a=s.BaseChannel,o=s.BaseMessage,l=null,u=ae.parse(arguments,[new ae({type:"number",optional:!0,defaultValue:this.limit}),new ae({type:"boolean",optional:!0,defaultValue:this.reverse}),new ae({type:["string","number"],optional:!0,defaultValue:this.messageTypeFilter,constraint:function(e){return Object.keys(a.MessageTypeFilter).map((function(e){return a.MessageTypeFilter[e]})).indexOf(e)>-1||[0,1,2,3].indexOf(e)>-1}}),new ae({type:"callback"})]),c=U(u,5);return l=c[0],e=c[1],t=c[2],n=c[3],i=c[4],_e(this._iid,(function(i){if(("string"!=typeof r.customTypeFilter&&null!==r.customTypeFilter||!Array.isArray(r.customTypesFilter)||!r.customTypesFilter.every((function(e){return"string"==typeof e||null===e}))||!Array.isArray(r.senderUserIdsFilter)||!r.senderUserIdsFilter.every((function(e){return"string"==typeof e}))||"boolean"!=typeof r.includeMetaArray||null!==r.includeReaction&&"boolean"!=typeof r.includeReaction||null!==r.includeReactions&&"boolean"!=typeof r.includeReactions||"boolean"!=typeof r.includeThreadInfo||null!==r.includeReplies&&"boolean"!=typeof r.includeReplies||!(null===r.replyType||"string"==typeof r.replyType&&Object.values(o.ReplyType).includes(r.replyType))||null!==r.includeParentMessageText&&"boolean"!=typeof r.includeParentMessageText||null!==r.includeParentMessageInfo&&"boolean"!=typeof r.includeParentMessageInfo||"boolean"!=typeof r.showSubchannelMessagesOnly)&&(l=ae.error),l)i(l,null);else{if(r.limit=e,r.reverse=t,r.messageTypeFilter=n,"number"==typeof r.messageTypeFilter)switch(r.messageTypeFilter){case 0:r.messageTypeFilter=a.MessageTypeFilter.ALL;break;case 1:r.messageTypeFilter=a.MessageTypeFilter.USER;break;case 2:r.messageTypeFilter=a.MessageTypeFilter.FILE;break;case 3:r.messageTypeFilter=a.MessageTypeFilter.ADMIN}if(r.isLoading)i(new D("Query in progress.",D.QUERY_IN_PROGRESS),null);else if(r.hasMore){r.isLoading=!0;var s=yt.get(r);L.get(r._iid).container.apiClient.getMessageList({channel:s,token:mt.get(r)||(new Date).getTime()+1e4,tokenType:"timestamp",isInclusive:!1,prevResultSize:e,nextResultSize:0,shouldReverse:t,messageType:r.messageTypeFilter,customType:r.customTypeFilter,customTypes:r.customTypesFilter,senderUserIds:r.senderUserIdsFilter,includeMetaArray:r.includeMetaArray,includeReaction:r.includeReaction,includeReactions:r.includeReactions,includeReplies:r.includeReplies,includeParentMessageText:r.includeParentMessageText,includeThreadInfo:r.includeThreadInfo,replyType:r.replyType,includeParentMessageInfo:r.includeParentMessageInfo,showSubchannelMessagesOnly:r.showSubchannelMessagesOnly,includePollDetails:r.includePollDetails},(function(t,n){var o=null;if(!t){(0===(o=n.messages.map((function(e){return a.buildMessage(e,s)}))).length||o.length<e)&&(r.hasMore=!1);var l=mt.get(r);mt.set(r,Math.min.apply(Math,O(o.map((function(e){return e.createdAt}))).concat([l])))}r.isLoading=!1,i(t,o)}))}else i(null,[])}}),i)}}]),e}(),vt=function(){function e(){p(this,e),this.isLoading=!1,this.hasNext=!0,this.limit=20,this.includeEmpty=!1,this.order=at.ORDER_LATEST_LAST_MESSAGE,this._token="",this.channelNameContainsFilter="",this.channelUrlsFilter=[],this.customTypesFilter=[],this.customTypeStartsWithFilter=null,this.superChannelFilter=Fe.SuperChannelFilter.ALL,this.membershipFilter=e.MembershipType.JOINED,this.metadataOrderKeyFilter=null,this.metadataKey=null,this.metadataValues=[],this.metadataValueStartsWith=null,this.includeFrozen=!0,this.includeMetaData=!0}return g(e,[{key:"next",value:function(t){var n=this;return _e(this._iid,(function(t){var i=G.get(n._iid).GroupChannel;!("number"==typeof n.limit&&n.limit>0&&"boolean"==typeof n.includeEmpty&&"string"==typeof n.order&&[e.ORDER_CHRONOLOGICAL,e.CHANNEL_NAME_ALPHABETICAL,e.METADATA_VALUE_ALPHABETICAL,e.ORDER_LATEST_LAST_MESSAGE].indexOf(n.order.toLowerCase())>-1&&Array.isArray(n.customTypesFilter)&&Array.isArray(n.channelUrlsFilter)&&Object.keys(e.MembershipType).map((function(t){return e.MembershipType[t]})).indexOf(n.membershipFilter)>-1&&Object.keys(i.SuperChannelFilter).map((function(e){return i.SuperChannelFilter[e]})).indexOf(n.superChannelFilter)>-1)||"string"!=typeof n.customTypeStartsWithFilter&&null!==n.customTypeStartsWithFilter||"string"!=typeof n.channelNameContainsFilter||"string"!=typeof n.metadataOrderKeyFilter&&null!==n.metadataOrderKeyFilter||"string"!=typeof n.metadataKey&&null!==n.metadataKey||!Array.isArray(n.metadataValues)||!n.metadataValues.every((function(e){return"string"==typeof e}))||"string"!=typeof n.metadataValueStartsWith&&null!==n.metadataValueStartsWith||"boolean"!=typeof n.includeFrozen||"boolean"!=typeof n.includeMetaData?t(ae.error,null):n.isLoading?t(new D("Query in progress.",D.QUERY_IN_PROGRESS),null):n.hasNext?(n.isLoading=!0,L.get(n._iid).container.apiClient.loadPublicGroupChannelList(d(d({},n),{},{token:n._token}),(function(e,r){var s=null;if(!e){var a=String(r.next);n._token=a,n.hasNext=!!a;var o=r.channels;o&&Array.isArray(o)?s=o.map((function(e){return"number"==typeof r.ts&&(e.ts=r.ts),i.upsert(e)})):e=new D("Failed at loading group channels.",D.MALFORMED_DATA)}n.isLoading=!1,t(e,s)}))):t(null,[])}),t)}}],[{key:"MembershipType",get:function(){return{ALL:"all",JOINED:"joined"}}},{key:"ORDER_LATEST_LAST_MESSAGE",get:function(){return"latest_last_message"}},{key:"ORDER_CHRONOLOGICAL",get:function(){return"chronological"}},{key:"CHANNEL_NAME_ALPHABETICAL",get:function(){return"channel_name_alphabetical"}},{key:"METADATA_VALUE_ALPHABETICAL",get:function(){return"metadata_value_alphabetical"}}]),e}(),Et=new WeakMap,Ct=new WeakMap,bt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.channelUrl,i=void 0===n?null:n,r=t.token,s=void 0===r?"":r,a=t.limit,o=void 0===a?20:a;p(this,e),this.channelUrl=i,this.token=s,this.limit=o,Et.set(this,!1),Ct.set(this,!0)}return g(e,[{key:"isLoading",get:function(){return!!Et.get(this)}},{key:"hasNext",get:function(){return!!Ct.get(this)}},{key:"next",value:function(e){var t=this;return _e(this._iid,(function(e){"string"==typeof t.channelUrl&&"number"==typeof t.limit&&t.limit>0&&t.limit<=100?t.isLoading?e(new D("Query in progress.",D.QUERY_IN_PROGRESS),null):t.hasNext?(Et.set(t,!0),L.get(t._iid).container.apiClient.getPollList(d({},t),(function(n,i){if(n)Et.set(t,!1),e(n,null);else{var r=G.get(t._iid).Poll,s=i.hasOwnProperty("polls")&&Array.isArray(i.polls)?i.polls.map((function(e){return new r(e)})):[],a=i.hasOwnProperty("next")&&i.next?String(i.next):"";t.token=a,Et.set(t,!1),Ct.set(t,!!a),e(null,s)}}))):e(null,[]):e(ae.error,null)}),e)}}]),e}(),St=new WeakMap,At=new WeakMap,kt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.channelUrl,i=void 0===n?null:n,r=t.pollId,s=void 0===r?null:r,a=t.optionId,o=void 0===a?null:a,l=t.token,u=void 0===l?"":l,c=t.limit,d=void 0===c?100:c;p(this,e),this.channelUrl=i,this.pollId=s,this.optionId=o,this.token=u,this.limit=d,St.set(this,!1),At.set(this,!0)}return g(e,[{key:"isLoading",get:function(){return!!St.get(this)}},{key:"hasNext",get:function(){return!!At.get(this)}},{key:"next",value:function(e){var t=this;return _e(this._iid,(function(e){"string"==typeof t.channelUrl&&"number"==typeof t.pollId&&"number"==typeof t.optionId&&"number"==typeof t.limit&&t.limit>0&&t.limit<=100?t.isLoading?e(new D("Query in progress.",D.QUERY_IN_PROGRESS),null):t.hasNext?(St.set(t,!0),L.get(t._iid).container.apiClient.getPollOptionVoterList(d({},t),(function(n,i){if(n)St.set(t,!1),e(n,null);else{var r=G.get(t._iid).User,s=i.hasOwnProperty("voters")&&Array.isArray(i.voters)?i.voters.map((function(e){return new r(e)})):[],a=i.hasOwnProperty("next")&&i.next?String(i.next):"";t.token=a,St.set(t,!1),At.set(t,!!a),e(null,s)}}))):e(null,[]):e(ae.error,null)}),e)}}]),e}(),It=function(){function e(){p(this,e),this.isDistinct=null,this.isSuper=null,this.isBroadcast=null,this.isPublic=null,this.channelUrl=null,this.isEphemeral=null,this.isDiscoverable=null,this.isStrict=null,this.name=null,this.data=null,this.customType=null,this.channelCover=null,this.coverUrl=null,this.coverImage=null,this.accessCode=null,this.messageSurvivalSeconds=null,this._invitedUserIds=[];var t=null;Object.defineProperty(this,"operators",{set:function(e){Array.isArray(e)&&e.filter((function(e){return e.hasOwnProperty("userId")})).length===e.length&&(t=e.map((function(e){return e.userId})))}}),Object.defineProperty(this,"operatorUserIds",{get:function(){return t},set:function(e){Array.isArray(e)&&e.filter((function(e){return"string"==typeof e})).length===e.length&&(t=e)}})}return g(e,[{key:"_validate",value:function(){return Array.isArray(this._invitedUserIds)&&this._invitedUserIds.every((function(e){return"string"==typeof e}))&&("string"==typeof this.channelUrl||null===this.channelUrl)&&("string"==typeof this.coverUrl||null===this.coverUrl)&&(ee.isFile(this.coverImage)||null===this.coverImage)&&("string"==typeof this.name||null===this.name)&&("string"==typeof this.data||null===this.data)&&("string"==typeof this.customType||null===this.customType)&&("boolean"==typeof this.isDistinct||null===this.isDistinct)&&("boolean"==typeof this.isSuper||null===this.isSuper)&&("boolean"==typeof this.isBroadcast||null===this.isBroadcast)&&("boolean"==typeof this.isPublic||null===this.isPublic)&&("boolean"==typeof this.isEphemeral||null===this.isEphemeral)&&("boolean"==typeof this.isDiscoverable||null===this.isDiscoverable)&&("boolean"==typeof this.isStrict||null===this.isStrict)&&(Array.isArray(this.operatorUserIds)&&this.operatorUserIds.every((function(e){return"string"==typeof e}))||null===this.operatorUserIds)&&("string"==typeof this.accessCode||null===this.accessCode)&&("number"==typeof this.messageSurvivalSeconds||null===this.messageSurvivalSeconds)}},{key:"addUsers",value:function(e){if(Array.isArray(e)){var t,n=e.filter((function(e){return e.hasOwnProperty("userId")&&"string"==typeof e.userId})).map((function(e){return e.userId}));(t=this._invitedUserIds).push.apply(t,O(n))}}},{key:"addUser",value:function(e){e.hasOwnProperty("userId")&&"string"==typeof e.userId&&this._invitedUserIds.push(e.userId)}},{key:"addUserIds",value:function(e){if(Array.isArray(e)){var t,n=e.filter((function(e){return"string"==typeof e}));(t=this._invitedUserIds).push.apply(t,O(n))}}},{key:"addUserId",value:function(e){"string"==typeof e&&this._invitedUserIds.push(e)}}]),e}(),Ut=function(){function e(){p(this,e),this.channelUrl=null,this.name=null,this.coverUrlOrImage=null,this.data=null,this.customType=null,this._operatorUserIds=[]}return g(e,[{key:"operatorUserIds",get:function(){return this._operatorUserIds},set:function(e){Array.isArray(e)&&e.every((function(e){return"string"==typeof e}))&&(this._operatorUserIds=e)}},{key:"operators",set:function(e){Array.isArray(e)&&e.every((function(e){return e.hasOwnProperty("userId")}))&&(this._operatorUserIds=e.map((function(e){return e.userId})))}},{key:"_validate",value:function(){return(Array.isArray(this.operatorUserIds)&&this.operatorUserIds.every((function(e){return"string"==typeof e}))||null===this.operatorUserIds)&&("string"==typeof this.coverUrlOrImage||ee.isFile(this.coverUrlOrImage)||null===this.coverUrlOrImage)&&("string"==typeof this.name||null===this.name)&&("string"==typeof this.data||null===this.data)&&("string"==typeof this.customType||null===this.customType)&&("string"==typeof this.channelUrl&&/^\w+$/.test(this.channelUrl)||null===this.channelUrl)}}]),e}(),Ot=new WeakMap,Tt=function(){function e(){p(this,e),this._mentionType=e.MentionType.USERS,this._mentionedUserIds=[],this._cachedMentionedUsers=[],this._cachedMentionedUserIds=[],this._metaArrays=[],Ot.set(this,null),this._parentMessageId=null,this.isReplyToChannel=!1}return g(e,[{key:"mentionType",get:function(){return this._mentionType},set:function(e){var t=G.get(this._iid).BaseMessageParams;Object.keys(t.MentionType).map((function(e){return t.MentionType[e]})).indexOf(e)>-1&&(this._mentionType=e)}},{key:"mentionedUserIds",get:function(){return this._cachedMentionedUserIds},set:function(e){if(Array.isArray(e))for(var t=fn.getInstance(this._iid),n=0;n<e.length;n++){var i=e[n];if("string"!=typeof i){this._cachedMentionedUserIds=[],this._mentionedUserIds=[];break}this._mentionedUserIds.indexOf(i)<0&&t.currentUser&&t.currentUser.userId!==i&&(this._cachedMentionedUserIds.push(i),this._mentionedUserIds.push(i))}}},{key:"mentionedUsers",get:function(){return this._cachedMentionedUsers},set:function(e){if(Array.isArray(e))for(var t=fn.getInstance(this._iid),n=0;n<e.length;n++){var i=e[n];if(!i.hasOwnProperty("userId")){this._cachedMentionedUsers=[],this._mentionedUserIds=[];break}this._mentionedUserIds.indexOf(i.userId)<0&&t.currentUser&&t.currentUser.userId!==i.userId&&(this._cachedMentionedUsers.push(i),this._mentionedUserIds.push(i.userId))}}},{key:"metaArrayKeys",get:function(){return this._metaArrays.map((function(e){return e.key}))},set:function(e){var t=G.get(this._iid).MessageMetaArray,n={};if(Array.isArray(e)){this._metaArrays=[];for(var i=0;i<e.length;i++)"string"!=typeof e[i]||n[e[i]]||(n[e[i]]=!0,this._metaArrays.push(new t(e[i])))}}},{key:"metaArrays",get:function(){return this._metaArrays},set:function(e){var t=G.get(this._iid).MessageMetaArray;if(Array.isArray(e)){this._metaArrays=[];for(var n=0;n<e.length;n++){var i=e[n];if(i instanceof t){var r,s=this._metaArrays.map((function(e){return e.key})).indexOf(i.key);s<0?this._metaArrays.push(i):(r=this._metaArrays[s].value).push.apply(r,O(i.value))}}}}},{key:"rootMessageId",get:function(){return Ot.get(this)}},{key:"parentMessageId",get:function(){return this._parentMessageId},set:function(e){Ot.set(this,e),this._parentMessageId=e}},{key:"_validate",value:function(){var e=G.get(this._iid),t=e.BaseMessageParams,n=e.MessageMetaArray,i=Ot.get(this);return Object.keys(t.MentionType).map((function(e){return t.MentionType[e]})).indexOf(this.mentionType)>-1&&this._mentionedUserIds.every((function(e){return"string"==typeof e}))&&Array.isArray(this._metaArrays)&&this._metaArrays.every((function(e){return e instanceof n}))&&("number"==typeof i||null===i)&&("number"==typeof this._parentMessageId||null===this._parentMessageId)&&"boolean"==typeof this.isReplyToChannel}}],[{key:"MentionType",get:function(){return{USERS:"users",CHANNEL:"channel"}}},{key:"PushNotificationDeliveryOption",get:function(){return{DEFAULT:"default",SUPPRESS:"suppress"}}}]),e}(),Rt=function(e){m(n,e);var t=k(n);function n(){var e;return p(this,n),(e=t.call(this)).message=null,e.data=null,e.customType=null,e.pushNotificationDeliveryOption=null,e.appleCriticalAlertOptions=null,e.pollId=void 0,e._translationTargetLanguages=[],e}return g(n,[{key:"targetLanguages",get:function(){return this.translationTargetLanguages},set:function(e){this.translationTargetLanguages=e}},{key:"translationTargetLanguages",get:function(){return this._translationTargetLanguages},set:function(e){if(Array.isArray(e)){for(var t=0;t<e.length;t++)if("string"!=typeof e[t])return void(this._translationTargetLanguages=[]);this._translationTargetLanguages=e}}},{key:"_validate",value:function(){var e=G.get(this._iid),t=e.BaseMessageParams,i=e.AppleCriticalAlertOptions;return I(_(n.prototype),"_validate",this).call(this)&&("string"==typeof this.message||null===this.message)&&("string"==typeof this.data||null===this.data)&&("string"==typeof this.customType||null===this.customType)&&Array.isArray(this.translationTargetLanguages)&&this.translationTargetLanguages.every((function(e){return"string"==typeof e}))&&(null===this.pushNotificationDeliveryOption||Object.keys(t.PushNotificationDeliveryOption).map((function(e){return t.PushNotificationDeliveryOption[e]})).indexOf(this.pushNotificationDeliveryOption)>-1)&&(null===this.appleCriticalAlertOptions||this.appleCriticalAlertOptions instanceof i)&&("number"==typeof this.pollId||null===this.pollId||void 0===this.pollId)}}]),n}(Tt),Nt=function(e){m(n,e);var t=k(n);function n(){var e;return p(this,n),(e=t.call(this)).fileName=null,e.mimeType=null,e.fileSize=null,e.data=null,e.customType=null,e.pushNotificationDeliveryOption=null,e.appleCriticalAlertOptions=null,e._isUpdate=!1,e._file=null,e._fileUrl=null,e._thumbnailSizes=[],e}return g(n,[{key:"file",get:function(){return this._file},set:function(e){ee.isFile(e)&&(this._fileUrl=null,this._file=e)}},{key:"fileUrl",get:function(){return this._fileUrl},set:function(e){"string"==typeof e&&(this._fileUrl=e,this._file=null)}},{key:"thumbnailSizes",get:function(){return this._thumbnailSizes},set:function(e){if(Array.isArray(e)){for(var t=0;t<e.length;t++)if("object"!==h(e[t])||"number"!=typeof e[t].maxWidth||"number"!=typeof e[t].maxHeight)return void(this._thumbnailSizes=[]);this._thumbnailSizes=e}}},{key:"_validate",value:function(){var e=G.get(this._iid),t=e.BaseMessageParams,i=e.AppleCriticalAlertOptions;return I(_(n.prototype),"_validate",this).call(this)&&(this._isUpdate||ee.isFile(this.file)||"string"==typeof this.fileUrl)&&("string"==typeof this.fileName||null===this.fileName)&&("string"==typeof this.mimeType||null===this.mimeType)&&("number"==typeof this.fileSize||null===this.fileSize)&&("string"==typeof this.data||null===this.data)&&("string"==typeof this.customType||null===this.customType)&&(null===this._thumbnailSizes||this._thumbnailSizes.every((function(e){return"object"===h(e)&&e.maxWidth>0&&e.maxHeight>0})))&&(null===this.pushNotificationDeliveryOption||Object.keys(t.PushNotificationDeliveryOption).map((function(e){return t.PushNotificationDeliveryOption[e]})).indexOf(this.pushNotificationDeliveryOption)>-1)&&(null===this.appleCriticalAlertOptions||this.appleCriticalAlertOptions instanceof i)}}]),n}(Tt),wt=function(e){m(n,e);var t=k(n);function n(e){var i;return p(this,n),(i=t.call(this)).year=null,i.month=null,i.day=null,i.hour=null,i.min=null,i.timezone=null,i._scheduledDateTimeString=null,e&&i._update(e),i}return g(n,[{key:"scheduledDateTimeString",get:function(){return this._scheduledDateTimeString?this._scheduledDateTimeString:"number"==typeof this.year&&4===this.year.toString().length&&"number"==typeof this.month&&this.month>=1&&this.month<=12&&"number"==typeof this.day&&this.day>=1&&this.day<=31&&"number"==typeof this.hour&&this.hour>=0&&this.hour<=24&&"number"==typeof this.min&&this.min>=0&&this.min<=60&&"string"==typeof this.timezone&&this.timezone.length>0?this.year.toString()+"-"+("0"+this.month.toString()).substr(-2)+"-"+("0"+this.day.toString()).substr(-2)+" "+("0"+this.hour.toString()).substr(-2)+":"+("0"+this.min.toString()).substr(-2):null},set:function(e){e&&"string"==typeof e&&(this._scheduledDateTimeString=e)}},{key:"_update",value:function(e){e.hasOwnProperty("message")&&(this.message=e.message),e.hasOwnProperty("year")&&(this.year=e.year),e.hasOwnProperty("month")&&(this.month=e.month),e.hasOwnProperty("day")&&(this.day=e.day),e.hasOwnProperty("hour")&&(this.hour=e.hour),e.hasOwnProperty("min")&&(this.min=e.min),e.hasOwnProperty("timezone")&&(this.timezone=e.timezone)}},{key:"_getScheduleString",value:function(){return this.scheduledDateTimeString?this.scheduledDateTimeString+" "+this.timezone:"number"==typeof this.year&&4===this.year.toString().length&&"number"==typeof this.month&&this.month>=1&&this.month<=12&&"number"==typeof this.day&&this.day>=1&&this.day<=31&&"number"==typeof this.hour&&this.hour>=0&&this.hour<=24&&"number"==typeof this.min&&this.min>=0&&this.min<=60&&"string"==typeof this.timezone&&this.timezone.length>0?this.year.toString()+"-"+("0"+this.month.toString()).substr(-2)+"-"+("0"+this.day.toString()).substr(-2)+" "+("0"+this.hour.toString()).substr(-2)+":"+("0"+this.min.toString()).substr(-2)+" "+this.timezone:null}},{key:"setSchedule",value:function(e,t,n,i,r,s){"number"==typeof e&&4===e.toString().length&&"number"==typeof t&&t>=1&&t<=12&&"number"==typeof n&&n>=1&&n<=31&&"number"==typeof i&&i>=0&&i<=24&&"number"==typeof r&&r>=0&&r<=60&&"string"==typeof s&&s.length>0&&(this.scheduledDateTimeString=e.toString()+"-"+("0"+t.toString()).substr(-2)+"-"+("0"+n.toString()).substr(-2)+" "+("0"+i.toString()).substr(-2)+":"+("0"+r.toString()).substr(-2),this.timezone=s)}}]),n}(Rt),Mt=function e(){p(this,e),this.channelCustomTypesFilter=[],this.superChannelFilter=Fe.SuperChannelFilter.ALL},Pt=function(){function e(){p(this,e),this.channelUrl=null,this.channelType=null,this.messageId=0,this.includeMetaArray=!1,this.includeReactions=!1,this.includeParentMessageText=null,this.includeThreadInfo=!1,this.includeParentMessageInfo=null,this.includePollDetails=!1}return g(e,[{key:"_validate",value:function(){var e=G.get(this._iid).BaseChannel;return"string"==typeof this.channelUrl&&"string"==typeof this.channelType&&[e.CHANNEL_TYPE_BASE,e.CHANNEL_TYPE_OPEN,e.CHANNEL_TYPE_GROUP].includes(this.channelType)&&"number"==typeof this.messageId&&"boolean"==typeof this.includeMetaArray&&"boolean"==typeof this.includeReactions&&"boolean"==typeof this.includeThreadInfo&&(null===this.includeParentMessageText||"boolean"==typeof this.includeParentMessageText)&&(null===this.includeParentMessageInfo||"boolean"==typeof this.includeParentMessageInfo)&&"boolean"==typeof this.includePollDetails}}]),e}(),Lt=function(){function e(){p(this,e);var t=G.get(this._iid).BaseChannel;this.prevResultSize=0,this.nextResultSize=0,this.isInclusive=!1,this.reverse=!1,this.messageType=t.MessageTypeFilter.ALL,this.customType=null,this.customTypes=[],this.senderUserIds=null,this.includeMetaArray=!1,this.includeReaction=null,this.includeReactions=null,this.includeReplies=null,this.includeParentMessageText=null,this.includeThreadInfo=!1,this.replyType=null,this.includeParentMessageInfo=null,this.showSubchannelMessagesOnly=!1,this.includePollDetails=!1}return g(e,[{key:"_validate",value:function(){var e=G.get(this._iid),t=e.BaseChannel,n=e.BaseMessage;return"number"==typeof this.prevResultSize&&"number"==typeof this.nextResultSize&&"boolean"==typeof this.isInclusive&&"boolean"==typeof this.reverse&&"string"==typeof this.messageType&&Object.values(t.MessageTypeFilter).includes(this.messageType)&&("string"==typeof this.customType||null===this.customType)&&Array.isArray(this.customTypes)&&this.customTypes.every((function(e){return"string"==typeof e||null===e}))&&(Array.isArray(this.senderUserIds)&&this.senderUserIds.every((function(e){return"string"==typeof e}))||null===this.senderUserIds)&&"boolean"==typeof this.includeMetaArray&&(null===this.includeReaction||"boolean"==typeof this.includeReaction)&&(null===this.includeReactions||"boolean"==typeof this.includeReactions)&&"boolean"==typeof this.includeThreadInfo&&(null===this.includeReplies||"boolean"==typeof this.includeReplies)&&(null===this.replyType||"string"==typeof this.replyType&&Object.values(n.ReplyType).includes(this.replyType))&&(null===this.includeParentMessageText||"boolean"==typeof this.includeParentMessageText)&&(null===this.includeParentMessageInfo||"boolean"==typeof this.includeParentMessageInfo)&&"boolean"==typeof this.showSubchannelMessagesOnly&&"boolean"==typeof this.includePollDetails}},{key:"belongsTo",value:function(e){var t=G.get(this._iid),n=t.BaseChannel,i=t.UserMessageParams,r=t.FileMessageParams,s=t.BaseMessage;if(this.messageType!==n.MessageTypeFilter.ALL){if(e instanceof i&&this.messageType!==n.MessageTypeFilter.USER)return!1;if(e instanceof r&&this.messageType!==n.MessageTypeFilter.FILE)return!1}if(Array.isArray(this.customTypes)&&this.customTypes.length>0&&!this.customTypes.includes(e.customType))return!1;if("string"==typeof this.customType&&this.customType!==e.customType)return!1;if(Array.isArray(this.senderUserIds)&&this.senderUserIds.length>0){var a=fn.getInstance(e._iid);if(!a||!a.currentUser||!this.senderUserIds.includes(a.currentUser.userId))return!1}if("string"==typeof this.replyType&&e.parentMessageId){if(this.replyType===s.ReplyType.NONE)return!1;if(this.replyType===s.ReplyType.ONLY_REPLY_TO_CHANNEL&&!e.isReplyToChannel)return!1}else if(!1===this.includeReplies&&e.parentMessageId)return!1;return!0}}]),e}(),Dt=function(){function e(){p(this,e);var t=G.get(this._iid).BaseChannel;this.prevResultSize=0,this.nextResultSize=0,this.isInclusive=!1,this.reverse=!1,this.messageType=t.MessageTypeFilter.ALL,this.customType=null,this.customTypes=[],this.senderUserIds=null,this.includeMetaArray=!1,this.includeReaction=null,this.includeReactions=null,this.includeParentMessageText=null,this.includeParentMessageInfo=null,this.includePollDetails=!1}return g(e,[{key:"_validate",value:function(){var e=G.get(this._iid).BaseChannel;return"number"==typeof this.prevResultSize&&"number"==typeof this.nextResultSize&&"boolean"==typeof this.isInclusive&&"boolean"==typeof this.reverse&&"string"==typeof this.messageType&&Object.values(e.MessageTypeFilter).includes(this.messageType)&&("string"==typeof this.customType||null===this.customType)&&Array.isArray(this.customTypes)&&this.customTypes.every((function(e){return"string"==typeof e||null===e}))&&(Array.isArray(this.senderUserIds)&&this.senderUserIds.every((function(e){return"string"==typeof e}))||null===this.senderUserIds)&&"boolean"==typeof this.includeMetaArray&&(null===this.includeReaction||"boolean"==typeof this.includeReaction)&&(null===this.includeReactions||"boolean"==typeof this.includeReactions)&&(null===this.includeParentMessageText||"boolean"==typeof this.includeParentMessageText)&&(null===this.includeParentMessageInfo||"boolean"==typeof this.includeParentMessageInfo)&&"boolean"==typeof this.includePollDetails}}]),e}(),Ht=function(){function e(){p(this,e),this.includeMetaArray=!1,this.includeReaction=null,this.includeReactions=null,this.includeReplies=null,this.includeParentMessageText=null,this.includeThreadInfo=!1,this.replyType=null,this.includeParentMessageInfo=null,this.includePollDetails=!1}return g(e,[{key:"_validate",value:function(){return"boolean"==typeof this.includeMetaArray&&(null===this.includeReaction||"boolean"==typeof this.includeReaction)&&(null===this.includeReactions||"boolean"==typeof this.includeReactions)&&"boolean"==typeof this.includeThreadInfo&&(null===this.includeReplies||"boolean"==typeof this.includeReplies)&&(null===this.replyType||"string"==typeof this.replyType&&Object.values(BaseMessage.ReplyType).includes(this.replyType))&&(null===this.includeParentMessageText||"boolean"==typeof this.includeParentMessageText)&&(null===this.includeParentMessageInfo||"boolean"==typeof this.includeParentMessageInfo)&&"boolean"==typeof this.includePollDetails}}]),e}(),Ft=function(){function e(){p(this,e),this.customTypes=[],this.includeEmpty=!1,this.includeFrozen=!0}return g(e,[{key:"_validate",value:function(){return(Array.isArray(this.customTypes)&&this.customTypes.every((function(e){return"string"==typeof e}))||null===this.customTypes)&&("boolean"==typeof this.includeEmpty||null===this.includeEmpty)&&"boolean"==typeof this.includeFrozen}}]),e}(),Gt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.title,i=void 0===n?null:n,r=t.options,s=void 0===r?null:r,a=t.data,o=void 0===a?null:a,l=t.isAnonymous,u=void 0===l?null:l,c=t.allowUserSuggestion,d=void 0===c?null:c,h=t.allowMultipleVotes,f=void 0===h?null:h,g=t.closeAt,y=void 0===g?null:g;p(this,e),this.title=i,this.options=s,this.data=o,this.isAnonymous=u,this.allowUserSuggestion=d,this.allowMultipleVotes=f,this.closeAt=y}return g(e,[{key:"_validate",value:function(){return"string"==typeof this.title&&(Array.isArray(this.options)&&this.options.length>0&&this.options.every((function(e){return"string"==typeof e}))||null===this.options)&&("string"==typeof this.data||null==this.data)&&("boolean"==typeof this.isAnonymous||null===this.isAnonymous)&&("boolean"==typeof this.allowUserSuggestion||null===this.allowUserSuggestion)&&("boolean"==typeof this.allowMultipleVotes||null===this.allowMultipleVotes)&&("number"==typeof this.closeAt||null===this.closeAt)}}]),e}(),xt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.channelUrl,i=void 0===n?null:n,r=t.pollId,s=void 0===r?null:r,a=t.showPartialVoters,o=void 0!==a&&a;p(this,e),this.channelUrl=i,this.pollId=s,this.showPartialVoters=o}return g(e,[{key:"_validate",value:function(){return"string"==typeof this.channelUrl&&"number"==typeof this.pollId&&"boolean"==typeof this.showPartialVoters}}]),e}(),jt=function e(){p(this,e),this.onReconnectStarted=function(){},this.onReconnectSucceeded=function(){},this.onReconnectFailed=function(){}},Bt=function e(){p(this,e),this.onFriendsDiscovered=function(e){},this.onTotalUnreadMessageCountUpdated=function(e,t){}},qt=function e(){p(this,e),this.onMessageReceived=function(e,t){},this.onMessageUpdated=function(e,t){},this.onMessageDeleted=function(e,t){},this.onReadReceiptUpdated=function(e){},this.onReactionUpdated=function(e,t){},this.onDeliveryReceiptUpdated=function(e){},this.onTypingStatusUpdated=function(e){},this.onUserJoined=function(e,t){},this.onUserLeft=function(e,t){},this.onOperatorUpdated=function(e,t){},this.onUserEntered=function(e,t){},this.onUserExited=function(e,t){},this.onUserMuted=function(e,t){},this.onUserUnmuted=function(e,t){},this.onUserBanned=function(e,t){},this.onUserUnbanned=function(e,t){},this.onChannelFrozen=function(e){},this.onChannelUnfrozen=function(e){},this.onChannelChanged=function(e){},this.onChannelDeleted=function(e,t){},this.onUserReceivedInvitation=function(e,t,n){},this.onUserDeclinedInvitation=function(e,t,n){},this.onMetaDataCreated=function(e,t){},this.onMetaDataUpdated=function(e,t){},this.onMetaDataDeleted=function(e,t){},this.onMetaCountersCreated=function(e,t){},this.onMetaCountersUpdated=function(e,t){},this.onMetaCountersDeleted=function(e,t){},this.onChannelHidden=function(e){},this.onMentionReceived=function(e,t){},this.onThreadInfoUpdated=function(e,t){},this.onChannelMemberCountChanged=function(e){},this.onChannelParticipantCountChanged=function(e){},this.onPollUpdated=function(e){},this.onPollVoted=function(e){}},zt=function e(t){if(p(this,e),t){var n=G.get(this._iid),i=n.User,r=n.BaseChannel;this.reader=new i(t.user),this.timestamp=parseInt(t.ts),this.channelUrl=t.hasOwnProperty("channel_url")?String(t.channel_url):"",this.channelType=t.hasOwnProperty("channel_type")?String(t.channel_type):r.CHANNEL_TYPE_GROUP}},Yt=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];p(this,e),this.key=t,this.value=Array.isArray(n)&&n.every((function(e){return"string"==typeof e}))?n:[]}return g(e,[{key:"encode",value:function(){return{key:this.key,value:this.value||[]}}}]),e}(),Vt=new WeakMap,Kt=function(){function e(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;p(this,e),this.key=t,this.userIds=i,this.updatedAt=r;var s={};this.userIds.forEach((function(e){s[e]=n.updatedAt})),Vt.set(this,s)}return g(e,[{key:"isEmpty",get:function(){return 0===this.userIds.length}},{key:"serialize",value:function(){return{key:this.key,user_ids:this.userIds,updated_at:this.updatedAt}}},{key:"_applyEvent",value:function(e){if(e instanceof ge){var t=Vt.get(this);if(e.key===this.key&&(!t[e.userId]||t[e.userId]<e.updatedAt)){var n=this.userIds.indexOf(e.userId);switch(e.operation){case"add":n<0&&this.userIds.push(e.userId);break;case"delete":n>=0&&this.userIds.splice(n,1)}t[e.userId]=e.updatedAt}}}}],[{key:"createFromJson",value:function(e){var t=e.key,n=e.user_ids,i=e.updated_at;return"string"==typeof t&&t&&Array.isArray(n)&&n.length>0&&"number"==typeof i?new this(t,n,i):null}}]),e}(),Qt=function(){function e(t){p(this,e),this.replyCount=0,this.mostRepliedUsers=[],this.lastRepliedAt=0,this.updatedAt=0,t&&this._update(t)}return g(e,[{key:"_update",value:function(e){var t=G.get(this._iid).User;e.hasOwnProperty("reply_count")&&(this.replyCount=parseInt(e.reply_count)),e.hasOwnProperty("most_replies")&&Array.isArray(e.most_replies)&&e.most_replies.every((function(e){return"object"===h(e)}))&&(this.mostRepliedUsers=e.most_replies.map((function(e){return new t(e)}))),e.hasOwnProperty("last_replied_at")&&(this.lastRepliedAt=parseInt(e.last_replied_at)),e.hasOwnProperty("updated_at")&&(this.updatedAt=parseInt(e.updated_at))}}],[{key:"objectify",value:function(e){var t=G.get(this._iid).User,n=e.replyCount,i=e.mostRepliedUsers,r=e.lastRepliedAt,s=e.updatedAt,a={};return a.reply_count=n,Array.isArray(i)&&i.every((function(e){return e instanceof t}))&&(a.most_replies=i.map((function(e){return t.objectify(e)}))),a.last_replied_at=r,a.updated_at=s,a}},{key:"build",value:function(e,t,n,i){return this.objectify({replyCount:e,mostRepliedUsers:t,lastRepliedAt:n,updatedAt:i})}}]),e}(),Wt=function(){function e(t){p(this,e),this.title=null,this.url=null,this.description=null,this.defaultImage=null,t&&this._update(t)}return g(e,[{key:"_update",value:function(e){var t=G.get(this._iid).OGImage;e.hasOwnProperty("og:title")&&(this.title=e["og:title"]),e.hasOwnProperty("og:url")&&(this.url=e["og:url"]),e.hasOwnProperty("og:description")&&(this.description=e["og:description"]),e.hasOwnProperty("og:image")&&(this.defaultImage=new t(e["og:image"]))}}],[{key:"objectify",value:function(e){var t=G.get(this._iid).OGImage,n=e.title,i=void 0===n?null:n,r=e.url,s=void 0===r?null:r,a=e.description,o=void 0===a?null:a,l=e.defaultImage,u=void 0===l?null:l,c={};return c["og:title"]=i,c["og:url"]=s,c["og:description"]=o,u&&(c["og:image"]=t.objectify(u)),c}}]),e}(),Jt=function(){function e(t){p(this,e),this.url=null,this.secureUrl=null,this.type=null,this.width=0,this.height=0,this.alt=null,t&&this._update(t)}return g(e,[{key:"_update",value:function(e){e.hasOwnProperty("url")&&(this.url=e.url),e.hasOwnProperty("secure_url")&&(this.secureUrl=e.secure_url),e.hasOwnProperty("type")&&(this.type=e.type),e.hasOwnProperty("width")&&(this.width=parseInt(e.width)),e.hasOwnProperty("height")&&(this.height=parseInt(e.height)),e.hasOwnProperty("alt")&&(this.alt=e.alt)}}],[{key:"objectify",value:function(e){var t=e.url,n=void 0===t?null:t,i=e.secureUrl,r=void 0===i?null:i,s=e.type,a=void 0===s?null:s,o=e.width,l=void 0===o?0:o,u=e.height,c=void 0===u?0:u,d=e.alt,h=void 0===d?null:d,p={};return p.url=n,p.secure_url=r,p.type=a,p.width=l,p.height=c,p.alt=h,p}}]),e}(),$t=function(){function e(t){p(this,e),this.type=null,this.vendor=null,this.detail={},t&&this._update(t)}return g(e,[{key:"_update",value:function(e){this.type=e.hasOwnProperty("type")?e.type:"",this.vendor=e.hasOwnProperty("vendor")?e.vendor:"",e.hasOwnProperty("detail")&&"object"===h(e.detail)&&!Array.isArray(e.detail)&&(this.detail=e.detail)}}],[{key:"objectify",value:function(e){var t=e.type,n=void 0===t?"":t,i=e.vendor,r=void 0===i?"":i,s=e.detail,a=void 0===s?{}:s,o={};return o.type=n,o.vendor=r,o.detail=a,o}}]),e}(),Xt=function(){function e(t){p(this,e),this.id=0,this.title="",this.details=null,this._update(t)}return g(e,[{key:"update",value:function(e,t){var n=this,i=G.get(this._iid),r=i.PollParams,s=null,a=ae.parse(arguments,[new ae({type:r,constraint:function(e){return e._validate()}}),new ae({type:"callback"})]),o=U(a,3);return s=o[0],e=o[1],t=o[2],_e(this._iid,(function(t){if(s)t(s,null);else{var i={text:e.data};L.get(n._iid).container.apiClient.updatePoll(d(d({pollId:n.id},e),{},{data:i}),(function(e,i){if(e)t(e,null);else{var r=new(0,G.get(n._iid).Poll)(i);t(null,r)}}))}}),t)}},{key:"delete",value:function(e){var t=this,n=null,i=ae.parse(arguments,[new ae({type:"callback"})]),r=U(i,2);return n=r[0],e=r[1],_e(this._iid,(function(e){n?e(n,null):L.get(t._iid).container.apiClient.deletePoll({pollId:t.id},(function(t,n){e(t||null,null)}))}),e)}},{key:"addOption",value:function(e,t,n){var i=this,r=null,s=ae.parse(arguments,[new ae({type:"string"}),new ae({type:"string"}),new ae({type:"callback"})]),a=U(s,4);return r=a[0],e=a[1],t=a[2],n=a[3],_e(this._iid,(function(n){r?n(r,null):L.get(i._iid).container.apiClient.addPollOption({channelUrl:e,pollId:i.id,text:t},(function(e,t){if(e)n(e,null);else{var r=new(0,G.get(i._iid).Poll)(t);n(null,r)}}))}),n)}},{key:"vote",value:function(e,t,n){var i=this,r=null,s=ae.parse(arguments,[new ae({type:"string"}),new ae({type:"array",constraint:function(e){return e.every((function(e){return"number"==typeof e}))}}),new ae({type:"callback"})]),a=U(s,4);return r=a[0],e=a[1],t=a[2],n=a[3],_e(this._iid,(function(n){r?n(r,null):L.get(i._iid).container.apiClient.votePoll({channelUrl:e,pollId:i.id,optionIds:t},(function(e,t){if(e)n(e,null);else{var r=new(0,G.get(i._iid).Poll)(t);n(null,r)}}))}),n)}},{key:"close",value:function(e){var t=this,n=null,i=ae.parse(arguments,[new ae({type:"callback"})]),r=U(i,2);return n=r[0],e=r[1],_e(this._iid,(function(e){n?e(n,null):L.get(t._iid).container.apiClient.closePoll({pollId:t.id},(function(n,i){if(n)e(n,null);else{var r=new(0,G.get(t._iid).Poll)(i);e(null,r)}}))}),e)}},{key:"_update",value:function(e){var t=G.get(this._iid).PollDetails;this.id=parseInt(e.id),this.title=e.title,e.hasOwnProperty("options")&&e.hasOwnProperty("is_anonymous")&&e.hasOwnProperty("allow_user_suggestion")&&e.hasOwnProperty("allow_multiple_votes")&&e.hasOwnProperty("close_at")&&e.hasOwnProperty("voter_count")&&e.hasOwnProperty("status")&&e.hasOwnProperty("created_by")&&e.hasOwnProperty("created_at")&&e.hasOwnProperty("updated_at")&&(this.details=new t(e))}}],[{key:"Status",get:function(){return{OPEN:"open",CLOSED:"closed",REMOVED:"removed"}}},{key:"objectify",value:function(e){var t=G.get(this._iid).PollDetails,n=e.id,i=void 0===n?0:n,r=e.title,s=void 0===r?"":r,a=e.details,o=void 0===a?null:a,l=d({},o?t.objectify(o):{});return l.id=i,l.title=s,l}},{key:"get",value:function(e,t){var n=this,i=G.get(this._iid),r=i.PollRetrievalParams,s=null,a=ae.parse(arguments,[new ae({type:r,constraint:function(e){return e._validate()}}),new ae({type:"callback"})]),o=U(a,3);return s=o[0],e=o[1],t=o[2],_e(this._iid,(function(t){s?t(s,null):L.get(n._iid).container.apiClient.getPoll(d({},e),(function(e,i){if(e)t(e,null);else{var r=new(0,G.get(n._iid).Poll)(i);t(null,r)}}))}),t)}},{key:"create",value:function(e,t){var n=this,i=G.get(this._iid),r=i.PollParams,s=null,a=ae.parse(arguments,[new ae({type:r,constraint:function(e){return e._validate()}}),new ae({type:"callback"})]),o=U(a,3);return s=o[0],e=o[1],t=o[2],_e(this._iid,(function(t){if(s)t(s,null);else{var i={text:e.data};L.get(n._iid).container.apiClient.createPoll(d(d({},e),{},{data:i}),(function(e,i){if(e)t(e,null);else{var r=new(0,G.get(n._iid).Poll)(i);t(null,r)}}))}}),t)}}]),e}(),Zt=function(){function e(t){p(this,e),this.options=[],this.data=null,this.isAnonymous=!1,this.allowUserSuggestion=!1,this.allowMultipleVotes=!1,this.closeAt=-1,this.voterCount=0,this.votedOptionIds=[],this.status="",this.createdBy=null,this.createdAt=0,this.updatedAt=0,this._update(t)}return g(e,[{key:"_update",value:function(e){var t=G.get(this._iid).PollOption;e.hasOwnProperty("options")&&Array.isArray(e.options)&&(this.options=e.options.map((function(e){return new t(e)})));try{this.data=JSON.parse(e.data)}catch(t){this.data=e.data}this.isAnonymous=!!e.hasOwnProperty("is_anonymous")&&e.is_anonymous,this.allowUserSuggestion=!!e.hasOwnProperty("allow_user_suggestion")&&e.allow_user_suggestion,this.allowMultipleVotes=!!e.hasOwnProperty("allow_multiple_votes")&&e.allow_multiple_votes,this.closeAt=parseInt(e.close_at),this.voterCount=parseInt(e.voter_count),e.hasOwnProperty("voted_option_ids")&&Array.isArray(e.voted_option_ids)&&(this.votedOptionIds=e.voted_option_ids.map((function(e){return parseInt(e)}))),this.status=e.status,this.createdBy=e.created_by,this.createdAt=parseInt(e.created_at),this.updatedAt=parseInt(e.updated_at)}}],[{key:"objectify",value:function(e){var t=G.get(this._iid).PollOption,n=e.options,i=void 0===n?[]:n,r=e.data,s=void 0===r?null:r,a=e.isAnonymous,o=void 0!==a&&a,l=e.allowUserSuggestion,u=void 0!==l&&l,c=e.allowMultipleVotes,d=void 0!==c&&c,h=e.closeAt,p=void 0===h?-1:h,f=e.voterCount,g=void 0===f?0:f,y=e.votedOptionIds,m=void 0===y?[]:y,_=e.status,v=void 0===_?"":_,E=e.createdBy,C=void 0===E?"":E,b=e.createdAt,S=void 0===b?0:b,A=e.updatedAt,k=void 0===A?0:A,I={};return I.options=i.map((function(e){return t.objectify(e)})),I.data=JSON.stringify(s),I.is_anonymous=o,I.allow_user_suggestion=u,I.allow_multiple_votes=d,I.close_at=p,I.voter_count=g,I.voted_option_ids=m,I.status=v,I.created_by=C,I.created_at=S,I.updated_at=k,I}}]),e}(),en=new WeakMap,tn=function(){function e(t){p(this,e),this.pollId=0,this.id=0,this.text="",this.voteCount=0,this.partialVoters=[],this.createdBy="",this.createdAt=0,this.updatedAt=0,en.set(this,null),this._update(t)}return g(e,[{key:"lastVotedAt",get:function(){return en.get(this)}},{key:"update",value:function(e,t){var n=this,i=null,r=ae.parse(arguments,[new ae({type:"string"}),new ae({type:"callback"})]),s=U(r,3);return i=s[0],e=s[1],t=s[2],_e(this._iid,(function(t){i?t(i,null):L.get(n._iid).container.apiClient.updatePollOption({pollId:n.pollId,optionId:n.id,text:e},(function(e,i){if(e)t(e,null);else{var r=new(0,G.get(n._iid).Poll)(i);t(null,r)}}))}),t)}},{key:"delete",value:function(e){var t=this,n=null,i=ae.parse(arguments,[new ae({type:"callback"})]),r=U(i,2);return n=r[0],e=r[1],_e(this._iid,(function(e){n?e(n,null):L.get(t._iid).container.apiClient.deletePollOption({pollId:t.pollId,optionId:t.id},(function(t,n){e(t||null,null)}))}),e)}},{key:"_applyEvent",value:function(e){return this.id===e.optionId&&this.lastVotedAt<e.votedAt&&(this.voteCount=e.voteCount,en.set(this,e.votedAt),!0)}},{key:"_update",value:function(e){var t=G.get(this._iid).User;this.pollId=parseInt(e.poll_id),this.id=parseInt(e.id),this.text=e.text,this.voteCount=parseInt(e.vote_count),e.hasOwnProperty("partial_voter_list")&&Array.isArray(e.partial_voter_list)&&(this.partialVoters=e.partial_voter_list.map((function(e){return new t(e)}))),this.createdBy=e.created_by,this.createdAt=parseInt(e.created_at),this.updatedAt=parseInt(e.updated_at)}}],[{key:"VoteAction",get:function(){return{CAST:"cast",CANCEL:"cancel"}}},{key:"objectify",value:function(e){var t=G.get(this._iid).User,n=e.pollId,i=void 0===n?0:n,r=e.id,s=void 0===r?0:r,a=e.text,o=void 0===a?"":a,l=e.voteCount,u=void 0===l?0:l,c=e.partialVoters,d=void 0===c?[]:c,h=e.createdBy,p=void 0===h?"":h,f=e.createdAt,g=void 0===f?0:f,y=e.updatedAt,m=void 0===y?0:y,_={};return _.poll_id=i,_.id=s,_.text=o,_.vote_count=u,Array.isArray(d)&&(_.partial_voter_list=d.filter((function(e){return e instanceof t})).map((function(e){return t.objectify(e)}))),_.created_by=p,_.created_at=g,_.updated_at=m,_}},{key:"get",value:function(e,t,n,i){var r=this,s=null,a=ae.parse(arguments,[new ae({type:"string"}),new ae({type:"number"}),new ae({type:"number"}),new ae({type:"callback"})]),o=U(a,5);return s=o[0],e=o[1],t=o[2],n=o[3],i=o[4],_e(this._iid,(function(i){s?i(s,null):L.get(r._iid).container.apiClient.getPollOption({channelUrl:e,pollId:t,optionId:n},(function(e,t){if(e)i(e,null);else{var n=new(0,G.get(r._iid).PollOption)(t);i(null,n)}}))}),i)}}]),e}(),nn=function(){function e(t){p(this,e),this.restrictionType=null,this.description=null,this.endAt=-1,t&&this._update(t)}return g(e,[{key:"_update",value:function(e){e.hasOwnProperty("restriction_type")&&(this.restrictionType=e.restriction_type),e.hasOwnProperty("description")?this.description=e.description:e.hasOwnProperty("muted_description")&&(this.description=e.muted_description),e.hasOwnProperty("end_at")?this.endAt=parseInt(e.end_at):e.hasOwnProperty("muted_end_at")&&(this.endAt=parseInt(e.muted_end_at))}}],[{key:"objectify",value:function(e){var t=e.restrictionType,n=void 0===t?null:t,i=e.description,r=void 0===i?null:i,s=e.endAt,a=void 0===s?-1:s,o={};return o.restriction_type=n,o.description=r,o.end_at=a,o}}]),e}(),rn="default",sn=function(){function e(t){p(this,e),this.name=rn,this.volume=1,t&&this._update(t)}return g(e,[{key:"_update",value:function(e){e.hasOwnProperty("name")&&(this.name=e.name),e.hasOwnProperty("volume")&&(this.volume=e.volume)}},{key:"serialize",value:function(){return me.serialize(this)}}],[{key:"objectify",value:function(e){var t=e.name,n=void 0===t?rn:t,i=e.volume;return{name:n,volume:void 0===i?1:i}}}]),e}(),an=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];p(this,e),this.isLoading=!1,this.hasNext=!0,this.limit=20,this.userIds=t,this.metaDataKey="",this.metaDataValues=[],this._token=""}return g(e,[{key:"next",value:function(e){var t=this;return _e(this._iid,(function(e){"number"==typeof t.limit&&t.limit>0&&Array.isArray(t.userIds)&&"string"==typeof t.metaDataKey&&Array.isArray(t.metaDataValues)&&!!t.metaDataKey==t.metaDataValues.length>0?t.isLoading?e(new D("Query in progress.",D.QUERY_IN_PROGRESS),null):t.hasNext?(t.isLoading=!0,L.get(t._iid).container.apiClient.loadUserList(d(d({},t),{},{userIdsFilter:t.userIds,metaDataKeyFilter:t.metaDataKey,metaDataValuesFilter:t.metaDataValues,token:t._token}),(function(n,i){var r=null;if(!n){var s=G.get(t._iid).User,a=String(i.next);t._token=a,t.hasNext=!!a,r=i.users.map((function(e){return new s(e)}))}t.isLoading=!1,e(n,r)}))):e(null,[]):e(ae.error,null)}),e)}}]),e}(),on=new WeakMap,ln=function(){function e(t){p(this,e),this.isLoading=!1,on.set(this,t)}return g(e,[{key:"prev",value:function(e,t,n,i){var r=arguments,s=this;return _e(this._iid,(function(i){var a,o=G.get(s._iid).BaseChannel,l=U(ae.parse(r,[new ae({type:"number"}),new ae({type:"number"}),new ae({type:"boolean"}),new ae({type:"function"})]),5);if(a=l[0],e=l[1],t=l[2],n=l[3],i=l[4],a)i(a,null);else if(s.isLoading)i(new D("Query in progress.",D.QUERY_IN_PROGRESS),null);else{s.isLoading=!0;var u=on.get(s);L.get(s._iid).container.apiClient.getMessageList({channelUrl:u.url,channelType:u.channelType,token:e,tokenType:"timestamp",isInclusive:!1,prevResultSize:t,nextResultSize:0,shouldReverse:n,messageType:"",customType:""},(function(e,t){var n=null;e||(n=t.messages.map((function(e){return o.buildMessage(e,u)}))),s.isLoading=!1,i(e,n)}))}}),i)}},{key:"next",value:function(e,t,n,i){var r=arguments,s=this;return _e(this._iid,(function(i){var a,o=G.get(s._iid).BaseChannel,l=U(ae.parse(r,[new ae({type:"number"}),new ae({type:"number"}),new ae({type:"boolean"}),new ae({type:"function"})]),5);if(a=l[0],e=l[1],t=l[2],n=l[3],i=l[4],a)i(a,null);else if(s.isLoading)i(new D("Query in progress.",D.QUERY_IN_PROGRESS),null);else{s.isLoading=!0;var u=on.get(s);L.get(s._iid).container.apiClient.getMessageList({channelUrl:u.url,channelType:u.channelType,token:e,tokenType:"timestamp",isInclusive:!1,prevResultSize:0,nextResultSize:t,shouldReverse:n,messageType:"",customType:""},(function(e,t){var n=null;e||(n=t.messages.map((function(e){return o.buildMessage(e,u)}))),s.isLoading=!1,i(e,n)}))}}),i)}},{key:"load",value:function(e,t,n,i,r){var s=arguments,a=this;return _e(this._iid,(function(r){var o,l=G.get(a._iid).BaseChannel,u=U(ae.parse(s,[new ae({type:"number"}),new ae({type:"number"}),new ae({type:"number"}),new ae({type:"boolean"}),new ae({type:"callback"})]),6);if(o=u[0],e=u[1],t=u[2],n=u[3],i=u[4],r=u[5],o)r(o,null);else if(a.isLoading)r(new D("Query in progress.",D.QUERY_IN_PROGRESS),null);else{a.isLoading=!0;var c=on.get(a);L.get(a._iid).container.apiClient.getMessageList({channelUrl:c.url,channelType:c.channelType,token:e,tokenType:"timestamp",isInclusive:!1,prevResultSize:t,nextResultSize:n,shouldReverse:i,messageType:"",customType:""},(function(e,t){var n=null;e||(n=t.messages.map((function(e){return l.buildMessage(e,c)}))),a.isLoading=!1,r(e,n)}))}}),r)}}]),e}(),un=function(){function e(t){var n=this;if(p(this,e),this.state=0,this._value=null,this._reason=null,"function"!=typeof t)throw"Promise resolver ".concat(t," is not a function");t((function(e){0===n.state&&(n.state=1,n._value=e)}),(function(e){0===n.state&&(n.state=2,n._reason=e)}))}return g(e,[{key:"length",get:function(){return 1}},{key:"then",value:function(t,n){var i=this,r=this;switch(this.state){case 0:setTimeout((function(){return i.then(t,n)}),100);break;case 1:t&&"function"==typeof t&&(r=t(this._value));break;case 2:n&&"function"==typeof n&&(r=n(this._reason))}return r instanceof e?r:this}},{key:"catch",value:function(t){var n=this,i=this;switch(this.state){case 0:setTimeout((function(){return n.catch(t)}),100);break;case 1:break;case 2:i=t(this._reason)}return i instanceof e?i:this}},{key:"finally",value:function(t){var n=this,i=this;switch(this.state){case 0:setTimeout((function(){return n.finally(t)}),100);break;case 1:case 2:i=t()}return i instanceof e?i:this}}],[{key:"all",value:function(t){return new e((function(n,i){if(Array.isArray(t)||"string"==typeof t)if(t.length>0){for(var r=[],s=0;s<t.length;s++)t[s]instanceof e?r.push(t[s]):r.push(e.resolve(t[s]));var a=new Array(r.length).fill(null),o=r.length,l=function(e,t,r){t?i(t):(o--,a[e]=r,o<=0&&n(a))};r.forEach((function(e,t){e.then((function(e){l(t,null,e)})).catch((function(e){l(t,e,null)}))}))}else n([]);else i(new Error("Uncaught (in promise) TypeError: ".concat(h(t)," ").concat(t," is not iterable")))}))}},{key:"resolve",value:function(t){return new e((function(e){e(t)}))}},{key:"reject",value:function(t){return new e((function(e,n){n(t)}))}}]),e}(),cn=function(){"undefined"==typeof Promise&&("undefined"!=typeof window?window.Promise=un:void 0!==r?r.Promise=un:"undefined"!=typeof self?self.Promise=un:"undefined"!=typeof globalThis&&(globalThis.Promise=un)),Object.values||(Object.values=function(e){return Object.keys(e).map((function(t){return e[t]}))}),Number.MAX_SAFE_INTEGER||Object.defineProperty(Number,"MAX_SAFE_INTEGER",{value:Math.pow(2,53)-1})},dn=null,hn={},pn=!1,fn=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};p(this,e),cn();var i=!1;if((n.newInstance||!dn||dn&&n.appId!==dn.getApplicationId()&&dn.getConnectionState()===dn.ConnectionState.CLOSED)&&(i=!0,dn=this),i){try{if(!n.hasOwnProperty("appId"))return W.warn("Must be set appId."),dn=null,null}catch(e){return W.warn("Must be set appId."),dn=null,null}var r=we.create();Object.defineProperty(this,"_iid",{get:function(){return r}}),hn[r]=this,this.customApiHost=null,this.customWsHost=null,this.connecting=!1,this.reconnecting=!1,this.isReconnectingOnError=!1,this.connectionCallbacks=[],this.ConnectionManager=new oe(this),this.GCMPushToken="",this.APNSPushToken="",this.PUSH_TEMPLATE_DEFAULT="default",this.PUSH_TEMPLATE_ALTERNATIVE="alternative",this.currentUser=null,this.isSessionOpened=!1,this.globalTimer,this.loginTimer,this.reconnectTimer,this.loginHandler=null,this.onLoginTimerCancel,this.onReconnectTimerCancel,this.BaseChannel={MessageTypeFilter:ke.MessageTypeFilter};var s={User:be,Member:Ge,RestrictedUser:je,GroupChannel:Fe,OpenChannel:Qe,UserMessage:We,FileMessage:Je,AdminMessage:$e,GroupChannelListQuery:at,MemberListQuery:ot,GroupChannelParams:It,OpenChannelParams:Ut,BaseMessageParams:Tt,UserMessageParams:Rt,FileMessageParams:Nt,ScheduledUserMessageParams:wt,GroupChannelTotalUnreadMessageCountParams:Mt,MessageRetrievalParams:Pt,MessageListParams:Lt,ThreadedMessageListParams:Dt,MessageChangeLogsParams:Ht,GroupChannelChangeLogsParams:Ft,PollParams:Gt,PollRetrievalParams:xt,MessageMetaArray:Yt,UserEventHandler:Bt,SessionHandler:le,ChannelHandler:qt,ConnectionHandler:jt,AppleCriticalAlertOptions:sn,Poll:Xt,PollOption:tn},a={SessionManager:ue,BaseChannel:ke,BaseMessage:Ce,UserListQuery:an,ApplicationUserListQuery:nt,BannedUserListQuery:it,BlockedUserListQuery:rt,FriendListQuery:st,MutedUserListQuery:lt,OpenChannelListQuery:ut,OperatorListQuery:dt,ParticipantListQuery:pt,MessageListQuery:ln,PreviousMessageListQuery:_t,MessageSearchQuery:gt,PublicGroupChannelListQuery:vt,PollListQuery:bt,PollVoterListQuery:kt,ScheduledUserMessage:Xe,ThreadInfo:Qt,ThreadInfoUpdateEvent:Ze,OGMetaData:Wt,OGImage:Jt,Plugin:$t,Command:he,Sender:xe,ReadStatus:zt,Reaction:Kt,ReactionEvent:ge,Emoji:ze,EmojiCategory:qe,EmojiContainer:Be,PollDetails:Zt,PollUpdateEvent:et,PollVoteEvent:tt,RestrictionInfo:nn,FileMessageQueue:Ne},o=new G(this._iid,d(d({},s),a));this.BaseMessage={ReplyType:Ce.ReplyType,getMessage:o.BaseMessage.getMessage.bind(o.BaseMessage)},Object.keys(o).forEach((function(e){s[e]&&(t[e]=o[e])})),L.create(r,{appId:n.appId,pinger:new $(this),apiClient:new ie(this),wsAdapter:new se(this),commandHandler:new Oe(this),onlineDetector:new ce(this),ackStateMap:{},subscribedUnreadMessageCount:{all:0,custom_types:{},ts:0},maxUnreadCountOfSuperGroupChannel:w.DEFAULT_MAX_UNREAD_COUNT_OF_SUPER_GROUP_CHANNEL,auth:new H,appInfo:null,pingInterval:15e3,pongTimeout:5e3,connectedAt:0,extensions:{},supportedExtensionKeys:["sb_uikit","sb_syncmanager"],getUserAgentWithExtensions:function(e){var t=e.sb_syncmanager?"s".concat(e.sb_syncmanager):"",n=e.sb_uikit?"u".concat(e.sb_uikit):"";return"JS/c".concat(w.SDK_VERSION,"/").concat(t,"/").concat(n)},sessionManager:new o.SessionManager(this),stateChangeEnabled:!0,isInBackground:!1,closedByGoingBackground:!1,isErrorFirstInCallback:!1}),this.userEventHandlers={},this.channelHandlers={},this.connectionHandlers={},this.Options={_useMemberAsMessageSender:!0,get UseMemberAsMessageSender(){return this._useMemberAsMessageSender},set UseMemberAsMessageSender(e){"boolean"==typeof e&&(this._useMemberAsMessageSender=e)},get useMemberAsMessageSender(){return this._useMemberAsMessageSender},set useMemberAsMessageSender(e){"boolean"==typeof e&&(this._useMemberAsMessageSender=e)},_typingIndicatorThrottle:1e3,get typingIndicatorThrottle(){return this._typingIndicatorThrottle},set typingIndicatorThrottle(e){"number"==typeof e&&e>=1e3&&e<=9e3&&(this._typingIndicatorThrottle=e)},_websocketResponseTimeout:1e4,get websocketResponseTimeout(){return this._websocketResponseTimeout},set websocketResponseTimeout(e){"number"==typeof e&&e>=5e3&&e<=3e5&&(this._websocketResponseTimeout=e)},includePollDetails:!1}}return dn}return g(e,[{key:"ConnectionState",get:function(){return{CONNECTING:"CONNECTING",OPEN:"OPEN",CLOSED:"CLOSED"}}},{key:"MessageRequestState",get:function(){return{NONE:"none",PENDING:"pending",FAILED:"failed",SUCCEEDED:"succeeded"}}},{key:"MessageSendingStatus",get:function(){return{NONE:"none",PENDING:"pending",FAILED:"failed",CANCELED:"canceled",SUCCEEDED:"succeeded"}}},{key:"pushTokenRegistrationState",get:function(){return{SUCCESS:"success",PENDING:"pending",ERROR:"error"}}},{key:"PushTriggerOption",get:function(){return{ALL:"all",MENTION_ONLY:"mention_only",OFF:"off"}}},{key:"appInfo",get:function(){return L.get(this._iid).container.appInfo}},{key:"ekey",get:function(){var e=L.get(this._iid).container.auth;return e?e.eKey:""}},{key:"getApplicationId",value:function(){return L.get(this._iid).get("appId")}},{key:"getCurrentUserId",value:function(){return this.currentUser?this.currentUser.userId:null}},{key:"getDebugMode",value:function(){return pn}},{key:"setDebugMode",value:function(e){pn=e,W.mode=e?W.Mode.DEBUG:W.Mode.PRODUCTION}},{key:"getErrorFirstCallback",value:function(){return L.get(this._iid).container.isErrorFirstInCallback}},{key:"setErrorFirstCallback",value:function(e){"boolean"==typeof e&&L.get(this._iid).set("isErrorFirstInCallback",e)}},{key:"getCurrentApiHost",value:function(){return this.customApiHost?this.customApiHost:"https://api.sendbird.com"}},{key:"clearCurrentApiHost",value:function(){this.customApiHost=null}},{key:"getCurrentWsHost",value:function(){return this.customWsHost?this.customWsHost:"wss://ws.sendbird.com"}},{key:"clearCurrentWsHost",value:function(){this.customWsHost=null}},{key:"getConnectionState",value:function(){try{var e=L.get(this._iid).container.wsAdapter;return this.connecting||this.reconnecting?this.ConnectionState.CONNECTING:e.client?this.connecting||this.reconnecting?this.ConnectionState.CONNECTING:this.isSessionOpened?e.client.getConnectionState():this.ConnectionState.CLOSED:this.ConnectionState.CLOSED}catch(e){return this.ConnectionState.CLOSED}}},{key:"getPendingGCMToken",value:function(){return this.GCMPushToken}},{key:"getPendingAPNSToken",value:function(){return this.APNSPushToken}},{key:"hasLoggedIn",value:function(){var e=L.get(this._iid);return this.currentUser&&e.get("auth").hasSession()}},{key:"getLastConnectedAt",value:function(){var e=L.get(this._iid);return this.getConnectionState()===this.ConnectionState.OPEN&&this.currentUser?e.get("connectedAt"):0}},{key:"connect",value:function(e,t,n,i,r){var s=this,a=L.get(this._iid),o=a.container,l=o.wsAdapter,u=o.onlineDetector;u&&u.start();var c=null,d=ae.parse(arguments,[new ae({type:"string",constraint:function(e){return e.length>0}}),new ae({type:"string",nullable:!0,ignoreIf:function(e){return 1===e.length||3===e.length}}),new ae({type:"string",nullable:!0,ignoreIf:function(e){return 1===e.length||2===e.length}}),new ae({type:"string",nullable:!0,ignoreIf:function(e){return 1===e.length||2===e.length}}),new ae({type:"callback"})]),h=U(d,6);return c=h[0],e=h[1],t=h[2],n=h[3],i=h[4],r=h[5],_e(this._iid,(function(r){c?r(c,null):(s.customApiHost=n,s.customWsHost=i,s.connecting=!0,s.reconnecting=!1,s.isReconnectingOnError=!1,s.reconnectTimer&&(clearTimeout(s.reconnectTimer),s.reconnectTimer=null,s.onReconnectTimerCancel=null),s.getConnectionState()===s.ConnectionState.OPEN&&s.currentUser&&s.currentUser.userId===e?(s.connecting=!1,r(null,s.currentUser)):(s.connectionCallbacks.push(r),1===s.connectionCallbacks.length&&(l.disconnect({clearSession:!0,err:null},null),l.connect(e,t))))}),r)}},{key:"reconnect",value:function(){var e=L.get(this._iid).container,t=e.wsAdapter;if(e.auth.sessionKey&&this.currentUser){var n=!0;return t.reconnectCount>0&&(n=!1),t.disconnect({clearSession:!1,err:new D("Connection has been canceled.",D.CONNECTION_CANCELED)},null),t.reconnectCount=0,t.reconnect(this.currentUser.userId,n),!0}return!1}},{key:"disconnect",value:function(e){var t=this;return _e(this._iid,(function(e){var n=L.get(t._iid).container,i=n.wsAdapter,r=n.onlineDetector;r&&r.stop(),i.disconnect({clearSession:!0,err:new D("Connection has been canceled.",D.CONNECTION_CANCELED)},e)}),e)}},{key:"setBackgroundState",value:function(){var e=L.get(this._iid),t=e.container,n=t.wsAdapter,i=t.stateChangeEnabled;!t.isInBackground&&i&&(e.set("isInBackground",!0),this.getConnectionState()!==this.ConnectionState.CLOSED?(e.set("closedByGoingBackground",!0),n.disconnect({clearSession:!1,err:new D("Websocket connection failed.",D.WEBSOCKET_CONNECTION_FAILED)},null)):e.set("closedByGoingBackground",!1))}},{key:"setForegroundState",value:function(){var e=L.get(this._iid),t=e.container,n=t.wsAdapter,i=t.stateChangeEnabled,r=t.isInBackground,s=t.closedByGoingBackground;r&&i&&(e.set("isInBackground",!1),s&&this.currentUser&&n.reconnect(this.currentUser.userId,!0))}},{key:"enableStateChange",value:function(){L.get(this._iid).set("enableStateChange",!0)}},{key:"disableStateChange",value:function(){L.get(this._iid).set("enableStateChange",!1)}},{key:"addExtension",value:function(e,t){var n=L.get(this._iid).container,i=n.extensions;n.supportedExtensionKeys.indexOf(e)>-1&&(i[e]=t)}},{key:"createUserListQuery",value:function(e){return new(0,G.get(this._iid).UserListQuery)(e)}},{key:"createApplicationUserListQuery",value:function(){return new(0,G.get(this._iid).ApplicationUserListQuery)}},{key:"createBlockedUserListQuery",value:function(){return new(0,G.get(this._iid).BlockedUserListQuery)}},{key:"createFriendListQuery",value:function(){return new(0,G.get(this._iid).FriendListQuery)}},{key:"createMessageSearchQuery",value:function(e,t){return new(0,G.get(this._iid).MessageSearchQuery)(e,t)}},{key:"sendCommand",value:function(e,t){var n=this;return _e(this._iid,(function(t){n.ConnectionManager.ready((function(i,r){if(i)t(i,null);else{var s=L.get(n._iid).container,a=s.wsAdapter,o=s.ackStateMap;if(null==a||null==a.client||a.client.getConnectionState()!==n.ConnectionState.OPEN||n.getConnectionState()!==n.ConnectionState.OPEN)return void t(new D("Connection is not valid. Please reconnect.",D.WEBSOCKET_CONNECTION_CLOSED),null);if(e.isAckRequired){var l=e.requestId,u={handler:t,timer:setTimeout((function(){t(new D("Command received no ack.",D.ACK_TIMEOUT),null),delete o[l]}),n.Options.websocketResponseTimeout)};o[l]=u,a.client.send(e,(function(e){e&&(clearTimeout(u.timer),t(e,null))}))}else a.client.send(e,t)}}),!1)}),t)}},{key:"setSessionHandler",value:function(e){L.get(this._iid).container.sessionManager.handler=e}},{key:"addUserEventHandler",value:function(e,t){t instanceof G.get(this._iid).UserEventHandler&&(this.userEventHandlers[e]=t)}},{key:"removeUserEventHandler",value:function(e){delete this.userEventHandlers[e]}},{key:"removeAllUserEventHandler",value:function(){this.userEventHandlers={}}},{key:"addChannelHandler",value:function(e,t){t instanceof G.get(this._iid).ChannelHandler&&(this.channelHandlers[e]=t)}},{key:"removeChannelHandler",value:function(e){delete this.channelHandlers[e]}},{key:"removeAllChannelHandlers",value:function(){this.channelHandlers={}}},{key:"addConnectionHandler",value:function(e,t){t instanceof G.get(this._iid).ConnectionHandler&&(this.connectionHandlers[e]=t)}},{key:"removeConnectionHandler",value:function(e){delete this.connectionHandlers[e]}},{key:"removeAllConnectionHandlers",value:function(){this.connectionHandlers={}}},{key:"updateCurrentUserInfo",value:function(e,t,n){var i=this,r=null,s=ae.parse(arguments,[new ae({type:"string",nullable:!0}),new ae({type:"string",nullable:!0}),new ae({type:"callback"})]),a=U(s,4);return r=a[0],e=a[1],t=a[2],n=a[3],_e(this._iid,(function(n){r?n(r,null):L.get(i._iid).container.apiClient.updateCurrentUserInfo({nickname:e,profileUrl:t},(function(r,s){var a=null;r||(i.currentUser&&(e&&(i.currentUser.nickname=e),t&&(i.currentUser.plainProfileUrl=t)),a=i.currentUser),n(r,a)}))}),n)}},{key:"updateCurrentUserInfoWithProfileImage",value:function(e,t,n){var i=this,r=null,s=ae.parse(arguments,[new ae({type:"string",nullable:!0}),new ae({type:"file",nullable:!0}),new ae({type:"callback"})]),a=U(s,4);return r=a[0],e=a[1],t=a[2],n=a[3],_e(this._iid,(function(n){r?n(r,null):L.get(i._iid).container.apiClient.updateCurrentUserInfo({nickname:e,profileImage:t},(function(t,r){var s=null;t||(i.currentUser&&(e&&(i.currentUser.nickname=e),r.profile_url&&(i.currentUser.plainProfileUrl=r.profile_url)),s=i.currentUser),n(t,s)}))}),n)}},{key:"updateCurrentUserInfoWithPreferredLanguages",value:function(e,t){var n=this,i=null,r=ae.parse(arguments,[new ae({type:"array",constraint:function(e){return e.every((function(e){return"string"==typeof e}))}}),new ae({type:"callback"})]),s=U(r,3);return i=s[0],e=s[1],t=s[2],_e(this._iid,(function(t){i?t(i,null):L.get(n._iid).container.apiClient.updateCurrentUserInfo({preferredLanguages:e},(function(i,r){var s=null;i||(n.currentUser&&e&&(n.currentUser._preferredLanguages=e),s=n.currentUser),t(i,s)}))}),t)}},{key:"registerGCMPushTokenForCurrentUser",value:function(e,t){var n=this,i=null,r=ae.parse(arguments,[new ae({type:"string",constraint:function(e){return e.length>0}}),new ae({type:"callback"})]),s=U(r,3);return i=s[0],e=s[1],t=s[2],_e(this._iid,(function(t){i?t(i,n.pushTokenRegistrationState.ERROR):n.currentUser?L.get(n._iid).container.apiClient.registerGCMPushToken({token:e},(function(e,i){var r=n.pushTokenRegistrationState.ERROR;e||(n.GCMPushToken="",r=n.pushTokenRegistrationState.SUCCESS),t(e,r)})):(n.GCMPushToken=e,t(null,n.pushTokenRegistrationState.PENDING))}),t)}},{key:"unregisterGCMPushTokenForCurrentUser",value:function(e,t){var n=this,i=null,r=ae.parse(arguments,[new ae({type:"string",constraint:function(e){return e.length>0}}),new ae({type:"callback"})]),s=U(r,3);return i=s[0],e=s[1],t=s[2],_e(this._iid,(function(t){i?t(i,null):n.currentUser?L.get(n._iid).container.apiClient.unregisterGCMPushToken({token:e},(function(e,n){t(e,null)})):(n.GCMPushToken=e,t(null,n.pushTokenRegistrationState.PENDING))}),t)}},{key:"unregisterGCMPushTokenAllForCurrentUser",value:function(e){var t=this;return _e(this._iid,(function(e){L.get(t._iid).container.apiClient.unregisterAllGCMPushTokens({},(function(t,n){e(t,null)}))}),e)}},{key:"registerAPNSPushTokenForCurrentUser",value:function(e,t){var n=this,i=null,r=ae.parse(arguments,[new ae({type:"string",constraint:function(e){return e.length>0}}),new ae({type:"callback"})]),s=U(r,3);return i=s[0],e=s[1],t=s[2],_e(this._iid,(function(t){i?t(i,n.pushTokenRegistrationState.ERROR):n.currentUser?L.get(n._iid).container.apiClient.registerAPNSPushToken({token:e},(function(e,i){var r=n.pushTokenRegistrationState.ERROR;e||(n.APNSPushToken="",r=n.pushTokenRegistrationState.SUCCESS),t(e,r)})):(n.APNSPushToken=e,t(null,n.pushTokenRegistrationState.PENDING))}),t)}},{key:"unregisterAPNSPushTokenForCurrentUser",value:function(e,t){var n=this,i=null,r=ae.parse(arguments,[new ae({type:"string",constraint:function(e){return e.length>0}}),new ae({type:"callback"})]),s=U(r,3);return i=s[0],e=s[1],t=s[2],_e(this._iid,(function(t){i?t(i,null):n.currentUser?L.get(n._iid).container.apiClient.unregisterAPNSPushToken({token:e},(function(e,n){t(e,null)})):(n.APNSPushToken=e,t(null,n.pushTokenRegistrationState.PENDING))}),t)}},{key:"unregisterAPNSPushTokenAllForCurrentUser",value:function(e){var t=this;return _e(this._iid,(function(e){L.get(t._iid).container.apiClient.unregisterAllAPNSPushTokens({},(function(t,n){e(t,null)}))}),e)}},{key:"unregisterPushTokenAllForCurrentUser",value:function(e){var t=this;return _e(this._iid,(function(e){L.get(t._iid).container.apiClient.unregisterAllPushTokens({},(function(t,n){e(t,null)}))}),e)}},{key:"getMyGroupChannelChangeLogsByToken",value:function(e,t,n,i){var r=this,s=null,a=ae.parse(arguments,[new ae({type:"string",nullable:!0}),new ae({type:"array",optional:!0,nullable:!0,defaultValue:null}),new ae({type:"boolean",nullable:!0,optional:!0,defaultValue:null}),new ae({type:"callback"})]),o=U(a,5);s=o[0],e=o[1],t=o[2],n=o[3],i=o[4];var l=G.get(this._iid),u=l.GroupChannelChangeLogsParams,c=null;if(s){var h=ae.parse(arguments,[new ae({type:"string",nullable:!0}),new ae({type:u,constraint:function(e){return e._validate()}}),new ae({type:"callback"})]),p=U(h,4);s=p[0],e=p[1],c=p[2],i=p[3]}else(c=new u).customTypes=t,c.includeEmpty=n,c.includeFrozen=!0;return _e(this._iid,(function(t){s?t(s,null):L.get(r._iid).container.apiClient.getMyGroupChannelChangeLogs(d({ts:null,token:e},c),(function(e,n){if(e)t(e,null);else{var i=G.get(r._iid).GroupChannel,s=n.updated.map((function(e){return new i(e)})),a=n.deleted,o=n.has_more,l=n.next;t(null,{updatedChannels:s,deletedChannelUrls:a,hasMore:o,token:l})}}))}),i)}},{key:"getMyGroupChannelChangeLogsByTimestamp",value:function(e,t,n,i){var r=this,s=null,a=ae.parse(arguments,[new ae({type:"number",constraint:function(e){return e>=0}}),new ae({type:"array",optional:!0,nullable:!0,defaultValue:null}),new ae({type:"boolean",nullable:!0,optional:!0,defaultValue:null}),new ae({type:"callback"})]),o=U(a,5);s=o[0],e=o[1],t=o[2],n=o[3],i=o[4];var l=G.get(this._iid),u=l.GroupChannelChangeLogsParams,c=null;if(s){var h=ae.parse(arguments,[new ae({type:"number",constraint:function(e){return e>=0}}),new ae({type:u,constraint:function(e){return e._validate()}}),new ae({type:"callback"})]),p=U(h,4);s=p[0],e=p[1],c=p[2],i=p[3]}else(c=new u).customTypes=t,c.includeEmpty=n,c.includeFrozen=!0;return _e(this._iid,(function(t){s?t(s,null):L.get(r._iid).container.apiClient.getMyGroupChannelChangeLogs(d({ts:e,token:null},c),(function(e,n){if(e)t(e,null);else{var i=G.get(r._iid).GroupChannel,s=n.updated.map((function(e){return new i(e)})),a=n.deleted,o=n.has_more,l=n.next;t(null,{updatedChannels:s,deletedChannelUrls:a,hasMore:o,token:l})}}))}),i)}},{key:"getChannelInvitationPreference",value:function(e){var t=this;return _e(this._iid,(function(e){L.get(t._iid).container.apiClient.getChannelInvitationPreference({},(function(t,n){var i=null;t||(i={autoAccept:n.auto_accept}),e(t,i)}))}),e)}},{key:"setChannelInvitationPreference",value:function(e,t){var n=this,i=null,r=ae.parse(arguments,[new ae({type:"boolean"}),new ae({type:"callback"})]),s=U(r,3);return i=s[0],e=s[1],t=s[2],_e(this._iid,(function(t){i?t(i,null):L.get(n._iid).container.apiClient.setChannelInvitationPreference({isAutoAccept:e},(function(e,n){var i=null;e||(i={autoAccept:n.auto_accept}),t(e,i)}))}),t)}},{key:"getDoNotDisturb",value:function(e){var t=this;return _e(this._iid,(function(e){L.get(t._iid).container.apiClient.getDoNotDisturb({},(function(t,n){var i=null;t||(i={doNotDisturbOn:n.do_not_disturb,startHour:n.start_hour,startMin:n.start_min,endHour:n.end_hour,endMin:n.end_min,timezone:n.timezone}),e(t,i)}))}),e)}},{key:"setDoNotDisturb",value:function(e,t,n,i,r,s,a){var o=this,l=null,u=ae.parse(arguments,[new ae({type:"boolean"}),new ae({type:"number",constraint:function(e){return 0<=e&&e<=23}}),new ae({type:"number",constraint:function(e){return 0<=e&&e<=59}}),new ae({type:"number",constraint:function(e){return 0<=e&&e<=23}}),new ae({type:"number",constraint:function(e){return 0<=e&&e<=59}}),new ae({type:"string"}),new ae({type:"callback"})]),c=U(u,8);return l=c[0],e=c[1],t=c[2],n=c[3],i=c[4],r=c[5],s=c[6],a=c[7],_e(this._iid,(function(a){l?a(l,null):L.get(o._iid).container.apiClient.setDoNotDisturb({doNotDisturbOn:e,startHour:t,startMin:n,endHour:i,endMin:r,timezone:s},(function(e,t){var n=null;e||(n={doNotDisturbOn:t.do_not_disturb,startHour:t.start_hour,startMin:t.start_min,endHour:t.end_hour,endMin:t.end_min,timezone:t.timezone}),a(e,n)}))}),a)}},{key:"getSnoozePeriod",value:function(e){var t=this;return _e(this._iid,(function(e){L.get(t._iid).container.apiClient.getSnoozePeriod({},(function(t,n){var i=null;t||(i={isSnoozeOn:n.snooze_enabled,startTs:n.snooze_start_ts,endTs:n.snooze_end_ts}),e(t,i)}))}),e)}},{key:"setSnoozePeriod",value:function(e,t,n,i){var r=this,s=null,a=ae.parse(arguments,[new ae({type:"boolean"}),new ae({type:"number",constraint:function(e){return e>0}}),new ae({type:"number",constraint:function(e){return e>0}}),new ae({type:"callback"})]),o=U(a,5);return s=o[0],e=o[1],t=o[2],n=o[3],i=o[4],_e(this._iid,(function(i){s?i(s,null):L.get(r._iid).container.apiClient.setSnoozePeriod({snoozeOn:e,startTs:t,endTs:n},(function(e,t){var n=null;e||(n={isSnoozeOn:t.snooze_enabled,startTs:t.snooze_start_ts,endTs:t.snooze_end_ts}),i(e,n)}))}),i)}},{key:"blockUser",value:function(e,t){var n=null,i=ae.parse(arguments,[new ae({type:"object",constraint:function(e){return e&&e.hasOwnProperty("userId")}}),new ae({type:"callback"})]),r=U(i,3);return n=r[0],e=r[1],t=r[2],n?_e(this._iid,(function(e){e(n,null)}),t):this.blockUserWithUserId(e.userId,t)}},{key:"blockUserWithUserId",value:function(e,t){var n=this,i=null,r=ae.parse(arguments,[new ae({type:"string",constraint:function(e){return e&&(!n.currentUser||e!==n.currentUser.userId)}}),new ae({type:"callback"})]),s=U(r,3);return i=s[0],e=s[1],t=s[2],_e(this._iid,(function(t){i?t(i,null):L.get(n._iid).container.apiClient.blockUser({blockedUserId:e},(function(e,n){var i=null;e||(i=new be(n)),t(e,i)}))}),t)}},{key:"unblockUser",value:function(e,t){var n=null,i=ae.parse(arguments,[new ae({type:"object",constraint:function(e){return e&&e.hasOwnProperty("userId")}}),new ae({type:"callback"})]),r=U(i,3);return n=r[0],e=r[1],t=r[2],n?_e(this._iid,(function(e){e(n,null)}),t):this.unblockUserWithUserId(e.userId,t)}},{key:"unblockUserWithUserId",value:function(e,t){var n=this,i=null,r=ae.parse(arguments,[new ae({type:"string",constraint:function(e){return e&&(!n.currentUser||e!==n.currentUser.userId)}}),new ae({type:"callback"})]),s=U(r,3);return i=s[0],e=s[1],t=s[2],_e(this._iid,(function(t){i?t(i,null):L.get(n._iid).container.apiClient.unblockUser({unblockedUserId:e},(function(e,n){t(e,null)}))}),t)}},{key:"getPushTriggerOption",value:function(e){var t=this;return _e(this._iid,(function(e){L.get(t._iid).container.apiClient.getPushTriggerOption({},(function(t,n){e(t,n?n.push_trigger_option:null)}))}),e)}},{key:"setPushTriggerOption",value:function(e,t){var n=this;return _e(this._iid,(function(t){Object.keys(n.PushTriggerOption).map((function(e){return n.PushTriggerOption[e]})).indexOf(e)>-1?L.get(n._iid).container.apiClient.setPushTriggerOption({pushTriggerOption:e},(function(e,n){t(e,n?n.push_trigger_option:null)})):t(ae.error,null)}),t)}},{key:"getGroupChannelCount",value:function(e,t){var n=this,i=G.get(this._iid),r=i.GroupChannel,s=null,a=ae.parse(arguments,[new ae({type:r.MemberStateFilter,optional:!0,defaultValue:r.MemberStateFilter.ALL}),new ae({type:"callback"})]),o=U(a,3);return s=o[0],e=o[1],t=o[2],_e(this._iid,(function(t){s?t(s,null):L.get(n._iid).container.apiClient.getGroupChannelCount({memberStateFilter:e},(function(e,n){var i=null;e||(i=parseInt(n.group_channel_count)),t(e,i)}))}),t)}},{key:"getTotalUnreadChannelCount",value:function(e){var t=this;return _e(this._iid,(function(e){L.get(t._iid).container.apiClient.getTotalUnreadChannelCount({},(function(t,n){var i=null;t||(i=parseInt(n.unread_count)),e(t,i)}))}),e)}},{key:"getTotalUnreadMessageCount",value:function(e,t){var n=this,i=G.get(this._iid),r=i.GroupChannel,s=i.GroupChannelTotalUnreadMessageCountParams,a=null,o=ae.parse(arguments,[new ae({type:"object",optional:!0,defaultValue:null,constraint:function(e){return Array.isArray(e)&&e.every((function(e){return"string"==typeof e}))||e instanceof s}}),new ae({type:"callback"})]),l=U(o,3);return a=l[0],e=l[1],t=l[2],_e(this._iid,(function(t){if(a)t(a,null);else{var i=r.SuperChannelFilter.ALL;if(e instanceof s){var o=e;e=o.channelCustomTypesFilter,i=o.superChannelFilter}L.get(n._iid).container.apiClient.getTotalUnreadMessageCount({customTypesFilter:e,superChannelFilter:i},(function(e,n){var i=null;e||(i=parseInt(n.unread_count)),t(e,i)}))}}),t)}},{key:"getUnreadItemCount",value:function(e,t){var n=this,i=null,r=ae.parse(arguments,[new ae({type:"array",constraint:function(e){return e.length>0&&e.every((function(e){return Object.keys(Fe.UnreadItemKey).map((function(e){return Fe.UnreadItemKey[e]})).indexOf(e)>-1}))}}),new ae({type:"callback"})]),s=U(r,3);return i=s[0],e=s[1],t=s[2],_e(this._iid,(function(t){if(i)t(i,null);else{var r=e.filter((function(t,n){return e.indexOf(t)===n}));L.get(n._iid).container.apiClient.getUnreadItemCount({keys:r},(function(e,n){t(e,n)}))}}),t)}},{key:"getSubscribedTotalUnreadMessageCount",value:function(){var e=L.get(this._iid).container.subscribedUnreadMessageCount;return e.all>=0?e.all:0}},{key:"getSubscribedCustomTypeTotalUnreadMessageCount",value:function(){var e=L.get(this._iid).container.subscribedUnreadMessageCount;if(Object.keys(e.custom_types).length>0){var t=0;return Object.keys(e.custom_types).forEach((function(n){t+=e.custom_types[n]})),t}return 0}},{key:"getSubscribedCustomTypeUnreadMessageCount",value:function(e){if(e&&"string"==typeof e){var t=L.get(this._iid).container.subscribedUnreadMessageCount;return t.custom_types.hasOwnProperty(e)?t.custom_types[e]:0}return 0}},{key:"getMyPushTokensByToken",value:function(e,t,n){var i=this,r=null,s=ae.parse(arguments,[new ae({type:"string"}),new ae({type:"string",constraint:function(e){return["gcm","apns","apns_voip"].indexOf(e)>-1}}),new ae({type:"callback"})]),a=U(s,4);return r=a[0],e=a[1],t=a[2],n=a[3],_e(this._iid,(function(n){r?n(r,null):L.get(i._iid).container.apiClient.getPushTokens({ts:null,token:e,type:t},(function(e,t){if(e)n(e,null);else{var i=t.type;n(null,{deviceTokens:t.device_tokens,type:i?i.toLowerCase():"unknown",hasMore:t.has_more,token:t.token})}}))}),n)}},{key:"getPushTemplate",value:function(e){var t=this;return _e(this._iid,(function(e){L.get(t._iid).container.apiClient.getPushTemplate({},(function(t,n){var i=null;t||(i=n.name.toString()),e(t,i)}))}),e)}},{key:"setPushTemplate",value:function(e,t){var n=this;return _e(this._iid,(function(t){[n.PUSH_TEMPLATE_DEFAULT,n.PUSH_TEMPLATE_ALTERNATIVE].indexOf(e)>-1?L.get(n._iid).container.apiClient.setPushTemplate({templateName:e},(function(e,n){var i=null;e||(i=n.name.toString()),t(e,i)})):t(ae.error,null)}),t)}},{key:"markAsReadAll",value:function(e){var t=this;return _e(this._iid,(function(e){var n=G.get(t._iid).GroupChannel,i=(new Date).getTime();i-n.markAsReadAllLastSentAt<1e3?e(new D("MarkAsRead rate limit exceeded.",D.MARK_AS_READ_RATE_LIMIT_EXCEEDED),null):(n.markAsReadAllLastSentAt=i,L.get(t._iid).container.apiClient.markAsReadAll({channelUrls:null},(function(r,s){r||Object.keys(n.cachedChannels).forEach((function(e){t.currentUser&&n.cachedChannels[e].updateReadReceipt(t.currentUser.userId,i),n.cachedChannels[e]._setGroupChannelUnreadCount(0,0)})),e(r,null)})))}),e)}},{key:"markAsReadWithChannelUrls",value:function(e,t){var n=this,i=null,r=ae.parse(arguments,[new ae({type:"array",constraint:function(e){return e.every((function(e){return"string"==typeof e}))}}),new ae({type:"callback"})]),s=U(r,3);return i=s[0],e=s[1],t=s[2],_e(this._iid,(function(t){if(i)t(i,null);else{var r=(new Date).getTime();L.get(n._iid).container.apiClient.markAsReadAll({channelUrls:e},(function(i,s){i||e.forEach((function(e){Fe.cachedChannels[e]&&(n.currentUser&&Fe.cachedChannels[e].updateReadReceipt(n.currentUser.userId,r),Fe.cachedChannels[e]._setGroupChannelUnreadCount(0,0))})),t(i,null)}))}}),t)}},{key:"markAsDelivered",value:function(e){"string"==typeof e&&G.get(this._iid).GroupChannel.getChannel(e,w.INTERNAL_CALL,(function(e,t){e||t.markAsDelivered()}))}},{key:"getFriendChangeLogsByToken",value:function(e,t){var n=this,i=null,r=ae.parse(arguments,[new ae({type:"string",optional:!0,defaultValue:null}),new ae({type:"callback"})]),s=U(r,3);return i=s[0],e=s[1],t=s[2],_e(this._iid,(function(t){i?t(i,null):L.get(n._iid).container.apiClient.getFriendChangeLogsByToken({token:e},(function(e,i){var r=null;if(!e){var s=G.get(n._iid).User;r={updatedUsers:i.updated.map((function(e){return new s(e)})),deletedUserIds:i.deleted,hasMore:i.has_more,token:i.next}}t(e,r)}))}),t)}},{key:"uploadFriendDiscoveries",value:function(e,t){var n=this,i=null,r=ae.parse(arguments,[new ae({type:"array",constraint:function(e){return e.every((function(e){return e.hasOwnProperty("friendDiscoveryKey")}))}}),new ae({type:"callback"})]),s=U(r,3);return i=s[0],e=s[1],t=s[2],_e(this._iid,(function(t){i?t(i,null):L.get(n._iid).container.apiClient.uploadFriendDiscoveries({discoveries:e},(function(e,n){t(e,n)}))}),t)}},{key:"deleteFriendDiscovery",value:function(e,t){var n=null,i=ae.parse(arguments,[new ae({type:"string"}),new ae({type:"callback"})]),r=U(i,3);return n=r[0],e=r[1],t=r[2],n?_e(this._iid,(function(e){e(n,null)}),t):this.deleteFriendDiscoveries([e],t)}},{key:"deleteFriendDiscoveries",value:function(e,t){var n=this,i=null,r=ae.parse(arguments,[new ae({type:"array",constraint:function(e){return e.every((function(e){return"string"==typeof e}))}}),new ae({type:"callback"})]),s=U(r,3);return i=s[0],e=s[1],t=s[2],_e(this._iid,(function(t){i?t(i,null):L.get(n._iid).container.apiClient.deleteFriendDiscoveries({discoveryKeys:e},(function(e,n){t(e,n)}))}),t)}},{key:"addFriends",value:function(e,t){var n=this,i=null,r=ae.parse(arguments,[new ae({type:"array",constraint:function(e){return e.every((function(e){return"string"==typeof e}))}}),new ae({type:"callback"})]),s=U(r,3);return i=s[0],e=s[1],t=s[2],_e(this._iid,(function(t){i?t(i,null):L.get(n._iid).container.apiClient.addFriends({userIds:e},(function(e,i){var r=null;if(!e){var s=G.get(n._iid).User;r=i.users.map((function(e){return new s(e)}))}t(e,r)}))}),t)}},{key:"deleteFriend",value:function(e,t){var n=null,i=ae.parse(arguments,[new ae({type:"string"}),new ae({type:"callback"})]),r=U(i,3);return n=r[0],e=r[1],t=r[2],n?_e(this._iid,(function(e){e(n,null)}),t):this.deleteFriends([e],t)}},{key:"deleteFriends",value:function(e,t){var n=this,i=null,r=ae.parse(arguments,[new ae({type:"array",constraint:function(e){return e.every((function(e){return"string"==typeof e}))}}),new ae({type:"callback"})]),s=U(r,3);return i=s[0],e=s[1],t=s[2],_e(this._iid,(function(t){i?t(i,null):L.get(n._iid).container.apiClient.deleteFriends({userIds:e},(function(e,n){t(e,n)}))}),t)}},{key:"getAllEmoji",value:function(e){var t=this,n=null,i=ae.parse(arguments,[new ae({type:"callback"})]),r=U(i,2);return n=r[0],e=r[1],_e(this._iid,(function(e){n?e(n,null):L.get(t._iid).container.apiClient.getAllEmoji((function(n,i){if(n)e(n,null);else{var r=new(0,G.get(t._iid).EmojiContainer)(i);e(null,r)}}))}),e)}},{key:"getEmojiCategory",value:function(e,t){var n=this,i=null,r=ae.parse(arguments,[new ae({type:"number",constraint:function(e){return e>=0}}),new ae({type:"callback"})]),s=U(r,3);return i=s[0],e=s[1],t=s[2],_e(this._iid,(function(t){i?t(i,null):L.get(n._iid).container.apiClient.getEmojiCategory({categoryId:e},(function(e,i){if(e)t(e,null);else{var r=new(0,G.get(n._iid).EmojiCategory)(i);t(null,r)}}))}),t)}},{key:"getEmoji",value:function(e,t){var n=this,i=null,r=ae.parse(arguments,[new ae({type:"string"}),new ae({type:"callback"})]),s=U(r,3);return i=s[0],e=s[1],t=s[2],_e(this._iid,(function(t){i?t(i,null):L.get(n._iid).container.apiClient.getEmoji({emojiKey:e},(function(e,i){if(e)t(e,null);else{var r=new(0,G.get(n._iid).Emoji)(i);t(null,r)}}))}),t)}},{key:"getAllowFriendDiscovery",value:function(e){var t=this,n=null,i=ae.parse(arguments,[new ae({type:"callback"})]),r=U(i,2);return n=r[0],e=r[1],_e(this._iid,(function(e){n?e(n,null):L.get(t._iid).container.apiClient.getAllowFriendDiscovery((function(t,n){var i=n.allow_friend_discovery;t?e(t,null):e(null,i)}))}),e)}},{key:"setAllowFriendDiscovery",value:function(e,t){var n=this,i=null,r=ae.parse(arguments,[new ae({type:"boolean"}),new ae({type:"callback"})]),s=U(r,3);return i=s[0],e=s[1],t=s[2],_e(this._iid,(function(t){i?t(i,null):L.get(n._iid).container.apiClient.setAllowFriendDiscovery({allowFriendDiscovery:e},(function(n,i){n?t(n,null):t(null,e)}))}),t)}}],[{key:"version",get:function(){return w.SDK_VERSION}},{key:"LogLevel",get:function(){return W.supportedLogLevels}},{key:"getInstance",value:function(e){return e?hn[e]:dn}},{key:"getLogLevel",value:function(){return W.logLevel}},{key:"setLogLevel",value:function(e){var t=Object.values(W.supportedLogLevels);if(t.includes(e))W.logLevel=e;else{W.logLevel=W.defaultLogLevel;var n=t.map((function(e){return"'".concat(e,"'")})).join(", ");W.warn("`logLevel` parameter should be one of","".concat(n,","),"not `'".concat(e,"'`."),"Set to default log level","`".concat(W.defaultLogLevel,"`."))}}}]),e}();return fn}(n(19),n(38),n(39))}).call(this,n(3),n(15).Buffer,n(4))},function(e,t){var n,i,r=e.exports={};function s(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function o(e){if(n===setTimeout)return setTimeout(e,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:s}catch(e){n=s}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(e){i=a}}();var l,u=[],c=!1,d=-1;function h(){c&&l&&(c=!1,l.length?u=l.concat(u):d=-1,u.length&&p())}function p(){if(!c){var e=o(h);c=!0;for(var t=u.length;t;){for(l=u,u=[];++d<t;)l&&l[d].run();d=-1,t=u.length}l=null,c=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function g(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new f(e,t)),1!==u.length||c||o(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=g,r.addListener=g,r.once=g,r.off=g,r.removeListener=g,r.removeAllListeners=g,r.emit=g,r.prependListener=g,r.prependOnceListener=g,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";(function(t){var i=n(1),r=n(25),s=n(8),a={"Content-Type":"application/x-www-form-urlencoded"};function o(e,t){!i.isUndefined(e)&&i.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var l,u={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==t&&"[object process]"===Object.prototype.toString.call(t))&&(l=n(9)),l),transformRequest:[function(e,t){return r(t,"Accept"),r(t,"Content-Type"),i.isFormData(e)||i.isArrayBuffer(e)||i.isBuffer(e)||i.isStream(e)||i.isFile(e)||i.isBlob(e)?e:i.isArrayBufferView(e)?e.buffer:i.isURLSearchParams(e)?(o(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):i.isObject(e)||t&&"application/json"===t["Content-Type"]?(o(t,"application/json"),function(e,t,n){if(i.isString(e))try{return(t||JSON.parse)(e),i.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional,n=t&&t.silentJSONParsing,r=t&&t.forcedJSONParsing,a=!n&&"json"===this.responseType;if(a||r&&i.isString(e)&&e.length)try{return JSON.parse(e)}catch(e){if(a){if("SyntaxError"===e.name)throw s(e,this,"E_JSON_PARSE");throw e}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300}};u.headers={common:{Accept:"application/json, text/plain, */*"}},i.forEach(["delete","get","head"],(function(e){u.headers[e]={}})),i.forEach(["post","put","patch"],(function(e){u.headers[e]=i.merge(a)})),e.exports=u}).call(this,n(3))},function(e,t,n){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),i=0;i<n.length;i++)n[i]=arguments[i];return e.apply(t,n)}}},function(e,t,n){"use strict";var i=n(1);function r(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var s;if(n)s=n(t);else if(i.isURLSearchParams(t))s=t.toString();else{var a=[];i.forEach(t,(function(e,t){null!=e&&(i.isArray(e)?t+="[]":e=[e],i.forEach(e,(function(e){i.isDate(e)?e=e.toISOString():i.isObject(e)&&(e=JSON.stringify(e)),a.push(r(t)+"="+r(e))})))})),s=a.join("&")}if(s){var o=e.indexOf("#");-1!==o&&(e=e.slice(0,o)),e+=(-1===e.indexOf("?")?"?":"&")+s}return e}},function(e,t,n){"use strict";e.exports=function(e,t,n,i,r){return e.config=t,n&&(e.code=n),e.request=i,e.response=r,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},function(e,t,n){"use strict";var i=n(1),r=n(26),s=n(27),a=n(7),o=n(28),l=n(31),u=n(32),c=n(10);e.exports=function(e){return new Promise((function(t,n){var d=e.data,h=e.headers,p=e.responseType;i.isFormData(d)&&delete h["Content-Type"];var f=new XMLHttpRequest;if(e.auth){var g=e.auth.username||"",y=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";h.Authorization="Basic "+btoa(g+":"+y)}var m=o(e.baseURL,e.url);function _(){if(f){var i="getAllResponseHeaders"in f?l(f.getAllResponseHeaders()):null,s={data:p&&"text"!==p&&"json"!==p?f.response:f.responseText,status:f.status,statusText:f.statusText,headers:i,config:e,request:f};r(t,n,s),f=null}}if(f.open(e.method.toUpperCase(),a(m,e.params,e.paramsSerializer),!0),f.timeout=e.timeout,"onloadend"in f?f.onloadend=_:f.onreadystatechange=function(){f&&4===f.readyState&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))&&setTimeout(_)},f.onabort=function(){f&&(n(c("Request aborted",e,"ECONNABORTED",f)),f=null)},f.onerror=function(){n(c("Network Error",e,null,f)),f=null},f.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(c(t,e,e.transitional&&e.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",f)),f=null},i.isStandardBrowserEnv()){var v=(e.withCredentials||u(m))&&e.xsrfCookieName?s.read(e.xsrfCookieName):void 0;v&&(h[e.xsrfHeaderName]=v)}"setRequestHeader"in f&&i.forEach(h,(function(e,t){void 0===d&&"content-type"===t.toLowerCase()?delete h[t]:f.setRequestHeader(t,e)})),i.isUndefined(e.withCredentials)||(f.withCredentials=!!e.withCredentials),p&&"json"!==p&&(f.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&f.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&f.upload&&f.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){f&&(f.abort(),n(e),f=null)})),d||(d=null),f.send(d)}))}},function(e,t,n){"use strict";var i=n(8);e.exports=function(e,t,n,r,s){var a=new Error(e);return i(a,t,n,r,s)}},function(e,t,n){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,n){"use strict";var i=n(1);e.exports=function(e,t){t=t||{};var n={},r=["url","method","data"],s=["headers","auth","proxy","params"],a=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],o=["validateStatus"];function l(e,t){return i.isPlainObject(e)&&i.isPlainObject(t)?i.merge(e,t):i.isPlainObject(t)?i.merge({},t):i.isArray(t)?t.slice():t}function u(r){i.isUndefined(t[r])?i.isUndefined(e[r])||(n[r]=l(void 0,e[r])):n[r]=l(e[r],t[r])}i.forEach(r,(function(e){i.isUndefined(t[e])||(n[e]=l(void 0,t[e]))})),i.forEach(s,u),i.forEach(a,(function(r){i.isUndefined(t[r])?i.isUndefined(e[r])||(n[r]=l(void 0,e[r])):n[r]=l(void 0,t[r])})),i.forEach(o,(function(i){i in t?n[i]=l(e[i],t[i]):i in e&&(n[i]=l(void 0,e[i]))}));var c=r.concat(s).concat(a).concat(o),d=Object.keys(e).concat(Object.keys(t)).filter((function(e){return-1===c.indexOf(e)}));return i.forEach(d,u),n}},function(e,t,n){"use strict";function i(e){this.message=e}i.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},i.prototype.__CANCEL__=!0,e.exports=i},function(e,t,n){n(41),e.exports=n(40)},function(e,t,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var i=n(16),r=n(17),s=n(18);function a(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=l.prototype:(null===e&&(e=new l(t)),e.length=t),e}function l(e,t,n){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return d(this,e)}return u(this,e,t,n)}function u(e,t,n,i){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,i){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,n):new Uint8Array(t,n,i);l.TYPED_ARRAY_SUPPORT?(e=t).__proto__=l.prototype:e=h(e,t);return e}(e,t,n,i):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!l.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=0|f(t,n),r=(e=o(e,i)).write(t,n);r!==i&&(e=e.slice(0,r));return e}(e,t,n):function(e,t){if(l.isBuffer(t)){var n=0|p(t.length);return 0===(e=o(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(i=t.length)!=i?o(e,0):h(e,t);if("Buffer"===t.type&&s(t.data))return h(e,t.data)}var i;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function d(e,t){if(c(t),e=o(e,t<0?0:0|p(t)),!l.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function h(e,t){var n=t.length<0?0:0|p(t.length);e=o(e,n);for(var i=0;i<n;i+=1)e[i]=255&t[i];return e}function p(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e}function f(e,t){if(l.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return x(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return j(e).length;default:if(i)return x(e).length;t=(""+t).toLowerCase(),i=!0}}function g(e,t,n){var i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return T(this,t,n);case"utf8":case"utf-8":return I(this,t,n);case"ascii":return U(this,t,n);case"latin1":case"binary":return O(this,t,n);case"base64":return k(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,t,n);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function y(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}function m(e,t,n,i,r){if(0===e.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=r?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(r)return-1;n=e.length-1}else if(n<0){if(!r)return-1;n=0}if("string"==typeof t&&(t=l.from(t,i)),l.isBuffer(t))return 0===t.length?-1:_(e,t,n,i,r);if("number"==typeof t)return t&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):_(e,[t],n,i,r);throw new TypeError("val must be string, number or Buffer")}function _(e,t,n,i,r){var s,a=1,o=e.length,l=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;a=2,o/=2,l/=2,n/=2}function u(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(r){var c=-1;for(s=n;s<o;s++)if(u(e,s)===u(t,-1===c?0:s-c)){if(-1===c&&(c=s),s-c+1===l)return c*a}else-1!==c&&(s-=s-c),c=-1}else for(n+l>o&&(n=o-l),s=n;s>=0;s--){for(var d=!0,h=0;h<l;h++)if(u(e,s+h)!==u(t,h)){d=!1;break}if(d)return s}return-1}function v(e,t,n,i){n=Number(n)||0;var r=e.length-n;i?(i=Number(i))>r&&(i=r):i=r;var s=t.length;if(s%2!=0)throw new TypeError("Invalid hex string");i>s/2&&(i=s/2);for(var a=0;a<i;++a){var o=parseInt(t.substr(2*a,2),16);if(isNaN(o))return a;e[n+a]=o}return a}function E(e,t,n,i){return B(x(t,e.length-n),e,n,i)}function C(e,t,n,i){return B(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,i)}function b(e,t,n,i){return C(e,t,n,i)}function S(e,t,n,i){return B(j(t),e,n,i)}function A(e,t,n,i){return B(function(e,t){for(var n,i,r,s=[],a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),i=n>>8,r=n%256,s.push(r),s.push(i);return s}(t,e.length-n),e,n,i)}function k(e,t,n){return 0===t&&n===e.length?i.fromByteArray(e):i.fromByteArray(e.slice(t,n))}function I(e,t,n){n=Math.min(e.length,n);for(var i=[],r=t;r<n;){var s,a,o,l,u=e[r],c=null,d=u>239?4:u>223?3:u>191?2:1;if(r+d<=n)switch(d){case 1:u<128&&(c=u);break;case 2:128==(192&(s=e[r+1]))&&(l=(31&u)<<6|63&s)>127&&(c=l);break;case 3:s=e[r+1],a=e[r+2],128==(192&s)&&128==(192&a)&&(l=(15&u)<<12|(63&s)<<6|63&a)>2047&&(l<55296||l>57343)&&(c=l);break;case 4:s=e[r+1],a=e[r+2],o=e[r+3],128==(192&s)&&128==(192&a)&&128==(192&o)&&(l=(15&u)<<18|(63&s)<<12|(63&a)<<6|63&o)>65535&&l<1114112&&(c=l)}null===c?(c=65533,d=1):c>65535&&(c-=65536,i.push(c>>>10&1023|55296),c=56320|1023&c),i.push(c),r+=d}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);var n="",i=0;for(;i<t;)n+=String.fromCharCode.apply(String,e.slice(i,i+=4096));return n}(i)}t.Buffer=l,t.SlowBuffer=function(e){+e!=e&&(e=0);return l.alloc(+e)},t.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=a(),l.poolSize=8192,l._augment=function(e){return e.__proto__=l.prototype,e},l.from=function(e,t,n){return u(null,e,t,n)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(e,t,n){return function(e,t,n,i){return c(t),t<=0?o(e,t):void 0!==n?"string"==typeof i?o(e,t).fill(n,i):o(e,t).fill(n):o(e,t)}(null,e,t,n)},l.allocUnsafe=function(e){return d(null,e)},l.allocUnsafeSlow=function(e){return d(null,e)},l.isBuffer=function(e){return!(null==e||!e._isBuffer)},l.compare=function(e,t){if(!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,i=t.length,r=0,s=Math.min(n,i);r<s;++r)if(e[r]!==t[r]){n=e[r],i=t[r];break}return n<i?-1:i<n?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!s(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var i=l.allocUnsafe(t),r=0;for(n=0;n<e.length;++n){var a=e[n];if(!l.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(i,r),r+=a.length}return i},l.byteLength=f,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)y(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},l.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?I(this,0,e):g.apply(this,arguments)},l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},l.prototype.compare=function(e,t,n,i,r){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===i&&(i=0),void 0===r&&(r=this.length),t<0||n>e.length||i<0||r>this.length)throw new RangeError("out of range index");if(i>=r&&t>=n)return 0;if(i>=r)return-1;if(t>=n)return 1;if(this===e)return 0;for(var s=(r>>>=0)-(i>>>=0),a=(n>>>=0)-(t>>>=0),o=Math.min(s,a),u=this.slice(i,r),c=e.slice(t,n),d=0;d<o;++d)if(u[d]!==c[d]){s=u[d],a=c[d];break}return s<a?-1:a<s?1:0},l.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return m(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return m(this,e,t,n,!1)},l.prototype.write=function(e,t,n,i){if(void 0===t)i="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)i=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}var r=this.length-t;if((void 0===n||n>r)&&(n=r),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var s=!1;;)switch(i){case"hex":return v(this,e,t,n);case"utf8":case"utf-8":return E(this,e,t,n);case"ascii":return C(this,e,t,n);case"latin1":case"binary":return b(this,e,t,n);case"base64":return S(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,e,t,n);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),s=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function U(e,t,n){var i="";n=Math.min(e.length,n);for(var r=t;r<n;++r)i+=String.fromCharCode(127&e[r]);return i}function O(e,t,n){var i="";n=Math.min(e.length,n);for(var r=t;r<n;++r)i+=String.fromCharCode(e[r]);return i}function T(e,t,n){var i=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>i)&&(n=i);for(var r="",s=t;s<n;++s)r+=G(e[s]);return r}function R(e,t,n){for(var i=e.slice(t,n),r="",s=0;s<i.length;s+=2)r+=String.fromCharCode(i[s]+256*i[s+1]);return r}function N(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function w(e,t,n,i,r,s){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>r||t<s)throw new RangeError('"value" argument is out of bounds');if(n+i>e.length)throw new RangeError("Index out of range")}function M(e,t,n,i){t<0&&(t=65535+t+1);for(var r=0,s=Math.min(e.length-n,2);r<s;++r)e[n+r]=(t&255<<8*(i?r:1-r))>>>8*(i?r:1-r)}function P(e,t,n,i){t<0&&(t=4294967295+t+1);for(var r=0,s=Math.min(e.length-n,4);r<s;++r)e[n+r]=t>>>8*(i?r:3-r)&255}function L(e,t,n,i,r,s){if(n+i>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function D(e,t,n,i,s){return s||L(e,0,n,4),r.write(e,t,n,i,23,4),n+4}function H(e,t,n,i,s){return s||L(e,0,n,8),r.write(e,t,n,i,52,8),n+8}l.prototype.slice=function(e,t){var n,i=this.length;if((e=~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),(t=void 0===t?i:~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e),l.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=l.prototype;else{var r=t-e;n=new l(r,void 0);for(var s=0;s<r;++s)n[s]=this[s+e]}return n},l.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||N(e,t,this.length);for(var i=this[e],r=1,s=0;++s<t&&(r*=256);)i+=this[e+s]*r;return i},l.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||N(e,t,this.length);for(var i=this[e+--t],r=1;t>0&&(r*=256);)i+=this[e+--t]*r;return i},l.prototype.readUInt8=function(e,t){return t||N(e,1,this.length),this[e]},l.prototype.readUInt16LE=function(e,t){return t||N(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUInt16BE=function(e,t){return t||N(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUInt32LE=function(e,t){return t||N(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUInt32BE=function(e,t){return t||N(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||N(e,t,this.length);for(var i=this[e],r=1,s=0;++s<t&&(r*=256);)i+=this[e+s]*r;return i>=(r*=128)&&(i-=Math.pow(2,8*t)),i},l.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||N(e,t,this.length);for(var i=t,r=1,s=this[e+--i];i>0&&(r*=256);)s+=this[e+--i]*r;return s>=(r*=128)&&(s-=Math.pow(2,8*t)),s},l.prototype.readInt8=function(e,t){return t||N(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){t||N(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(e,t){t||N(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(e,t){return t||N(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return t||N(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return t||N(e,4,this.length),r.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return t||N(e,4,this.length),r.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return t||N(e,8,this.length),r.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return t||N(e,8,this.length),r.read(this,e,!1,52,8)},l.prototype.writeUIntLE=function(e,t,n,i){(e=+e,t|=0,n|=0,i)||w(this,e,t,n,Math.pow(2,8*n)-1,0);var r=1,s=0;for(this[t]=255&e;++s<n&&(r*=256);)this[t+s]=e/r&255;return t+n},l.prototype.writeUIntBE=function(e,t,n,i){(e=+e,t|=0,n|=0,i)||w(this,e,t,n,Math.pow(2,8*n)-1,0);var r=n-1,s=1;for(this[t+r]=255&e;--r>=0&&(s*=256);)this[t+r]=e/s&255;return t+n},l.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||w(this,e,t,1,255,0),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||w(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):M(this,e,t,!0),t+2},l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||w(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):M(this,e,t,!1),t+2},l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||w(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):P(this,e,t,!0),t+4},l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||w(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):P(this,e,t,!1),t+4},l.prototype.writeIntLE=function(e,t,n,i){if(e=+e,t|=0,!i){var r=Math.pow(2,8*n-1);w(this,e,t,n,r-1,-r)}var s=0,a=1,o=0;for(this[t]=255&e;++s<n&&(a*=256);)e<0&&0===o&&0!==this[t+s-1]&&(o=1),this[t+s]=(e/a>>0)-o&255;return t+n},l.prototype.writeIntBE=function(e,t,n,i){if(e=+e,t|=0,!i){var r=Math.pow(2,8*n-1);w(this,e,t,n,r-1,-r)}var s=n-1,a=1,o=0;for(this[t+s]=255&e;--s>=0&&(a*=256);)e<0&&0===o&&0!==this[t+s+1]&&(o=1),this[t+s]=(e/a>>0)-o&255;return t+n},l.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||w(this,e,t,1,127,-128),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||w(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):M(this,e,t,!0),t+2},l.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||w(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):M(this,e,t,!1),t+2},l.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||w(this,e,t,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):P(this,e,t,!0),t+4},l.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||w(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):P(this,e,t,!1),t+4},l.prototype.writeFloatLE=function(e,t,n){return D(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return D(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return H(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return H(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,i){if(n||(n=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);var r,s=i-n;if(this===e&&n<t&&t<i)for(r=s-1;r>=0;--r)e[r+t]=this[r+n];else if(s<1e3||!l.TYPED_ARRAY_SUPPORT)for(r=0;r<s;++r)e[r+t]=this[r+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+s),t);return s},l.prototype.fill=function(e,t,n,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1===e.length){var r=e.charCodeAt(0);r<256&&(e=r)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!l.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var s;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(s=t;s<n;++s)this[s]=e;else{var a=l.isBuffer(e)?e:x(new l(e,i).toString()),o=a.length;for(s=0;s<n-t;++s)this[s+t]=a[s%o]}return this};var F=/[^+\/0-9A-Za-z-_]/g;function G(e){return e<16?"0"+e.toString(16):e.toString(16)}function x(e,t){var n;t=t||1/0;for(var i=e.length,r=null,s=[],a=0;a<i;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!r){if(n>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(a+1===i){(t-=3)>-1&&s.push(239,191,189);continue}r=n;continue}if(n<56320){(t-=3)>-1&&s.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&(t-=3)>-1&&s.push(239,191,189);if(r=null,n<128){if((t-=1)<0)break;s.push(n)}else if(n<2048){if((t-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;s.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return s}function j(e){return i.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(F,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function B(e,t,n,i){for(var r=0;r<i&&!(r+n>=t.length||r>=e.length);++r)t[r+n]=e[r];return r}}).call(this,n(4))},function(e,t,n){"use strict";t.byteLength=function(e){var t=u(e),n=t[0],i=t[1];return 3*(n+i)/4-i},t.toByteArray=function(e){var t,n,i=u(e),a=i[0],o=i[1],l=new s(function(e,t,n){return 3*(t+n)/4-n}(0,a,o)),c=0,d=o>0?a-4:a;for(n=0;n<d;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],l[c++]=t>>16&255,l[c++]=t>>8&255,l[c++]=255&t;2===o&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,l[c++]=255&t);1===o&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,l[c++]=t>>8&255,l[c++]=255&t);return l},t.fromByteArray=function(e){for(var t,n=e.length,r=n%3,s=[],a=0,o=n-r;a<o;a+=16383)s.push(c(e,a,a+16383>o?o:a+16383));1===r?(t=e[n-1],s.push(i[t>>2]+i[t<<4&63]+"==")):2===r&&(t=(e[n-2]<<8)+e[n-1],s.push(i[t>>10]+i[t>>4&63]+i[t<<2&63]+"="));return s.join("")};for(var i=[],r=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,l=a.length;o<l;++o)i[o]=a[o],r[a.charCodeAt(o)]=o;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function c(e,t,n){for(var r,s,a=[],o=t;o<n;o+=3)r=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),a.push(i[(s=r)>>18&63]+i[s>>12&63]+i[s>>6&63]+i[63&s]);return a.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},function(e,t){
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
t.read=function(e,t,n,i,r){var s,a,o=8*r-i-1,l=(1<<o)-1,u=l>>1,c=-7,d=n?r-1:0,h=n?-1:1,p=e[t+d];for(d+=h,s=p&(1<<-c)-1,p>>=-c,c+=o;c>0;s=256*s+e[t+d],d+=h,c-=8);for(a=s&(1<<-c)-1,s>>=-c,c+=i;c>0;a=256*a+e[t+d],d+=h,c-=8);if(0===s)s=1-u;else{if(s===l)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,i),s-=u}return(p?-1:1)*a*Math.pow(2,s-i)},t.write=function(e,t,n,i,r,s){var a,o,l,u=8*s-r-1,c=(1<<u)-1,d=c>>1,h=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:s-1,f=i?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,a=c):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),(t+=a+d>=1?h/l:h*Math.pow(2,1-d))*l>=2&&(a++,l/=2),a+d>=c?(o=0,a=c):a+d>=1?(o=(t*l-1)*Math.pow(2,r),a+=d):(o=t*Math.pow(2,d-1)*Math.pow(2,r),a=0));r>=8;e[n+p]=255&o,p+=f,o/=256,r-=8);for(a=a<<r|o,u+=r;u>0;e[n+p]=255&a,p+=f,a/=256,u-=8);e[n+p-f]|=128*g}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){e.exports=n(20)},function(e,t,n){"use strict";var i=n(1),r=n(6),s=n(21),a=n(12);function o(e){var t=new s(e),n=r(s.prototype.request,t);return i.extend(n,s.prototype,t),i.extend(n,t),n}var l=o(n(5));l.Axios=s,l.create=function(e){return o(a(l.defaults,e))},l.Cancel=n(13),l.CancelToken=n(35),l.isCancel=n(11),l.all=function(e){return Promise.all(e)},l.spread=n(36),l.isAxiosError=n(37),e.exports=l,e.exports.default=l},function(e,t,n){"use strict";var i=n(1),r=n(7),s=n(22),a=n(23),o=n(12),l=n(33),u=l.validators;function c(e){this.defaults=e,this.interceptors={request:new s,response:new s}}c.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=o(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=e.transitional;void 0!==t&&l.assertOptions(t,{silentJSONParsing:u.transitional(u.boolean,"1.0.0"),forcedJSONParsing:u.transitional(u.boolean,"1.0.0"),clarifyTimeoutError:u.transitional(u.boolean,"1.0.0")},!1);var n=[],i=!0;this.interceptors.request.forEach((function(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(i=i&&t.synchronous,n.unshift(t.fulfilled,t.rejected))}));var r,s=[];if(this.interceptors.response.forEach((function(e){s.push(e.fulfilled,e.rejected)})),!i){var c=[a,void 0];for(Array.prototype.unshift.apply(c,n),c=c.concat(s),r=Promise.resolve(e);c.length;)r=r.then(c.shift(),c.shift());return r}for(var d=e;n.length;){var h=n.shift(),p=n.shift();try{d=h(d)}catch(e){p(e);break}}try{r=a(d)}catch(e){return Promise.reject(e)}for(;s.length;)r=r.then(s.shift(),s.shift());return r},c.prototype.getUri=function(e){return e=o(this.defaults,e),r(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},i.forEach(["delete","get","head","options"],(function(e){c.prototype[e]=function(t,n){return this.request(o(n||{},{method:e,url:t,data:(n||{}).data}))}})),i.forEach(["post","put","patch"],(function(e){c.prototype[e]=function(t,n,i){return this.request(o(i||{},{method:e,url:t,data:n}))}})),e.exports=c},function(e,t,n){"use strict";var i=n(1);function r(){this.handlers=[]}r.prototype.use=function(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1},r.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},r.prototype.forEach=function(e){i.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=r},function(e,t,n){"use strict";var i=n(1),r=n(24),s=n(11),a=n(5);function o(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return o(e),e.headers=e.headers||{},e.data=r.call(e,e.data,e.headers,e.transformRequest),e.headers=i.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),i.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||a.adapter)(e).then((function(t){return o(e),t.data=r.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return s(t)||(o(e),t&&t.response&&(t.response.data=r.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},function(e,t,n){"use strict";var i=n(1),r=n(5);e.exports=function(e,t,n){var s=this||r;return i.forEach(n,(function(n){e=n.call(s,e,t)})),e}},function(e,t,n){"use strict";var i=n(1);e.exports=function(e,t){i.forEach(e,(function(n,i){i!==t&&i.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[i])}))}},function(e,t,n){"use strict";var i=n(10);e.exports=function(e,t,n){var r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(i("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},function(e,t,n){"use strict";var i=n(1);e.exports=i.isStandardBrowserEnv()?{write:function(e,t,n,r,s,a){var o=[];o.push(e+"="+encodeURIComponent(t)),i.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),i.isString(r)&&o.push("path="+r),i.isString(s)&&o.push("domain="+s),!0===a&&o.push("secure"),document.cookie=o.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,n){"use strict";var i=n(29),r=n(30);e.exports=function(e,t){return e&&!i(t)?r(e,t):t}},function(e,t,n){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,n){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,n){"use strict";var i=n(1),r=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,s,a={};return e?(i.forEach(e.split("\n"),(function(e){if(s=e.indexOf(":"),t=i.trim(e.substr(0,s)).toLowerCase(),n=i.trim(e.substr(s+1)),t){if(a[t]&&r.indexOf(t)>=0)return;a[t]="set-cookie"===t?(a[t]?a[t]:[]).concat([n]):a[t]?a[t]+", "+n:n}})),a):a}},function(e,t,n){"use strict";var i=n(1);e.exports=i.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function r(e){var i=e;return t&&(n.setAttribute("href",i),i=n.href),n.setAttribute("href",i),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=r(window.location.href),function(t){var n=i.isString(t)?r(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},function(e,t,n){"use strict";var i=n(34),r={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){r[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));var s={},a=i.version.split(".");function o(e,t){for(var n=t?t.split("."):a,i=e.split("."),r=0;r<3;r++){if(n[r]>i[r])return!0;if(n[r]<i[r])return!1}return!1}r.transitional=function(e,t,n){var r=t&&o(t);function a(e,t){return"[Axios v"+i.version+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}return function(n,i,o){if(!1===e)throw new Error(a(i," has been removed in "+t));return r&&!s[i]&&(s[i]=!0,console.warn(a(i," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,i,o)}},e.exports={isOlderVersion:o,assertOptions:function(e,t,n){if("object"!=typeof e)throw new TypeError("options must be an object");for(var i=Object.keys(e),r=i.length;r-- >0;){var s=i[r],a=t[s];if(a){var o=e[s],l=void 0===o||a(o,s,e);if(!0!==l)throw new TypeError("option "+s+" must be "+l)}else if(!0!==n)throw Error("Unknown option "+s)}},validators:r}},function(e){e.exports=JSON.parse('{"name":"axios","version":"0.21.4","description":"Promise based HTTP client for the browser and node.js","main":"index.js","scripts":{"test":"grunt test","start":"node ./sandbox/server.js","build":"NODE_ENV=production grunt build","preversion":"npm test","version":"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json","postversion":"git push && git push --tags","examples":"node ./examples/server.js","coveralls":"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js","fix":"eslint --fix lib/**/*.js"},"repository":{"type":"git","url":"https://github.com/axios/axios.git"},"keywords":["xhr","http","ajax","promise","node"],"author":"Matt Zabriskie","license":"MIT","bugs":{"url":"https://github.com/axios/axios/issues"},"homepage":"https://axios-http.com","devDependencies":{"coveralls":"^3.0.0","es6-promise":"^4.2.4","grunt":"^1.3.0","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^23.0.0","grunt-karma":"^4.0.0","grunt-mocha-test":"^0.13.3","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^4.0.2","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1","karma":"^6.3.2","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^2.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^4.3.6","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.8","karma-webpack":"^4.0.2","load-grunt-tasks":"^3.5.2","minimist":"^1.2.0","mocha":"^8.2.1","sinon":"^4.5.0","terser-webpack-plugin":"^4.2.3","typescript":"^4.0.5","url-search-params":"^0.10.0","webpack":"^4.44.2","webpack-dev-server":"^3.11.0"},"browser":{"./lib/adapters/http.js":"./lib/adapters/xhr.js"},"jsdelivr":"dist/axios.min.js","unpkg":"dist/axios.min.js","typings":"./index.d.ts","dependencies":{"follow-redirects":"^1.14.0"},"bundlesize":[{"path":"./dist/axios.min.js","threshold":"5kB"}]}')},function(e,t,n){"use strict";var i=n(13);function r(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;e((function(e){n.reason||(n.reason=new i(e),t(n.reason))}))}r.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},r.source=function(){var e;return{token:new r((function(t){e=t})),cancel:e}},e.exports=r},function(e,t,n){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t,n){"use strict";e.exports=function(e){return"object"==typeof e&&!0===e.isAxiosError}},function(e,t){e.exports="object"==typeof self?self.FormData:window.FormData},function(e,t,n){"use strict";e.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},function(e,t,n){},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return _}));const i=e=>{let t=e=>{e.html=t=>(void 0!==t&&(e.innerHTML=t),e.innerHTML),e.attr=(t,n)=>(void 0!==n&&(n?e.setAttribute(t,n):e.removeAttribute(t)),e.getAttribute(t)),e.val=t=>(void 0!==t&&(e.value=t),e.value),e.simplifiedChildren=()=>{let t=[];for(let n=0;n<e.children.length;n++)t.push(i(e.children[n]));return t},e.removeAll=t=>{if(t){let n=[],i=e.simplifiedChildren();for(let e in i)i[e].hasClass(t)&&n.push(i[e]);for(let t in n)e.removeChild(n[t])}else e.innerHTML=""},e.show=t=>(e.style.display=t||"",e),e.hide=()=>(e.style.display="none",e),e.fadeIn=(t=300,n)=>{e.style.opacity=0,e.style.display="inline-block";let i=0;const r=setInterval(()=>{e.style.opacity=Math.min(i/t,1),i+=10,i>t&&(clearInterval(r),n&&n())},10)},e.fadeOut=(t=300,n)=>{e.style.opacity=1;let i=0;const r=setInterval(()=>{e.style.opacity=1-Math.min(i/t,1),i+=10,i>t&&(clearInterval(r),n&&n())},10)},e.hasClass=t=>e.classList?e.classList.contains(t):new RegExp("(^| )"+t+"( |$)","gi").test(e.className),e.addClass=t=>(Array.isArray(t)||(t=t?[t]:[]),t.forEach(t=>{e.classList?t in e.classList||e.classList.add(t):e.className.indexOf(t)<0&&(e.className+=" "+t)}),e),e.removeClass=t=>(e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi"),""),e),e.toggleClass=t=>{e.hasClass(t)?e.removeClass(t):e.addClass(t)},e.on=(t,n)=>{e.addEventListener(t,n)},e.off=(t,n)=>{e.removeEventListener(t,n)}};if(e instanceof NodeList&&(e=Array.from(e)),Array.isArray(e))for(let n in e)t(e[n]);else e instanceof HTMLElement&&t(e);return e},r=e=>{var t=document.createElement("div");return t.innerHTML=e.trim(),(t=i(t.firstChild)).parentNode&&t.parentNode.removeChild(t),t},s={};let a=0;class o{constructor(e,t){this._sid=a++,this.event=e,this.callback=t}static send(e,t){if(e instanceof Array)for(let n in e)o.send(e[n],t);else if(s[e])for(let n in s[e])s[e][n].callback(t)}static subscribe(e,t){const n=new o(e,t);return s[e]||(s[e]=[]),s[e].push(n),n}static unsubscribe(e){const t=e.event;if(s[t])for(let n in s[t])if(s[t][n]._sid===e._sid){s[t].splice(n,1);break}}}var l=n(2),u=n.n(l),c=n(0),d=n.n(c);class h{constructor(){this.attachCount=0,this.element=r("<div class='-sbd-spinner'>\n            <div class='-sbd-spinner-wrapper'>\n                <div></div>\n                <div></div>\n                <div></div>\n            </div>\n        </div>")}isAttached(){return!!this.element.parentNode}attachTo(e){this.attachCount++,this.isAttached()||e.appendChild(this.element)}detach(){this.attachCount--,this.isAttached()&&0===this.attachCount&&this.element.parentNode.removeChild(this.element)}}class p{constructor(e,t){this.message=e,this.streak=!!t,this.element=r("<div class='-sbd-message-item'>\n            <div class='profile'>\n                <img src='' alt='Profile' class='image'></img>\n            </div>\n            <div class='content'>\n                <div class='media'>\n                    <img src='' alt='Image' class='image'></img>\n                    <video src='' controls='controls' width='240' height='200' class='video'></video>\n                </div>\n                <div class='preview'>\n                    <img src='' alt='Image' class='image'></img>\n                    <div class='title'></div>\n                    <div class='description'></div>\n                </div>\n                <div class='message'>\n                  <div class='file'></div>\n                  <div class='text'></div>\n                </div>\n                <div class='chatbot-card'></div>\n                <div class='rating'>\n                  <div class='rating-message'></div>\n                  <div class='rating-score'>\n                    <div class='rating-item'></div>\n                    <div class='rating-item'></div>\n                    <div class='rating-item'></div>\n                    <div class='rating-item'></div>\n                    <div class='rating-item'></div>\n                  </div>\n                  <div class='rating-form'>\n                    <textarea class='rating-comment' placeholder='(Optional)'></textarea>\n                    <button class='rating-submit'>Submit</button>\n                  </div>\n                </div>\n                <div class='rating-result'>\n                  <div class='rating-message'>Thank you!</div>\n                  <div class='rating-description'>Your submission has been received</div>\n                  <div class='line'></div>\n                  <div class='rating-result-score'>\n                    <div class='rating-result-item'></div>\n                    <div class='rating-result-item'></div>\n                    <div class='rating-result-item'></div>\n                    <div class='rating-result-item'></div>\n                    <div class='rating-result-item'></div>\n                    <div class='rating-result-number'></div>\n                  </div>\n                  <div class='rating-result-comment'></div>\n                </div>\n                <div class='created-at'></div>\n            </div>\n            <div class='confirm-end-of-chat'>\n              <div class='message'></div>\n              <div class='confirm'>\n                <div class='yes button'>Yes</div>\n                <div class='no button'>No</div>\n              </div>\n            </div>\n        </div>"),this.isSatisfactionForm=!1,this.satisfaction={score:null,comment:null,sent:!1},this.content=i(this.element.querySelector(".content")),this.media=i(this.content.querySelector(".media")),this.image=i(this.media.querySelector(".image")),this.video=i(this.media.querySelector(".video")),this.preview=i(this.element.querySelector(".preview")),this.previewImage=i(this.preview.querySelector(".image")),this.previewTitle=i(this.preview.querySelector(".title")),this.previewDescription=i(this.preview.querySelector(".description")),this.profile=i(this.element.querySelector(".profile")),this.profileImage=i(this.profile.querySelector(".image")),this.messageBox=i(this.element.querySelector(".content .message")),this.messageFile=i(this.messageBox.querySelector(".file")),this.messageText=i(this.messageBox.querySelector(".text")),this.createdAt=i(this.element.querySelector(".created-at")),this.chatbotCard=i(this.element.querySelector(".chatbot-card")),this.confirmEndOfChat=i(this.element.querySelector(".confirm-end-of-chat")),this.confirmMessage=i(this.confirmEndOfChat.querySelector(".message")),this.confirm=i(this.confirmEndOfChat.querySelector(".confirm")),this.yes=i(this.confirm.querySelector(".yes")),this.no=i(this.confirm.querySelector(".no")),this.yes.on("click",()=>{d.a.Ticket.confirmEndOfChat(this.message,"yes")}),this.no.on("click",()=>{d.a.Ticket.confirmEndOfChat(this.message,"no")}),this.rating=i(this.element.querySelector(".rating")),this.ratingMessage=i(this.rating.querySelector(".rating-message")),this.ratingItems=i(this.rating.querySelectorAll(".rating-item")),this.ratingForm=i(this.rating.querySelector(".rating-form")),this.ratingComment=i(this.rating.querySelector(".rating-comment")),this.ratingSubmit=i(this.rating.querySelector(".rating-submit")),this.ratingItems.forEach((e,t)=>{e.on("click",()=>{if(!this.satisfaction.sent){for(let e=0;e<this.ratingItems.length;e++)e<=t?this.ratingItems[e].addClass("selected"):this.ratingItems[e].removeClass("selected");this.satisfaction.score=t+1,this.ratingForm.show()}})}),this.ratingSubmit.on("click",()=>{if(!this.satisfaction.sent){const e=this.ratingComment.val();d.a.Ticket.submitFeedback(this.message,this.satisfaction.score,e,(t,n)=>{n||(this.satisfaction.comment=e,this.satisfaction.sent=!0)})}}),this.ratingResult=i(this.element.querySelector(".rating-result")),this.ratingResultItems=i(this.ratingResult.querySelectorAll(".rating-result-item")),this.ratingResultNumber=i(this.ratingResult.querySelector(".rating-result-number")),this.ratingResultComment=i(this.ratingResult.querySelector(".rating-result-comment")),this.render()}render(){const e=u.a.getInstance(),t=this.message.sender||{};e.getCurrentUserId()===t.userId&&(this.messageFile.removeClass("file"),this.messageFile.addClass("my-file"),this.element.addClass("-sbd-my-message")),this.message.isAdminMessage()&&this.element.addClass("-sbd-admin-message");try{const e=JSON.parse(this.message.data);"SENDBIRD_DESK_CUSTOMER_SATISFACTION"===e.type&&(this.isSatisfactionForm=!0,this.satisfaction.ticketId=e.body.ticketId,"WAITING"!==e.body.status&&(this.satisfaction.score=e.body.customerSatisfactionScore,this.satisfaction.comment=e.body.customerSatisfactionComment,this.satisfaction.sent=!0)),"SENDBIRD_DESK_BOT_MESSAGE_FAQ_ANSWERS"===e.type&&(this.chatbotFaqResults=e.results&&e.results||[])}catch(e){}if(t.profileUrl?(this.profileImage.attr("src",t.profileUrl),this.profileImage.show()):this.message.isAdminMessage()?this.profileImage.attr("src",""):this.profileImage.hide(),this.isSatisfactionForm)this.preview.hide(),this.media.hide(),this.messageBox.hide(),this.confirmEndOfChat.hide(),this.chatbotCard.hide(),this.satisfaction.sent?(this.rating.hide(),this.ratingResult.show(),this.ratingResultItems.forEach((e,t)=>{t+1<=this.satisfaction.score&&e.addClass("selected")}),this.ratingResultNumber.html(this.satisfaction.score),this.satisfaction.comment?this.ratingResultComment.html(this.satisfaction.comment):this.ratingResultComment.hide()):(this.rating.show(),this.ratingResult.hide(),this.ratingMessage.html(this.message.message)),this.ratingForm.hide();else{if(this.preview.hide(),this.message.data)try{const e=JSON.parse(this.message.data);switch(e.type){case d.a.Message.DataType.URL_PREVIEW:this.message.message=this.message.message.replace(d.a.Message.UrlRegExp,e=>`<a href='${e}' target='_blank'>${e}</a>`),e.body.url&&e.body.title&&(this.preview.attr("href",e.body.url),this.previewTitle.html(e.body.title),e.body.image?(this.previewImage.attr("src",e.body.image),this.previewImage.show()):this.previewImage.hide(),e.body.description&&this.previewDescription.html(e.body.description),this.preview.on("click",()=>window.open(e.body.url,"_blank")),this.preview.show());break;case d.a.Message.DataType.TICKET_FEEDBACK:}}catch(e){}this.message.isAdminMessage()?(this.messageFile.hide(),this.media.hide(),this.messageBox.show(),this.messageText.html(this.message.message),this.chatbotCard.hide()):this.message.isFileMessage()?(this.chatbotCard.hide(),this.message.type.indexOf("image")>=0?(this.messageBox.hide(),this.video.hide(),this.image.attr("src",this.message.url)):this.message.type.indexOf("video")>=0?(this.messageBox.hide(),this.image.hide(),this.video.attr("src",this.message.url)):(this.messageFile.show("inline-block"),this.media.hide(),this.messageBox.show(),this.messageText.html(this.message.name),this.messageText.addClass("file-name"),this.messageText.on("click",()=>{window.open(this.message.url,"_blank")}))):(this.messageFile.hide(),this.media.hide(),this.messageBox.show(),this.messageText.html(this.message.message),this.chatbotFaqResults&&this.chatbotFaqResults.length>0?(this.chatbotCard.show("flex"),this.chatbotFaqResults.forEach(e=>{const{question:t="",answer:n="",url:i="",url_label:s="",image_url:a=""}=e,o=r(`\n              <div class="faq-card">\n                <img\n                  class="faq-card__profile-image"\n                  src="${a||"img/login-logo.png"}"\n                  alt="${s}"\n                ></img>\n                <div class="faq-card__title-question">${t}</div>\n                <p class="faq-card__description">${n}</p>\n              </div>\n            `);o.onclick=()=>{window.open(i)},this.chatbotCard.appendChild(o,this.chatbotCard)})):this.chatbotCard.hide()),this.streak&&this.createdAt.hide(),this.createdAt.html(moment(this.message.createdAt).fromNow());let e=null;try{e=this.message.data?JSON.parse(this.message.data):null}catch(e){throw e}if(e&&e.type===d.a.Message.DataType.TICKET_INQUIRE_CLOSURE){switch(e.body.state){case d.a.Message.ClosureState.WAITING:this.profile.hide(),this.content.hide(),this.confirmMessage.html(this.message.message),this.confirmEndOfChat.show();break;default:this.confirmEndOfChat.hide()}}else this.confirmEndOfChat.hide();this.rating.hide(),this.ratingResult.hide()}}static get Script(){return{TICKET_ASSIGNED:"Ticket assigned.",TICKET_CLOSED:"Ticket closed.",TICKET_START:"Hi, what can I help you?"}}static isVisible(e){let t=null;try{t=e.data?JSON.parse(e.data):null}catch(e){throw e}return e.isSystemMessage="SENDBIRD_DESK_ADMIN_MESSAGE_CUSTOM_TYPE"===e.customType,e.isAssigned=t&&t.type===d.a.Message.DataType.TICKET_ASSIGN,e.isTransferred=t&&t.type===d.a.Message.DataType.TICKET_TRANSFER,e.isClosed=t&&t.type===d.a.Message.DataType.TICKET_CLOSE,!(e.isSystemMessage||e.isAssigned||e.isTransferred||e.isClosed)}}class f{constructor(e){this.ticket=e,this.element=r(`<div class='-sbd-dialog'>\n            <div class='-sbd-dialog-header'>\n                <div class='close'></div>\n                <div class='agent'>\n                    <div class='profile'>\n                        <img src='' alt='Profile' class='image'></img>\n                    </div>\n                    <div class='name'>${this.ticket.agent?this.ticket.agent.name:"Agent"}</div>\n                </div>\n            </div>\n            <div class='-sbd-message-list'>\n            </div>\n            <div class='-sbd-message-form'>\n                <input type='text' class='message' placeholder='Write a message...'></input>\n                <div class='attach'><input type='file' class='file'></input></div>\n            </div>\n        </div>`),this.updateAgent(e.agent),this.isOpened=!1;i(this.element.querySelector(".close")).on("click",()=>{this.close()}),this.messageList=i(this.element.querySelector(".-sbd-message-list")),this.messageElementList=[],this.collisionSet=new Set,this.spinner=new h,this.messageRevision=0,this.isLoading=!1,this.noMoreMessage=!1,this.messageList.on("scroll",e=>{if(!this.isLoading&&!this.noMoreMessage&&this.isTop()){this.isLoading=!0;const t=this.messageRevision;this.loadMessage(!0,(e,n)=>{if(!n&&this.messageRevision===t){const t=e;for(let e in t){const n=t[e];p.isVisible(n)&&this.prependMessage(n)}}this.isLoading=!1}),e.preventDefault(),e.stopPropagation()}}),this.form=i(this.element.querySelector(".-sbd-message-form")),this.input=i(this.form.querySelector(".message")),this.attach=i(this.form.querySelector(".attach")),this.file=i(this.form.querySelector(".file")),this.editable=!0,e.status===d.a.Ticket.Status.CLOSED&&this.disableForm(),this.input.on("keypress",e=>{if(13===e.keyCode&&!e.shiftKey){e.preventDefault();const t=this.input.val();this.input.val(""),t&&this.editable&&(this.ticket.status===d.a.Ticket.Status.INITIALIZED&&(this.ticket.status=d.a.Ticket.Status.UNASSIGNED),this.ticket.channel.sendUserMessage(t,(e,t)=>{if(t)this.ticket.status=d.a.Ticket.Status.INITIALIZED;else{const t=e;d.a.Message.UrlRegExp.test(t.message)&&(t.url=d.a.Message.UrlRegExp.exec(t.message)[0],d.a.Ticket.getUrlPreview(t.url,(e,n)=>{if(n)throw n;this.ticket.channel.updateUserMessage(t.messageId,t.message,JSON.stringify({type:d.a.Message.DataType.URL_PREVIEW,body:{url:t.url,site_name:e.data.siteName,title:e.data.title,description:e.data.description,image:e.data.image}}),t.customType,(e,t)=>{if(t)throw t;this.updateMessage(e)})})),this.appendMessage(e),this.scrollToBottom()}}))}}),this.attach.on("click",()=>{this.editable&&this.file.click()}),this.file.on("change",()=>{if(this.editable){let e=this.file.files[0];this.ticket.channel.sendFileMessage(e,e.name,e.type,e.size,"","",[{maxWidth:220,maxHeight:220}],(e,t)=>{t||p.isVisible(e)&&this.appendMessage(e)})}}),this.file.on("click",e=>e.stopPropagation())}loadMessage(e,t){this.query&&e||(this.query=this.ticket.channel.createPreviousMessageListQuery(),this.clearMessage()),this.query.load(20,!0,(e,n)=>{if(n)throw n;this.noMoreMessage=e.length<20,t(e,n)})}open(e){if(e){this.isOpened=!0,this.widget=e,this.widget.panel.appendChild(this.element),this.element.addClass("opened"),this.ticket.channel.markAsRead(),this.spinner.attachTo(this.messageList),this.messageRevision++;const t=this.messageRevision;this.loadMessage(!1,(e,n)=>{if(!n&&this.messageRevision===t){const t=e;for(let e in t){const n=t[e];p.isVisible(n)&&this.prependMessage(n)}this.scrollToBottom()}this.spinner.detach()})}}close(e){e?(this.element.hide(),this.element.parentNode&&this.widget.panel.removeChild(this.element)):(this.element.removeClass("opened"),setTimeout(()=>{this.element.parentNode&&this.widget.panel.removeChild(this.element)},1e3)),this.isOpened=!1}enableForm(){this.editable=!0,this.form.removeClass("disabled"),this.input.attr("readonly",""),this.input.attr("placeholder","Write a message..."),this.attach.show()}disableForm(){this.editable=!1,this.form.addClass("disabled"),this.input.attr("readonly","readonly"),this.input.attr("placeholder",""),this.attach.hide()}updateAgent(e){this.ticket&&(this.ticket.agent=e);let t=i(this.element.querySelector(".agent .profile .image")),n=i(this.element.querySelector(".agent .name"));e?(e.profileUrl?(t.attr("src",e.profileUrl),t.show()):t.hide(),n.html(e.name||"Agent")):(t.hide(),n.html("Agent"))}isMessageStreak(e,t){return(!e.sender&&!t.sender||e.sender&&t.sender&&e.sender.userId===t.sender.userId)&&Math.round((e.createdAt-t.createdAt)/1e3)<60}prependMessage(e){if(!this.collisionSet.has(e.messageId)){this.collisionSet.add(e.messageId);let t=!1;if(this.messageElementList.length>0){let n=null;for(let e in this.messageElementList){const t=this.messageElementList[e];if(!t.streak){n=t;break}}n&&(t=this.isMessageStreak(n.message,e))}const n=new p(e,t);this.messageElementList.unshift(n),this.messageList.firstChild?this.messageList.insertBefore(n.element,this.messageList.firstChild):this.messageList.appendChild(n.element)}}appendMessage(e){if(!this.collisionSet.has(e.messageId)){if(this.collisionSet.add(e.messageId),this.messageElementList.length>0){const t=this.messageElementList[this.messageElementList.length-1];this.isMessageStreak(e,t.message)&&(t.streak=!0,t.render())}const t=this.isBottom(),n=new p(e);this.messageElementList.push(n),this.messageList.appendChild(n.element),!this.spinner.isAttached()&&t&&this.scrollToBottom()}}updateMessage(e){for(let t in this.messageElementList){const n=this.messageElementList[t];if(n.message.messageId===e.messageId){n.message=e,n.render();break}}}clearMessage(){this.collisionSet=new Set,this.messageList.removeAll("-sbd-message-item"),this.messageElementList=[]}isTop(){return 0===this.messageList.scrollTop}isBottom(){return this.messageList.scrollHeight-this.messageList.scrollTop===this.messageList.clientHeight}scrollToBottom(){this.messageList.scrollTo(0,this.messageList.scrollHeight)}}class g{constructor(e,t){this.ticket=t,this.element=r(`<div class='-sbd-ticket-item'>\n            <div class='profile'>\n                <img src='${t.agent?t.agent.profileUrl:""}' alt='Profile' class='image'></img>\n                <div class='badge'></div>\n            </div>\n            <div class='content'>\n                <div class='name'>${t.agent?t.agent.name:t.title}</div>\n                <div class='last'>${t.channel.lastMessage.message||"No message"}</div>\n            </div>\n            <div class='updated-at'></div>\n        </div>`),this.profileImage=i(this.element.querySelector(".profile .image")),this.badge=i(this.element.querySelector(".profile .badge")),this.name=i(this.element.querySelector(".content .name")),this.last=i(this.element.querySelector(".content .last")),this.updatedAt=i(this.element.querySelector(".updated-at")),this.render(),this.element.on("click",()=>{e.startNewDialog(this.ticket)})}render(){const e=this.ticket.agent;e&&e.profileUrl?(this.profileImage.attr("src",e.profileUrl),this.profileImage.show()):this.profileImage.hide();let t=this.ticket.channel.unreadMessageCount;t>0?(t>=99&&(t+="+"),this.badge.html(t),this.badge.show()):this.badge.hide(),this.name.html(e?e.name:this.ticket.title),this.ticket.channel.lastMessage&&(this.ticket.channel.lastMessage.isFileMessage()?this.last.html(this.ticket.channel.lastMessage.name):this.last.html(this.ticket.channel.lastMessage.message)),this.updatedAt.html(moment(this.ticket.channel.lastMessage?this.ticket.channel.lastMessage.createdAt:null).fromNow())}}class y{constructor(e,t){this.ticket=e,this.message=t,this.element=r("<div class='-sbd-notification'>\n            <div class='profile'>\n              <img src='' alt='Profile' class='image'></img>\n            </div>\n            <div class='content'>\n              <div class='name'>Agent</div>\n              <div class='close'></div>\n              <div class='text'></div>\n            </div>\n        </div>"),this.onClickHandler=null,this.element.on("click",()=>{this.onClickHandler&&this.onClickHandler(this.ticket,this.message)});i(this.element.querySelector(".close")).on("click",e=>{e.stopPropagation(),e.preventDefault(),this.close()}),this.profile=i(this.element.querySelector(".profile")),this.profileImage=i(this.profile.querySelector(".image")),this.messageBox=i(this.element.querySelector(".content")),this.name=i(this.element.querySelector(".name")),this.messageText=i(this.messageBox.querySelector(".text")),this.render()}render(){const e=this.message.sender||{};e.profileUrl?(this.profileImage.attr("src",e.profileUrl),this.profileImage.show()):this.profileImage.hide(),e.name&&this.name.html(e.name),this.message.isAdminMessage()?this.messageText.html(this.message.message):this.message.isFileMessage()?this.messageText.html(this.message.name):this.messageText.html(this.message.message)}open(e,t=5e3){this.widget=e,this.element.addClass("fade-in"),this.widget.element.appendChild(this.element),setTimeout(()=>{this.close()},t)}close(){this.element.removeClass("fade-in"),setTimeout(()=>{this.element.parentNode&&this.widget.element.removeChild(this.element)},2e3)}onClick(e){this.onClickHandler=e}}class m{constructor(e,t){this.element=document.getElementById("sb-desk"),this.element.className="-sbd-widget",t||(t={}),m.panel=this.panel=r(`<div class='-sbd-panel'>\n            <div class='-sbd-header'>\n                <div class='-sbd-title'>Inbox</div>\n                <div class='-sbd-tabs'>\n                    <div class='-sbd-tab-item' data-status='${d.a.Ticket.Status.OPEN}'>OPEN</div>\n                    <div class='-sbd-tab-item' data-status='${d.a.Ticket.Status.CLOSED}'>CLOSED</div>\n                    <div class='-sbd-tab-bar'></div>\n                </div>\n                <div class='-sbd-menu'><div class='icon'></div></div>\n                <div class='-sbd-menu-list'>\n                  <div class='-sbd-menu-item' data-cmd='signout'>Sign out</div>\n                </div>\n            </div>\n            <div class='-sbd-ticket-list'>\n                <div class='-sbd-ticket-new'>\n                    <div class='icon'></div>\n                    <div class='label'>Start a new conversation.</div>\n                </div>\n            </div>\n            <div class='-sbd-error'>Cannot connect to internet.</div>\n        </div>`),this.element.appendChild(this.panel),this.error=i(this.element.querySelector(".-sbd-error"));let n=i(document.querySelectorAll(".-sbd-tabs > .-sbd-tab-item")),s=i(document.querySelector(".-sbd-tabs > .-sbd-tab-bar"));for(let e=0;e<n.length;e++)n[e].on("click",e=>{let t=e.target.getAttribute("data-status");f(t)});let a=i(document.querySelector(".-sbd-menu")),o=i(document.querySelector(".-sbd-menu-list"));a.on("click",()=>o.toggleClass("fade-in"));let l=i(document.querySelectorAll(".-sbd-menu-list > .-sbd-menu-item"));for(let e=0;e<l.length;e++)l[e].on("click",e=>{switch(e.target.getAttribute("data-cmd")){case"signout":this.signout()}o.toggleClass("fade-in")});this.ticketList=i(document.querySelector(".-sbd-panel > .-sbd-ticket-list")),this.ticketElementList=[],this.ticketRevision=0,this.isLoading=!1,this.noMoreTicket=!1,this.ticketList.on("scroll",()=>{if(!this.isLoading&&!this.noMoreTicket&&this.isBottom()){this.isLoading=!0,this.currentPage++;const e=this.ticketRevision;this.loadTicket(this.currentTab,this.currentPage,(t,n)=>{if(!n&&this.ticketRevision===e)for(let e in t)this.appendTicket(t[e]);this.isLoading=!1})}});let c=i(document.querySelector(".-sbd-ticket-list > .-sbd-ticket-new"));c.on("click",()=>{const t="Issue #"+("000"+(new Date).getTime()%1e3).slice(-3);this.spinner.attachTo(this.ticketList),d.a.Ticket.create(t,e.nickname,(e,t)=>{if(t)throw t;this.spinner.detach(),this.startNewDialog(e)})}),this.spinner=new h,this.currentTab="",this.currentPage=0,this.payloadTicket=null;let f=e=>{if(e!=this.currentTab){for(let t=0;t<n.length;t++){n[t].attr("data-status")===e&&(s.style.left=n[t].offsetLeft+"px")}e===d.a.Ticket.Status.OPEN?c.show():c.hide(),this.currentTab=e,this.currentPage=0,this.ticketRevision++,this.clearTicket();const t=this.ticketRevision;this.spinner.attachTo(this.ticketList),this.loadTicket(e,this.currentPage,(e,n)=>{if(this.spinner.detach(),!n&&this.ticketRevision===t){for(let t in e)this.appendTicket(e[t]);this.payloadTicket&&(this.startNewDialog(this.payloadTicket),this.payloadTicket=null)}})}};const _=i(document.querySelector(".guide-balloon"));this.active=!1,this.action=r("<div class='-sbd-action-button'></div>"),this.action.on("click",()=>{this.active=!this.active,this.action.toggleClass("is-active"),this.panel.toggleClass("fade-in"),this.active?f(d.a.Ticket.Status.OPEN):this.dialog&&setTimeout(()=>{this.currentTab="",this.dialog.close(!0)},500),this.active?_.hide():_.show()}),this.action.hide(),this.element.appendChild(this.action),this.sendbird=new u.a({appId:e.appId}),this.sendbird.connect(e.userId,t.apiHost,t.wsHost,(n,i)=>{if(i)throw i;this.sendbird.updateCurrentUserInfo(e.nickname,null,(n,i)=>{if(i)throw i;d.a.init(u.a),t.deskApiHost&&d.a.setApiHost(t.deskApiHost),d.a.authenticate(e.userId,(e,t)=>{if(t)throw t;_.fadeIn(300),this.action.show();const n=new this.sendbird.ConnectionHandler;n.onReconnectStarted=()=>{this.active&&this.spinner.attachTo(this.ticketList)},n.onReconnectSucceeded=()=>{if(this.active){const e=this.currentTab;if(this.currentTab="",this.error.hide(),this.dialog&&this.dialog.isOpened){this.dialog.ticket.channel.markAsRead(),this.dialog.ticket.refresh((e,t)=>{t||(this.dialog.ticket=e,this.dialog.updateAgent(e.agent))});const t=this.dialog.messageRevision;this.dialog.loadMessage(!1,(n,i)=>{if(!i){if(this.dialog.messageRevision===t){const e=n;for(let t in e){const n=e[t];p.isVisible(n)&&this.dialog.prependMessage(n)}this.dialog.scrollToBottom()}this.spinner.detach()}f(e)})}else this.spinner.detach(),f(e)}},n.onReconnectFailed=()=>{this.active&&(this.spinner.detach(),this.error.show())},this.sendbird.addConnectionHandler("widget",n);const i=new this.sendbird.ChannelHandler;i.onChannelChanged=e=>{d.a.Ticket.getByChannelUrl(e.url,(t,n)=>{if(n)throw n;const i=t;i.channel=e;let r=this.ticketElementList.findIndex(e=>e.ticket.id===i.id),s=r>=0?this.ticketElementList[r]:null;s&&(s.ticket=i,s.render());const a=i.status===d.a.Ticket.Status.INITIALIZED,o=i.status===d.a.Ticket.Status.CLOSED,l=0===r;this.currentTab===d.a.Ticket.Status.CLOSED||l||o||(s?(this.ticketElementList.splice(r,1),this.ticketList.removeChild(s.element)):a||(s=new g(this,i)),s&&(this.ticketElementList.length>0?(this.ticketList.insertBefore(s.element,this.ticketElementList[0].element),this.ticketElementList.unshift(s)):(this.ticketElementList.push(s),this.ticketList.appendChild(s.element))))})},i.onMessageReceived=(e,t)=>{if(!this.currentTab||this.currentTab===d.a.Ticket.Status.OPEN){let n=null;try{n=t.data?JSON.parse(t.data):null}catch(e){throw e}d.a.Ticket.getByChannelUrl(e.url,(i,r)=>{if(r)throw r;const s=i;n&&n.ticket&&(s.status=n.ticket.status),t.isAssigned=n&&n.type===d.a.Message.DataType.TICKET_ASSIGN,t.isTransferred=n&&n.type===d.a.Message.DataType.TICKET_TRANSFER,t.isClosed=n&&n.type===d.a.Message.DataType.TICKET_CLOSE,(t.isAssigned||t.isTransferred)&&(s.agent=n.ticket.agent);const a=this.ticketElementList.findIndex(e=>e.ticket.id===s.id),o=a>=0?this.ticketElementList[a]:null;if(o&&(o.ticket=s,o.render(),t.isClosed&&(this.ticketElementList.splice(a,1),this.ticketList.removeChild(o.element))),!this.active&&d.a.isDeskChannel(e)&&p.isVisible(t)){const e=new y(s,t);e.render(),e.onClick(t=>{e.close(),this.payloadTicket=t,this.action.click()}),e.open(this)}}),this.dialog&&this.dialog.isOpened&&this.dialog.ticket.channel.url===e.url&&(p.isVisible(t)&&this.dialog.appendMessage(t),this.dialog.ticket.channel.markAsRead(()=>{}))}},i.onMessageUpdated=(e,t)=>{this.currentTab===d.a.Ticket.Status.OPEN&&d.a.Ticket.getByChannelUrl(e.url,(n,i)=>{if(i)throw i;const r=n;let s=null;try{s=t.data?JSON.parse(t.data):null}catch(e){throw e}s&&s.ticket&&(r.status=s.ticket.status);let a=this.ticketElementList.findIndex(e=>e.ticket.id===r.id),o=a>=0?this.ticketElementList[a]:null;if(t.isClosureInquired=s&&s.type===d.a.Message.DataType.TICKET_INQUIRE_CLOSURE,t.isClosureInquired){switch(s.body.state){case d.a.Message.ClosureState.CONFIRMED:r.status=d.a.Ticket.Status.CLOSED,o&&(this.ticketElementList.splice(a,1),this.ticketList.removeChild(o.element))}}this.dialog&&this.dialog.isOpened&&this.dialog.ticket.channel.url===e.url&&(this.dialog.updateMessage(t),r.status===d.a.Ticket.Status.CLOSED&&this.dialog.disableForm())})},this.sendbird.addChannelHandler("widget",i)})})})}loadTicket(e,t,n){switch(e){case d.a.Ticket.Status.OPEN:d.a.Ticket.getOpenedList(t,(e,t)=>{const i=e;this.noMoreTicket=i.length<d.a.Ticket.defaultLimit,n(e,t)});break;case d.a.Ticket.Status.CLOSED:d.a.Ticket.getClosedList(t,(e,t)=>{const i=e;this.noMoreTicket=i.length<d.a.Ticket.defaultLimit,n(e,t)});break;default:n(null,[])}}appendTicket(e){const t=new g(this,e);this.ticketElementList.push(t),this.ticketList.appendChild(t.element)}clearTicket(){this.ticketElementList=[],this.ticketList.removeAll("-sbd-ticket-item")}signout(){this.sendbird.disconnect(()=>{o.send("signout"),this.panel.hasClass("fade-in")&&(this.panel.toggleClass("fade-in"),setTimeout(()=>{this.element.removeChild(this.panel)},250)),this.element.removeChild(this.action)})}isBottom(){return this.ticketList.scrollHeight-this.ticketList.scrollTop===this.ticketList.clientHeight}startNewDialog(e){this.dialog=new f(e),this.dialog.open(this)}}class _{constructor(){const e=!!window.localStorage,t={appId:"",userId:"",nickname:""},n={active:!1,wsHost:"",apiHost:""};e&&(t.appId=localStorage.getItem("sb-desk-appId")||"",t.userId=localStorage.getItem("sb-desk-userId")||"",t.nickname=localStorage.getItem("sb-desk-nickname")||"",n.active="true"===localStorage.getItem("sb-desk-advanced")||!1,n.wsHost=localStorage.getItem("sb-desk-advanced-wshost")||"",n.apiHost=localStorage.getItem("sb-desk-advanced-apihost")||"",n.deskApiHost=localStorage.getItem("sb-desk-advanced-deskApihost")||""),this.element=r(`<div class='-sbd-login-background'>\n          <div class='-sbd-login'>\n            <div class='logo'></div>\n            <div class='title'><span class='bold'>Desk Widget</span> Login</div>\n            <div class='panel'>\n              <div class='form form-login'>\n                <span class='input-label'>App ID</span>\n                <input class='appId input' placeholder='App ID' value='${t.appId}'></input>\n                <span class='input-label'>User ID</span>\n                <input class='userId input' placeholder='User ID' value='${t.userId}'></input>\n                <span class='input-label'>Name</span>\n                <input class='nickname input' placeholder='Name' value='${t.nickname}'></input>\n                <div class='error'></div>\n              </div>\n              <div class='separator'></div>\n              <div class='control'>\n                <div class='advanced'>\n                  <div class='label'>Advanced</div>\n                </div>\n                <div class='login button'>Login</div>\n              </div>\n              <div class='form form-advanced'>\n                <span class='input-label'>Custom WebSocket host</span>\n                <input class='wsHost input' placeholder='Custom WebSocket host' value='${n.wsHost}'></input>\n                <span class='input-label'>Custom API host</span>\n                <input class='apiHost input' placeholder='Custom API host' value='${n.apiHost}'></input>\n                <span class='input-label'>Custom Desk API host</span>\n                <input class='deskApiHost input' placeholder='Custom Desk API host' value='${n.deskApiHost}'></input>\n              </div>\n            </div>\n          </div>\n        </div>`);const s=i(this.element.querySelector(".form-login .appId")),a=i(this.element.querySelector(".form-login .userId")),l=i(this.element.querySelector(".form-login .nickname"));let u=n.active;const c=i(this.element.querySelector(".advanced .label")),d=i(this.element.querySelector(".form-advanced"));c.on("click",()=>{c.toggleClass("open"),u=!u,u?d.show():d.hide()}),u?d.show():d.hide();const h=i(this.element.querySelector(".form-advanced .wsHost")),p=i(this.element.querySelector(".form-advanced .apiHost")),f=i(this.element.querySelector(".form-advanced .deskApiHost"));const g=i(this.element.querySelector(".form-login .error"));i(this.element.querySelector(".control .login")).on("click",()=>{const t={appId:s.val(),userId:a.val(),nickname:l.val()};if(t.appId&&t.userId&&t.nickname){const n={};e&&(localStorage.setItem("sb-desk-appId",t.appId),localStorage.setItem("sb-desk-userId",t.userId),localStorage.setItem("sb-desk-nickname",t.nickname),u?(n.wsHost=h.val(),n.apiHost=p.val(),n.deskApiHost=f.val(),localStorage.setItem("sb-desk-advanced-wshost",n.wsHost),localStorage.setItem("sb-desk-advanced-apihost",n.apiHost),localStorage.setItem("sb-desk-advanced-deskApihost",n.deskApiHost)):(n.wsHost=null,n.apiHost=null,n.deskApiHost=null),localStorage.setItem("sb-desk-advanced",u&&n.wsHost&&n.apiHost&&n.deskApiHost?"true":"false")),new m(t,n),this.hide()}else g.html("Insert app ID, user ID and name to login."),g.show()}),o.subscribe("signout",()=>this.show()),this.show()}show(){document.body.appendChild(this.element),this.element.addClass("shown")}hide(){this.element.removeClass("shown"),setTimeout(()=>{document.body.removeChild(this.element)},2e3)}}window.onload=()=>{new _}}]);